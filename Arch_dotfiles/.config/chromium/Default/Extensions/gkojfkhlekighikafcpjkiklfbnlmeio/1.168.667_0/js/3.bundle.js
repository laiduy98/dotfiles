// LICENSE_CODE ZON
(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[3],[,,,,,,,,,,function(module,exports,__webpack_require__){var __WEBPACK_AMD_DEFINE_ARRAY__,__WEBPACK_AMD_DEFINE_RESULT__;var module;
// LICENSE_CODE ZON ISC
"use strict";(function(){var node_util;var is_node=typeof module=="object"&&module.exports&&module.children;var is_rn=typeof global=="object"&&!!global.nativeRequire||typeof navigator=="object"&&navigator.product=="ReactNative";if(is_rn){}else if(!is_node);else{node_util=require("util")}!(__WEBPACK_AMD_DEFINE_ARRAY__=[__webpack_require__(26)],__WEBPACK_AMD_DEFINE_RESULT__=function(array){var E={};E._is_mocha=undefined;E.is_mocha=function(){if(E._is_mocha!==undefined)return E._is_mocha;if(typeof process!="undefined"&&typeof process.env!="undefined")return E._is_mocha=process.env.IS_MOCHA||false;return E._is_mocha=false};E.is_lxc=function(){return is_node&&+process.env.LXC};E.f_mset=function(flags,mask,bits){return flags&~mask|bits};E.f_lset=function(flags,bits,logic){return E.f_mset(flags,bits,logic?bits:0)};E.f_meq=function(flags,mask,bits){return(flags&mask)==bits};E.f_eq=function(flags,bits){return(flags&bits)==bits};E.f_cmp=function(f1,f2,mask){return(f1&mask)==(f2&mask)};E.xor=function(a,b){return!a!=!b};E.div_ceil=function(a,b){return Math.floor((a+b-1)/b)};E.ceil_mul=function(a,b){return E.div_ceil(a,b)*b};E.floor_mul=function(a,b){return Math.floor(a/b)*b};E.range=function(x,a,b){return x>=a&&x<=b};E.range.ii=function(x,a,b){return x>=a&&x<=b};E.range.ie=function(x,a,b){return x>=a&&x<b};E.range.ei=function(x,a,b){return x>a&&x<=b};E.range.ee=function(x,a,b){return x>a&&x<b};E.clamp=function(lower_bound,value,upper_bound){if(value<lower_bound)return lower_bound;if(value<upper_bound)return value;return upper_bound};E.revcmp=function(a,b){return a>b?-1:a<b?1:0};E.union_with=function(fn){var res={},args;if(arguments.length==2&&typeof arguments[1]=="object")args=arguments[1];else args=array.slice(arguments,1);for(var i=0;i<args.length;++i){for(var key in args[i]){var arg=args[i];res[key]=res.hasOwnProperty(key)?fn(res[key],arg[key]):arg[key]}}return res};function _clone_deep(obj){var i,n,ret;if(obj instanceof Array){ret=new Array(obj.length);n=obj.length;for(i=0;i<n;i++)ret[i]=obj[i]instanceof Object?_clone_deep(obj[i]):obj[i];return ret}else if(obj instanceof Date)return new Date(obj);else if(obj instanceof RegExp)return new RegExp(obj);else if(obj instanceof Function)return obj;ret={};for(i in obj)ret[i]=obj[i]instanceof Object?_clone_deep(obj[i]):obj[i];return ret}E.clone_deep=function(obj){if(!(obj instanceof Object))return obj;return _clone_deep(obj)};E.extend=function(obj){for(var i=1;i<arguments.length;i++){var source=arguments[i];if(!source)continue;for(var prop in source)obj[prop]=source[prop]}return obj};function is_object(obj){return obj&&obj.constructor==Object}E.extend_deep=function(obj){if(!is_object(obj))return obj;for(var i=1;i<arguments.length;i++){var source=arguments[i];if(!source)continue;for(var prop in source){if(is_object(source[prop])&&is_object(obj[prop]))E.extend_deep(obj[prop],source[prop]);else obj[prop]=source[prop]}}return obj};E.extend_deep_del_null=function(obj){for(var i=1;i<arguments.length;i++){var source=arguments[i];if(!source)continue;for(var prop in source){if(is_object(source[prop])){if(!is_object(obj[prop]))obj[prop]={};E.extend_deep_del_null(obj[prop],source[prop])}else if(source[prop]==null)delete obj[prop];else obj[prop]=source[prop]}}return obj};E.defaults=function(obj){if(!obj)obj={};for(var i=1;i<arguments.length;i++){var source=arguments[i];if(obj===undefined)continue;for(var prop in source){if(obj[prop]===undefined)obj[prop]=source[prop]}}return obj};E.defaults_deep=function(obj){if(obj!==undefined&&!is_object(obj))return obj;for(var i=1;i<arguments.length;i++){var source=arguments[i];if(obj===undefined)obj=E.clone_deep(source);else if(is_object(source)){for(var prop in source){var s=source[prop],d=obj[prop];if(d===undefined)obj[prop]=E.clone_deep(s);else E.defaults_deep(d,s)}}}return obj};E.clone=function(obj){if(!(obj instanceof Object))return obj;if(obj instanceof Array){var a=new Array(obj.length);for(var i=0;i<obj.length;i++)a[i]=obj[i];return a}return E.extend({},obj)};E.freeze_deep=function(obj){if(typeof obj=="object"){for(var prop in obj){if(obj.hasOwnProperty(prop))E.freeze_deep(obj[prop])}}return Object.freeze(obj)};E.equal_deep=function(a,b){var i;if(a===b)return true;if(!a||!b||a.constructor!==b.constructor)return false;if(a instanceof Function||a instanceof RegExp)return a.toString()==b.toString();if(a instanceof Date)return+a==+b;if(Array.isArray(a)){if(a.length!=b.length)return false;for(i=0;i<a.length;i++){if(!E.equal_deep(a[i],b[i]))return false}return true}if(is_object(a)){var a_keys=Object.keys(a),b_keys=Object.keys(b);if(a_keys.length!=b_keys.length)return false;for(i=0;i<a_keys.length;i++){var key=a_keys[i];if(!E.equal_deep(a[key],b[key]))return false}return true}return false};E.map_obj=function(obj,fn){var ret={};for(var i in obj)ret[i]=fn(obj[i],i,obj);return ret};E.sort_obj=function(obj,fn){if(obj instanceof Array||!(obj instanceof Object))return obj;var ret={},keys=Object.keys(obj).sort(fn);for(var i=0;i<keys.length;i++)ret[keys[i]]=E.sort_obj(obj[keys[i]],fn);return ret};E.forEach=function(obj,fn,_this){for(var i in obj)fn.call(_this,obj[i],i,obj)};E.find=function(obj,fn,_this){for(var i in obj){if(fn.call(_this,obj[i],i,obj))return obj[i]}};E.find_prop=function(obj,prop,val){return E.find(obj,(function(o){return o[prop]===val}))};E.isspace=function(c){return/\s/.test(c)};E.isdigit=function(c){return c>="0"&&c<="9"};E.isalpha=function(c){return c>="a"&&c<="z"||c>="A"&&c<="Z"};E.isalnum=function(c){return E.isdigit(c)||E.isalpha(c)};E.obj_pluck=function(obj,prop){var val=obj[prop];delete obj[prop];return val};E.proto_keys=function(proto){var keys=[];for(var i in proto)keys.push(i);return keys};E.values=function(obj){var values=[];for(var i in obj)values.push(obj[i]);return values};E.path=function(path){if(Array.isArray(path))return path;path=""+path;if(!path)return[];return path.split(".")};E.get=function(o,path,def){path=E.path(path);for(var i=0;i<path.length;i++){if(!o||typeof o!="object"&&typeof o!="function"||!(path[i]in o))return def;o=o[path[i]]}return o};E.set=function(o,path,value){var orig=o;path=E.path(path);for(var i=0;i<path.length-1;i++){var p=path[i];o=o[p]||(o[p]={})}o[path[path.length-1]]=value;return orig};E.unset=function(o,path){path=E.path(path);for(var i=0;i<path.length-1;i++){var p=path[i];if(!o[p])return;o=o[p]}delete o[path[path.length-1]]};var has_unique={};E.has=function(o,path){return E.get(o,path,has_unique)!==has_unique};E.own=function(o,prop){return Object.prototype.hasOwnProperty.call(o,prop)};E.bool_lookup=function(a,split){var ret={},i;if(typeof a=="string")a=a.split(split||/\s/);for(i=0;i<a.length;i++)ret[a[i]]=true;return ret};E.clone_inplace=function(dst,src){if(dst===src)return dst;if(Array.isArray(dst)){for(var i=0;i<src.length;i++)dst[i]=src[i];dst.splice(src.length)}else if(typeof dst=="object"){var k;for(k in src)dst[k]=src[k];for(k in dst){if(!src.hasOwnProperty(k))delete dst[k]}}return dst};if(node_util&&node_util.inherits)E.inherits=node_util.inherits;else{E.inherits=function inherits(ctor,superCtor){ctor.super_=superCtor;ctor.prototype=Object.create(superCtor.prototype,{constructor:{value:ctor,enumerable:false,writable:true,configurable:true}})}}E.inherit_init=function(obj,ctor,params){var orig_proto=Object.getPrototypeOf(obj);var ctor_proto=Object.assign({},ctor.prototype);Object.setPrototypeOf(ctor_proto,orig_proto);Object.setPrototypeOf(obj,ctor_proto);return ctor.apply(obj,params)};E.pick=function(obj){var i,o={};for(i=1;i<arguments.length;i++){if(E.own(obj,arguments[i]))o[arguments[i]]=obj[arguments[i]]}return o};E.omit=function(obj,omit){var i,o={};obj=Object(obj);for(i in obj){if(!omit.includes(i))o[i]=obj[i]}return o};E.if_set=function(val,o,name){if(val!==undefined)o[name]=val};E.escape_dotted_keys=function(obj,repl){if(!Array.isArray(obj)&&!is_object(obj))return obj;repl=repl||"_";for(var prop in obj){if(E.own(obj,prop)){var new_prop=prop.replace(/\./g,repl);if(prop!=new_prop){obj[new_prop]=obj[prop];delete obj[prop]}if(Array.isArray(obj[new_prop])){obj[new_prop].forEach((function(e){E.escape_dotted_keys(e,repl)}))}else if(is_object(obj[new_prop]))E.escape_dotted_keys(obj[new_prop],repl)}}};E.ensure_array=function(v,split){if(v==null||Array.isArray(v))return v||[];if(split&&typeof v=="string")return v.split(split==true?/[ ,]+/:split).filter(Boolean);return[v]};return E}.apply(exports,__WEBPACK_AMD_DEFINE_ARRAY__),__WEBPACK_AMD_DEFINE_RESULT__!==undefined&&(module.exports=__WEBPACK_AMD_DEFINE_RESULT__))})()},function(module,exports,__webpack_require__){var __WEBPACK_AMD_DEFINE_ARRAY__,__WEBPACK_AMD_DEFINE_RESULT__;var module;
// LICENSE_CODE ZON ISC
"use strict";(function(){var process,zerr,assert;var is_node=typeof module=="object"&&module.exports&&module.children;var is_rn=typeof global=="object"&&!!global.nativeRequire||typeof navigator=="object"&&navigator.product=="ReactNative";if(!is_node){if(is_rn){}else;process={nextTick:function(fn){setTimeout(fn,0)},env:{}};if(!is_rn&&self.hola&&self.hola.zerr)zerr=self.hola.zerr;else{zerr=function(){console.log.apply(console,arguments)};zerr.perr=zerr;zerr.debug=function(){};zerr.is=function(){return false};zerr.L={DEBUG:0}}if(!zerr.is)zerr.is=function(){return false}}else{require("./config.js");process=global.process||require("_process");zerr=require("./zerr.js");assert=require("assert")}if(typeof assert!="function")assert=function(){};!(__WEBPACK_AMD_DEFINE_ARRAY__=[__webpack_require__(43),__webpack_require__(26),__webpack_require__(10)],__WEBPACK_AMD_DEFINE_RESULT__=function(events,array,zutil){var E=Etask;var etask=Etask;var env=process.env,assign=Object.assign;E.use_bt=+env.ETASK_BT;E.root=[];E.assert_extra=+env.ETASK_ASSERT_EXTRA;E.nextTick=process.nextTick;E.set_zerr=function(_zerr){zerr=_zerr};E.events=new events;var cb_pre,cb_post,cb_ctx,longcb_ms,perf_enable;E.perf_stat={};if(is_rn)E.etask=E;function _cb_pre(et){return{start:Date.now()}}function _cb_post(et,ctx){ctx=ctx||cb_ctx;var ms=Date.now()-ctx.start;if(longcb_ms&&ms>longcb_ms){zerr("long cb "+ms+"ms: "+et.get_name()+", "+et.run_state.f.toString().slice(0,128))}if(perf_enable){var name=et.get_name();var perf=E.perf_stat[name]||(E.perf_stat[name]={ms:0,n:0,max:0});if(perf.max<ms)perf.max=ms;perf.ms+=ms;perf.n++}}function cb_set(){if(longcb_ms||perf_enable){cb_pre=_cb_pre;cb_post=_cb_post;cb_ctx={start:Date.now()}}else cb_pre=cb_post=cb_ctx=undefined}E.longcb=function(ms){longcb_ms=ms;cb_set()};E.perf=function(enable){if(arguments.length){perf_enable=enable;cb_set()}return perf_enable};E.longcb(+env.LONGCB);E.perf(+env.ETASK_PERF);function stack_get(){var prev=Error.stackTraceLimit,err;Error.stackTraceLimit=4;err=new Error;Error.stackTraceLimit=prev;return err}function Etask(opt,states){if(!(this instanceof Etask))return new Etask(opt,states);if(Array.isArray(opt)||typeof opt=="function"){states=opt;opt=undefined}opt=typeof opt=="string"&&{name:opt}||opt||{};if(typeof states=="function"){if(states.constructor.name=="GeneratorFunction")return E._generator(null,states,opt);states=[states]}this.cur_state=this.states=this._finally=this.error=this.at_return=this.next_state=this.use_retval=this.running=this.at_continue=this.cancel=this.wait_timer=this.retval=this.run_state=this._stack=this.down=this.up=this.child=this.name=this._name=this.parent=this.cancelable=this.tm_create=this._alarm=this.tm_completed=this.parent_type=this.info=this.then_waiting=this.free=this.parent_guess=this.child_guess=this.wait_retval=undefined;this.name=opt.name;this._name=this.name===undefined?"noname":this.name;this.cancelable=opt.cancel;this.then_waiting=[];this.child=[];this.child_guess=[];this.cur_state=-1;this.states=[];this._stack=Etask.use_bt?stack_get():undefined;this.tm_create=Date.now();this.info={};var idx=this.states.idx={};for(var i=0;i<states.length;i++){var pstate=states[i],t;if(typeof pstate!="function")assert(0,"invalid state type");t=this._get_func_type(pstate);var state={f:pstate,label:t.label,try_catch:t.try_catch,catch:t.catch,finally:t.finally,cancel:t.cancel,sig:undefined};if(i==0&&opt.state0_args){state.f=state.f.bind.apply(state.f,[this].concat(opt.state0_args))}if(state.label)idx[state.label]=i;assert((state.catch||state.try_catch?1:0)+(state.finally?1:0)+(state.cancel?1:0)<=1,"invalid multiple state types");state.sig=state.finally||state.cancel;if(state.finally){assert(this._finally===undefined,"more than 1 finally$");this._finally=i}if(state.cancel){assert(this.cancel===undefined,"more than 1 cancel$");this.cancel=i}this.states[i]=state}var _this=this;E.root.push(this);var in_run=E.in_run_top();if(opt.spawn_parent)this.spawn_parent(opt.spawn_parent);else if(opt.up)opt.up._set_down(this);else if(in_run)this._spawn_parent_guess(in_run);if(opt.init)opt.init.call(this);if(opt.async){var wait_retval=this._set_wait_retval();E.nextTick((function(){if(_this.running!==undefined)return;_this._got_retval(wait_retval)}))}else this._next_run();return this}zutil.inherits(Etask,events.EventEmitter);E.prototype._root_remove=function(){assert(!this.parent,"cannot remove from root when has parent");if(!array.rm_elm_tail(E.root,this))assert(0,"etask not in root\n"+E.ps({MARK:this}))};E.prototype._parent_remove=function(){if(this.up){var up=this.up;this.up=this.up.down=undefined;if(up.tm_completed)up._check_free();return}if(this.parent_guess)this._parent_guess_remove();if(!this.parent)return this._root_remove();if(!array.rm_elm_tail(this.parent.child,this)){assert(0,"etask child not in parent\n"+E.ps({MARK:[["child",this],["parent",this.parent]]}))}if(this.parent.tm_completed)this.parent._check_free();this.parent=undefined};E.prototype._check_free=function(){if(this.down||this.child.length)return;this._parent_remove();this.free=true};E.prototype._call_err=function(e){E.ef(e)};E.prototype.emit_safe=function(){try{this.emit.apply(this,arguments)}catch(e){this._call_err(e)}};E.prototype._call_safe=function(state_fn){try{return state_fn.call(this)}catch(e){this._call_err(e)}};E.prototype._complete=function(){if(zerr.is(zerr.L.DEBUG))zerr.debug(this._name+": close");this.tm_completed=Date.now();this.parent_type=this.up?"call":"spawn";if(this.error)this.emit_safe("uncaught",this.error);if(this._finally!==undefined){var ret=this._call_safe(this.states[this._finally].f);if(E.is_err(ret))this._set_retval(ret)}this.emit_safe("finally");this.emit_safe("ensure");if(this.error&&!this.up&&!this.parent&&!this.parent_guess)E.events.emit("uncaught",this);if(this.parent)this.parent.emit("child",this);if(this.up&&(this.down||this.child.length)){var up=this.up;this.up=this.up.down=undefined;this.parent=up;up.child.push(this)}this._check_free();this._del_wait_timer();this.del_alarm();this._ecancel_child();this.emit_safe("finally1");while(this.then_waiting.length)this.then_waiting.shift()()};E.prototype._next=function(rv){if(this.tm_completed)return true;rv=rv||{ret:undefined,err:undefined};var states=this.states;var state=this.at_return?states.length:this.next_state!==undefined?this.next_state:this.cur_state+1;this.retval=rv.ret;this.error=rv.err;if(rv.err!==undefined){if(zerr.on_exception)zerr.on_exception(rv.err);if(this.run_state.try_catch){this.use_retval=true;for(;state<states.length&&states[state].sig;state++);}else for(;state<states.length&&!states[state].catch;state++);}else{for(;state<states.length&&(states[state].sig||states[state].catch);state++);}this.cur_state=state;this.run_state=states[state];this.next_state=undefined;if(this.cur_state<states.length)return false;this._complete();return true};E.prototype._next_run=function(rv){if(this._next(rv))return;this._run()};E.prototype._handle_rv=function(rv){var wait_retval,_this=this,ret=rv.ret;if(ret===this.retval);else if(!ret);else if(ret instanceof Etask){if(!ret.tm_completed){this._set_down(ret);wait_retval=this._set_wait_retval();ret.then_waiting.push((function(){_this._got_retval(wait_retval,E.err_res(ret.error,ret.retval))}));return true}rv.err=ret.error;rv.ret=ret.retval}else if(ret instanceof Etask_err){rv.err=ret.error;rv.ret=undefined}else if(typeof ret.then=="function"){wait_retval=this._set_wait_retval();ret.then((function(ret){_this._got_retval(wait_retval,ret)}),(function(err){_this._got_retval(wait_retval,E.err(err))}));return true}else if(typeof ret.next=="function"&&typeof ret.throw=="function"){rv.ret=E._generator(ret,this.states[this.cur_state]);return this._handle_rv(rv)}return false};E.prototype._set_retval=function(ret){if(ret===this.retval&&!this.error);else if(!ret){this.retval=ret;this.error=undefined}else if(ret instanceof Etask){if(ret.tm_completed){this.retval=ret.retval;this.error=ret.error}}else if(ret instanceof Etask_err){this.retval=undefined;this.error=ret.error}else if(typeof ret.then=="function");else if(typeof ret.next=="function"&&typeof ret.throw=="function");else{this.retval=ret;this.error=undefined}return ret};E.prototype._set_wait_retval=function(){return this.wait_retval=new Etask_wait(this,"wait_int")};E.in_run=[];E.in_run_top=function(){return E.in_run[E.in_run.length-1]};E.prototype._run=function(){var rv={ret:undefined,err:undefined};while(1){var cb_ctx;var arg=this.error&&!this.use_retval?this.error:this.retval;this.use_retval=false;this.running=true;rv.ret=rv.err=undefined;E.in_run.push(this);if(zerr.is(zerr.L.DEBUG))zerr.debug(this._name+":S"+this.cur_state+": running");if(cb_pre)cb_ctx=cb_pre(this);try{rv.ret=this.run_state.f.call(this,arg)}catch(e){rv.err=e;if(rv.err instanceof Error)rv.err.etask=this}if(cb_post)cb_post(this,cb_ctx);this.running=false;E.in_run.pop();for(;this.child_guess.length;this.child_guess.pop().parent_guess=undefined);if(rv.ret instanceof Etask_wait){var wait_completed=false,wait=rv.ret;if(!this.at_continue&&!wait.ready){this.wait_retval=wait;if(wait.op=="wait_child")wait_completed=this._set_wait_child(wait);if(wait.timeout)this._set_wait_timer(wait.timeout);if(!wait_completed)return;this.wait_retval=undefined}rv.ret=this.at_continue?this.at_continue.ret:wait.ready&&!wait.completed?wait.ready.ret:undefined;wait.completed=true}this.at_continue=undefined;if(this._handle_rv(rv))return;if(this._next(rv))return}};E.prototype._set_down=function(down){if(this.down)assert(0,"caller already has a down\n"+this.ps());if(down.parent_guess)down._parent_guess_remove();assert(!down.parent,"returned etask already has a spawn parent");assert(!down.up,"returned etask already has a caller parent");down._parent_remove();this.down=down;down.up=this};var func_type_cache={};E.prototype._get_func_type=function(func,on_fail){var name=func.name;var type=func_type_cache[name];if(type)return type;type=func_type_cache[name]={name:undefined,label:undefined,try_catch:undefined,catch:undefined,finally:undefined,cancel:undefined};if(!name)return type;type.name=name;var n=name.split("$");if(n.length==1){type.label=n[0];return type}if(n.length>2)return type;if(n[1].length)type.label=n[1];var f=n[0].split("_");for(var j=0;j<f.length;j++){if(f[j]=="try"){type.try_catch=true;if(f[j+1]=="catch")j++}else if(f[j]=="catch")type["catch"]=true;else if(f[j]=="finally"||f[j]=="ensure")type.finally=true;else if(f[j]=="cancel")type.cancel=true;else{return void(on_fail||assert.bind(null,false))("unknown func name "+name)}}return type};E.prototype.spawn=function(child,replace){if(!(child instanceof Etask)&&child&&typeof child.then=="function"){var promise=child;child=etask([function(){return promise}])}if(!(child instanceof Etask)){this.emit("child",child);return child}if(!replace&&child.parent)assert(0,"child already has a parent\n"+child.parent.ps());child.spawn_parent(this);return child};E.prototype._spawn_parent_guess=function(parent){this.parent_guess=parent;parent.child_guess.push(this)};E.prototype._parent_guess_remove=function(){if(!array.rm_elm_tail(this.parent_guess.child_guess,this))assert(0,"etask not in parent_guess\n"+E.ps({MARK:this}));this.parent_guess=undefined};E.prototype.spawn_parent=function(parent){if(this.up)assert(0,"child already has an up\n"+this.up.ps());if(this.tm_completed&&!this.parent)return;this._parent_remove();if(parent&&parent.free)parent=undefined;if(!parent)return void E.root.push(this);parent.child.push(this);this.parent=parent};E.prototype.set_state=function(name){var state=this.states.idx[name];assert(state!==undefined,'named func "'+name+'" not found');return this.next_state=state};E.prototype.finally=function(cb){this.prependListener("finally",cb)};E.prototype.goto_fn=function(name){return this.goto.bind(this,name)};E.prototype.goto=function(name,promise){this.set_state(name);var state=this.states[this.next_state];assert(!state.sig,"goto to sig");return this.continue(promise)};E.prototype.loop=function(promise){this.next_state=this.cur_state;return promise};E.prototype._set_wait_timer=function(timeout){var _this=this;this.wait_timer=setTimeout((function(){_this.wait_timer=undefined;_this._next_run({ret:undefined,err:"timeout"})}),timeout)};E.prototype._del_wait_timer=function(){if(this.wait_timer)this.wait_timer=clearTimeout(this.wait_timer);this.wait_retval=undefined};E.prototype._get_child_running=function(from){var i,child=this.child;for(i=from||0;i<child.length&&child[i].tm_completed;i++);return i>=child.length?-1:i};E.prototype._set_wait_child=function(wait_retval){var i,_this=this,child=wait_retval.child;var cond=wait_retval.cond,wait_on;assert(!cond||child=="any",'condition supported only for "any" '+"option, you can add support if needed");if(child=="any"){if(this._get_child_running()<0)return true;wait_on=function(){_this.once("child",(function(child){if(!cond||cond.call(child,child.retval))return _this._got_retval(wait_retval,{child:child});if(_this._get_child_running()<0)return _this._got_retval(wait_retval);wait_on()}))};wait_on()}else if(child=="all"){if((i=this._get_child_running())<0)return true;wait_on=function(child){_this.once("child",(function(child){var i;if((i=_this._get_child_running())<0)return _this._got_retval(wait_retval);wait_on(_this.child[i])}))};wait_on(this.child[i])}else{assert(child,"no child provided");assert(this===child.parent,"child does not belong to parent");if(child.tm_completed)return true;child.once("finally",(function(){return _this._got_retval(wait_retval,{child:child})}))}this.emit_safe("wait_on_child")};E.prototype._got_retval=function(wait_retval,res){if(this.wait_retval!==wait_retval||wait_retval.completed)return;wait_retval.completed=true;if(!this._next(E._res2rv(res)))this._run()};E.prototype.continue_fn=function(){return this.continue.bind(this)};E.continue_depth=0;E.prototype.continue=function(promise,sync){this.wait_retval=undefined;this._set_retval(promise);if(this.tm_completed)return promise;if(this.down)this.down._ecancel();this._del_wait_timer();var rv={ret:promise,err:undefined};if(this.running){this.at_continue=rv;return promise}if(this._handle_rv(rv))return rv.ret;var _this=this;if(E.is_final(promise)&&(!E.continue_depth&&!E.in_run.length||sync)){E.continue_depth++;this._next_run(rv);E.continue_depth--}else E.nextTick((function(){_this._next_run(rv)}));return promise};E.prototype._ecancel=function(){if(this.tm_completed)return this;this.emit_safe("cancel");if(this.cancel!==undefined)return this._call_safe(this.states[this.cancel].f);if(this.cancelable)return this.return()};E.prototype._ecancel_child=function(){if(!this.child.length)return;var child=Array.from(this.child);for(var i=0;i<child.length;i++)child[i]._ecancel()};E.prototype.return_fn=function(){return this.return.bind(this)};E.prototype.return=function(promise){if(this.tm_completed)return this._set_retval(promise);this.at_return=true;this.next_state=undefined;return this.continue(promise,true)};E.prototype.del_alarm=function(){var a=this._alarm;if(!a)return;clearTimeout(a.id);if(a.cb)this.removeListener("sig_alarm",a.cb);this._alarm=undefined};E.prototype.alarm_left=function(){var a=this._alarm;if(!a)return 0;return a.start-Date.now()};E.prototype._operation_opt=function(opt){if(opt.goto)return{ret:this.goto(opt.goto,opt.ret)};if(opt.throw)return{ret:this.throw(opt.throw)};if(opt.return!==undefined)return{ret:this.return(opt.return)};if(opt.continue!==undefined)return{ret:this.continue(opt.continue)}};E.prototype.alarm=function(ms,cb){var _this=this,opt,a;if(cb&&typeof cb!="function"){opt=cb;cb=function(){var v;if(!(v=_this._operation_opt(opt)))assert(0,"invalid alarm cb opt");return v.ret}}this.del_alarm();a=this._alarm={ms:ms,cb:cb,start:Date.now()};a.id=setTimeout((function(){_this._alarm=undefined;_this.emit("sig_alarm")}),a.ms);if(cb)this.once("sig_alarm",cb)};function Etask_wait(et,op,timeout){this.timeout=timeout;this.et=et;this.op=op;this.child=this.at_child=this.cond=undefined;this.ready=this.completed=undefined}Etask_wait.prototype.continue=function(res){if(this.completed)return;if(!this.et.wait_retval)return void(this.ready={ret:res});if(this!==this.et.wait_retval)return;this.et.continue(res)};Etask_wait.prototype.continue_fn=function(){return this.continue.bind(this)};Etask_wait.prototype.throw=function(err){return this.continue(E.err(err))};Etask_wait.prototype.throw_fn=function(){return this.throw.bind(this)};E.prototype.wait=function(timeout){return new Etask_wait(this,"wait",timeout)};E.prototype.wait_child=function(child,timeout,cond){if(typeof timeout=="function"){cond=timeout;timeout=0}var wait=new Etask_wait(this,"wait_child",timeout);wait.child=child;wait.at_child=null;wait.cond=cond;return wait};E.prototype.throw_fn=function(err){return err?this.throw.bind(this,err):this.throw.bind(this)};E.prototype.throw=function(err){return this.continue(E.err(err))};E.prototype.get_name=function(flags){var stack=this._stack instanceof Error?this._stack.stack.split("\n"):undefined;var caller;flags=flags||{};if(stack){caller=/^    at (.*)$/.exec(stack[4]);caller=caller?caller[1]:undefined}var names=[];if(this.name)names.push(this.name);if(caller&&!(this.name&&flags.SHORT_NAME))names.push(caller);if(!names.length)names.push("noname");return names.join(" ")};E.prototype.state_str=function(){return this.cur_state+(this.next_state?"->"+this.next_state:"")};E.prototype.get_depth=function(){var i=0,et=this;for(;et;et=et.up,i++);return i};function trim_space(s){if(s[s.length-1]!=" ")return s;return s.slice(0,-1)}function ms_to_str(ms){var s=""+ms;return s.length<=3?s+"ms":s.slice(0,-3)+"."+s.slice(-3)+"s"}E.prototype.get_time_passed=function(){return ms_to_str(Date.now()-this.tm_create)};E.prototype.get_time_completed=function(){return ms_to_str(Date.now()-this.tm_completed)};E.prototype.get_info=function(){var info=this.info,s="",_i;if(!info)return"";for(var i in info){_i=info[i];if(!_i)continue;if(s!=="")s+=" ";if(typeof _i=="function")s+=_i();else s+=_i}return trim_space(s)};function Etask_err(err){this.error=err||new Error}E.Etask_err=Etask_err;E.err=function(err){return new Etask_err(err)};E.is_err=function(v){return v instanceof Etask&&v.error!==undefined||v instanceof Etask_err};E.err_res=function(err,res){return err?E.err(err):res};E._res2rv=function(res){return E.is_err(res)?{ret:undefined,err:res.error}:{ret:res,err:undefined}};E.is_final=function(v){return!v||typeof v.then!="function"||v instanceof Etask_err||v instanceof Etask&&!!v.tm_completed};E.prototype.then=function(on_res,on_err){var _this=this;function on_done(){if(!_this.error)return!on_res?_this.retval:on_res(_this.retval);return!on_err?E.err(_this.error):on_err(_this.error)}if(this.tm_completed)return etask("then_completed",[function(){return on_done()}]);var then_wait=etask("then_wait",[function(){return this.wait()}]);this.then_waiting.push((function(){try{then_wait.continue(on_done())}catch(e){then_wait.throw(e)}}));return then_wait};E.prototype.otherwise=E.prototype.catch=function(on_err){return this.then(null,on_err)};E.prototype.ensure=function(on_ensure){return this.then((function(res){on_ensure();return res}),(function(err){on_ensure();throw err}))};Etask_err.prototype.then=function(on_res,on_err){var _this=this;return etask("then_err",[function(){return!on_err?E.err(_this.error):on_err(_this.error)}])};Etask_err.prototype.otherwise=Etask_err.prototype.catch=function(on_err){return this.then(null,on_err)};Etask_err.prototype.ensure=function(on_ensure){this.then(null,(function(){on_ensure()}));return this};E.resolve=function(res){return etask([function(){return res}])};E.reject=function(err){return etask([function(){throw err}])};E.prototype.wait_ext=function(promise){if(!promise||typeof promise.then!="function")return promise;var wait=this.wait();promise.then(wait.continue_fn(),wait.throw_fn());return wait};E.prototype.longname=function(flags){flags=flags||{TIME:1};var s="",_s;if(this.running)s+="RUNNING ";s+=this.get_name(flags)+(!this.tm_completed?"."+this.state_str():"")+" ";if(this.tm_completed)s+="COMPLETED"+(flags.TIME?" "+this.get_time_completed():"")+" ";if(flags.TIME)s+=this.get_time_passed()+" ";if(_s=this.get_info())s+=_s+" ";return trim_space(s)};E.prototype.stack=function(flags){var et=this,s="";flags=assign({STACK:1,RECURSIVE:1,GUESS:1},flags);while(et){var _s=et.longname(flags)+"\n";if(et.up)et=et.up;else if(et.parent){_s=(et.parent_type=="call"?"CALL":"SPAWN")+" "+_s;et=et.parent}else if(et.parent_guess&&flags.GUESS){_s="SPAWN? "+_s;et=et.parent_guess}else et=undefined;if(flags.TOPDOWN)s=_s+s;else s+=_s}return s};E.prototype._ps=function(pre_first,pre_next,flags){var i,s="",task_trail,et=this,child_guess;if(++flags.limit_n>=flags.LIMIT)return flags.limit_n==flags.LIMIT?"\nLIMIT "+flags.LIMIT+"\n":"";for(;et.up;et=et.up);for(var first=1;et;et=et.down,first=0){s+=first?pre_first:pre_next;first=0;if(flags.MARK&&(i=flags.MARK.sp.indexOf(et))>=0)s+=(flags.MARK.name[i]||"***")+" ";s+=et.longname(flags)+"\n";if(flags.RECURSIVE){var stack_trail=et.down?".":" ";var child=et.child;if(flags.GUESS)child=child.concat(et.child_guess);for(i=0;i<child.length;i++){task_trail=i<child.length-1?"|":stack_trail;child_guess=child[i].parent_guess?"\\? ":child[i].parent_type=="call"?"\\> ":"\\_ ";s+=child[i]._ps(pre_next+task_trail+child_guess,pre_next+task_trail+"   ",flags)}}}return s};function ps_flags(flags){var m,_m;if(m=flags.MARK){if(!Array.isArray(m))_m={sp:[m],name:[]};else if(!Array.isArray(flags.MARK[0]))_m={sp:m,name:[]};else{_m={sp:[],name:[]};for(var i=0;i<m.length;i++){_m.name.push(m[i][0]);_m.sp.push(m[i][1])}}flags.MARK=_m}}E.prototype.ps=function(flags){flags=assign({STACK:1,RECURSIVE:1,LIMIT:1e7,TIME:1,GUESS:1},flags,{limit_n:0});ps_flags(flags);return this._ps("","",flags)};E._longname_root=function(){return(zerr.prefix?zerr.prefix+"pid "+process.pid+" ":"")+"root"};E.ps=function(flags){var i,s="",task_trail;flags=assign({STACK:1,RECURSIVE:1,LIMIT:1e7,TIME:1,GUESS:1},flags,{limit_n:0});ps_flags(flags);s+=E._longname_root()+"\n";var child=E.root;if(flags.GUESS){child=[];for(i=0;i<E.root.length;i++){if(!E.root[i].parent_guess)child.push(E.root[i])}}for(i=0;i<child.length;i++){task_trail=i<child.length-1?"|":" ";s+=child[i]._ps(task_trail+"\\_ ",task_trail+"   ",flags)}return s};function assert_tree_unique(a){var i;for(i=0;i<a.length-1;i++)assert(!a.includes(a[i],i+1))}E.prototype._assert_tree=function(opt){var i,et;opt=opt||{};assert_tree_unique(this.child);assert(this.parent);if(this.down){et=this.down;assert(et.up===this);assert(!et.parent);assert(!et.parent_guess);this.down._assert_tree(opt)}for(i=0;i<this.child.length;i++){et=this.child[i];assert(et.parent===this);assert(!et.parent_guess);assert(!et.up);et._assert_tree(opt)}if(this.child_guess.length)assert(E.in_run.includes(this));for(i=0;i<this.child_guess.length;i++){et=this.child_guess[i];assert(et.parent_guess===this);assert(!et.parent);assert(!et.up)}};E._assert_tree=function(opt){var i,et,child=E.root;opt=opt||{};assert_tree_unique(E.root);for(i=0;i<child.length;i++){et=child[i];assert(!et.parent);assert(!et.up);et._assert_tree(opt)}};E.prototype._assert_parent=function(){if(this.up)return assert(!this.parent&&!this.parent_guess);assert(this.parent&&this.parent_guess,"parent_guess together with parent");if(this.parent){var child=this.parent?this.parent.child:E.root;assert(child.includes(this),"cannot find in parent "+(this.parent?"":"root"))}else if(this.parent_guess){assert(this.parent_guess.child_guess.includes(this),"cannot find in parent_guess");assert(E.in_run.includes(this.parent_guess))}};E.prototype.return_child=function(){var child=Array.from(this.child);for(var i=0;i<child.length;i++)child[i].return()};E.sleep=function(ms){var timer;ms=ms||0;return etask({name:"sleep",cancel:true},[function(){this.info.ms=ms+"ms";timer=setTimeout(this.continue_fn(),ms);return this.wait()},function finally$(){clearTimeout(timer)}])};var ebreak_obj={ebreak:1};E.prototype.break=function(ret){return this.throw({ebreak:ebreak_obj,ret:ret})};E.for=function(cond,inc,opt,states){if(Array.isArray(opt)||typeof opt=="function"){states=opt;opt={}}if(typeof states=="function")states=[states];opt=opt||{};return etask({name:"for",cancel:true,init:opt.init_parent},[function loop(){return!cond||cond.call(this)},function try_catch$(res){if(!res)return this.return();return etask({name:"for_iter",cancel:true,init:opt.init},states||[])},function(){if(this.error){if(this.error.ebreak===ebreak_obj)return this.return(this.error.ret);return this.throw(this.error)}return inc&&inc.call(this)},function(){return this.goto("loop")}])};E.for_each=function(obj,states){var keys=Object.keys(obj);var iter={obj:obj,keys:keys,i:0,key:undefined,val:undefined};function init_iter(){this.iter=iter}return E.for((function(){this.iter=this.iter||iter;iter.key=keys[iter.i];iter.val=obj[keys[iter.i]];return iter.i<keys.length}),(function(){return iter.i++}),{init:init_iter,init_parent:init_iter},states)};E.while=function(cond,states){return E.for(cond,null,states)};E.all=function(a_or_o,ao2){var i,j,opt={};if(ao2){opt=a_or_o;a_or_o=ao2}if(Array.isArray(a_or_o)){var a=Array.from(a_or_o);i=0;return etask({name:"all_a",cancel:true},[function(){for(j=0;j<a.length;j++)this.spawn(a[j])},function try_catch$loop(){if(i>=a.length)return this.return(a);this.info.at="at "+i+"/"+a.length;var _a=a[i];if(_a instanceof Etask)_a.spawn_parent();return _a},function(res){if(this.error){if(!opt.allow_fail)return this.throw(this.error);res=E.err(this.error)}a[i]=res;i++;return this.goto("loop")}])}else if(a_or_o instanceof Object){var keys=Object.keys(a_or_o),o={};i=0;return etask({name:"all_o",cancel:true},[function(){for(j=0;j<keys.length;j++)this.spawn(a_or_o[keys[j]])},function try_catch$loop(){if(i>=keys.length)return this.return(o);var _i=keys[i],_a=a_or_o[_i];this.info.at="at "+_i+" "+i+"/"+keys.length;if(_a instanceof Etask)_a.spawn_parent();return _a},function(res){if(this.error){if(!opt.allow_fail)return this.throw(this.error);res=E.err(this.error)}o[keys[i]]=res;i++;return this.goto("loop")}])}assert(0,"invalid type")};E.all_limit=function(limit,arr_iter,cb){var at=0;var iter=!Array.isArray(arr_iter)?arr_iter:function(){if(at<arr_iter.length)return cb.call(this,arr_iter[at++])};return etask({name:"all_limit",cancel:true},[function(){var next;if(!(next=iter.call(this)))return this.goto("done");this.spawn(next);this.loop();if(this.child.length>=limit)return this.wait_child("any")},function done(){return this.wait_child("all")}])};E._apply=function(opt,func,_this,args){var func_name;if(typeof _this=="string"){assert(_this[0]==".","invalid method "+_this);var method=_this.slice(1),_class=func;func=_class[method];_this=_class;assert(_this instanceof Object,"invalid method ."+method);func_name=method}else if(Array.isArray(_this)&&!args){args=_this;_this=null}opt.name=opt.name||func_name||func.name;return etask(opt,[function(){var et=this,ret_sync,returned=0;args=Array.from(args);args.push((function cb(err,res){if(typeof opt.ret_sync=="string"&&!returned){var a=arguments;returned++;return void E.nextTick((function(){cb.apply(null,a)}))}var nfn=opt.nfn===undefined||opt.nfn?1:0;if(opt.ret_o){var o={},i;if(Array.isArray(opt.ret_o)){for(i=0;i<opt.ret_o.length;i++)o[opt.ret_o[i]]=arguments[i+nfn]}else if(typeof opt.ret_o=="string")o[opt.ret_o]=array.slice(arguments,nfn);else assert(0,"invalid opt.ret_o");if(typeof opt.ret_sync=="string")o[opt.ret_sync]=ret_sync;res=o}else if(opt.ret_a)res=array.slice(arguments,nfn);else if(!nfn)res=err;et.continue(nfn?E.err_res(err,res):res)}));ret_sync=func.apply(_this,args);if(Array.isArray(opt.ret_sync))opt.ret_sync[0][opt.ret_sync[1]]=ret_sync;returned++;return this.wait()}])};E.nfn_apply=function(opt,func,_this,args){var _opt={nfn:1,cancel:1};if(typeof opt=="function"||typeof func=="string"){args=_this;_this=func;func=opt;opt=_opt}else opt=assign(_opt,opt);return E._apply(opt,func,_this,args)};E.cb_apply=function(opt,func,_this,args){var _opt={nfn:0};if(typeof opt=="function"||typeof func=="string"){args=_this;_this=func;func=opt;opt=_opt}else opt=assign(_opt,opt);return E._apply(opt,func,_this,args)};E.prototype.continue_nfn=function(){return function(err,res){this.continue(E.err_res(err,res))}.bind(this)};E.augment=function(_prototype,method,e_method){var i,opt={};if(method instanceof Object&&!Array.isArray(method)){assign(opt,method);method=arguments[2];e_method=arguments[3]}if(Array.isArray(method)){if(e_method)opt.prefix=e_method;for(i=0;i<method.length;i++)E.augment(_prototype,opt,method[i]);return}opt.prefix=opt.prefix||"e_";if(!e_method)e_method=opt.prefix+method;var fn=_prototype[method];_prototype[e_method]=function(){return etask._apply({name:e_method,nfn:1},fn,this,arguments)}};E.wait=function(timeout){return etask({name:"wait",cancel:true},[function(){return this.wait(timeout)}])};E.to_nfn=function(promise,cb,opt){return etask({name:"to_nfn",async:true},[function try_catch$(){return promise},function(res){var ret=[this.error];if(opt&&opt.ret_a)ret=ret.concat(res);else ret.push(res);cb.apply(null,ret)}])};function etask_fn(opt,states,push_this){if(Array.isArray(opt)||typeof opt=="function"){states=opt;opt=undefined}var is_generator=typeof states=="function"&&states.constructor.name=="GeneratorFunction";return function(){var _opt=assign({},opt);_opt.state0_args=Array.from(arguments);if(push_this)_opt.state0_args.unshift(this);if(is_generator)return E._generator(null,states,_opt);return new Etask(_opt,states)}}E.fn=function(opt,states){return etask_fn(opt,states,false)};E._fn=function(opt,states){return etask_fn(opt,states,true)};E._generator=function(gen,ctor,opt){opt=opt||{};opt.name=opt.name||ctor&&ctor.name||"generator";if(opt.cancel===undefined)opt.cancel=true;var done;return new Etask(opt,[function(){this.generator=gen=gen||ctor.apply(this,opt.state0_args||[]);this.generator_ctor=ctor;return{ret:undefined,err:undefined}},function try_catch$loop(rv){var res;try{res=rv.err?gen.throw(rv.err):gen.next(rv.ret)}catch(e){return this.return(E.err(e))}if(res.done){done=true;return this.return(res.value)}return res.value},function(ret){return this.goto("loop",this.error?{ret:undefined,err:this.error}:{ret:ret,err:undefined})},function finally$(){if(!done&&gen&&gen.return)try{gen.return()}catch(e){}}])};E.ef=function(err){if(zerr.on_exception)zerr.on_exception(err);return err};E.interval=function(opt,states){if(typeof opt=="number")opt={ms:opt};if(opt.mode=="fixed"){return E.for(null,(function(){return etask.sleep(opt.ms)}),states)}if(opt.mode=="smart"||!opt.mode){var now;return E.for((function(){now=Date.now();return true}),(function(){var delay=zutil.clamp(0,now+opt.ms-Date.now(),Infinity);return etask.sleep(delay)}),states)}if(opt.mode=="spawn"){var stopped=false;return etask([function loop(){etask([function try_catch$(){return etask(states)},function(res){if(!this.error)return;if(this.error.ebreak!==ebreak_obj)return this.throw(this.error);stopped=true}])},function(){if(stopped)return this.return();return etask.sleep(opt.ms)},function(){if(stopped)return this.return();return this.goto("loop")}])}throw new Error("unexpected mode "+opt.mode)};E._class=function(cls){var proto=cls.prototype,keys=Object.getOwnPropertyNames(proto);for(var i=0;i<keys.length;i++){var key=keys[i];var p=proto[key];if(p&&p.constructor&&p.constructor.name=="GeneratorFunction")proto[key]=E._fn(p)}return cls};E.shutdown=function(){var prev;while(E.root.length){var e=E.root[0];if(e==prev){assert(e.tm_completed);zerr.zexit("etask root not removed after return - "+"fix non-cancelable child etask")}prev=e;e.return()}};return Etask}.apply(exports,__WEBPACK_AMD_DEFINE_ARRAY__),__WEBPACK_AMD_DEFINE_RESULT__!==undefined&&(module.exports=__WEBPACK_AMD_DEFINE_RESULT__))})()},function(module,exports,__webpack_require__){var __WEBPACK_AMD_DEFINE_ARRAY__,__WEBPACK_AMD_DEFINE_RESULT__;var module;
// LICENSE_CODE ZON ISC
"use strict";(function(){var process;var is_node=typeof module=="object"&&module.exports&&module.children;var is_rn=typeof global=="object"&&!!global.nativeRequire||typeof navigator=="object"&&navigator.product=="ReactNative";if(is_rn){process={nextTick:function(fn){setTimeout(fn,0)},env:{}}}else if(!is_node){process={env:{}}}else{if(is_node){process=global.process||require("_process");require("./config.js");var cluster=require("cluster");var version=require("./version.js").version}}!(__WEBPACK_AMD_DEFINE_ARRAY__=[__webpack_require__(26),__webpack_require__(16),__webpack_require__(10),__webpack_require__(45),__webpack_require__(46),__webpack_require__(23)],__WEBPACK_AMD_DEFINE_RESULT__=function(array,date,zutil,sprintf,rate_limit,zescape){var E,_zerr;var env=process.env;var zerr=function(msg){_zerr(L.ERR,arguments)};E=zerr;E.zerr=zerr;var L=E.L={EMERG:0,ALERT:1,CRIT:2,ERR:3,WARN:4,NOTICE:5,INFO:6,DEBUG:7};var perr_pending=[];var LINV=E.LINV={};for(var k in L)LINV[L[k]]=k;["debug","info","notice","warn","err","crit"].forEach((function(l){var level=L[l.toUpperCase()];E[l]=function(){return _zerr(level,arguments)}}));E.assert=function(exp,msg){if(!exp)zerr.crit(msg)};E.json=function(o,replacer,space){try{return JSON.stringify(o,replacer,space)||""}catch(e){return"[circular]"}};E.is=function(level){return level<=E.level};["debug","info","notice","warn","err"].forEach((function(l){var level=L[l.toUpperCase()];E.is[l]=function(){return level<=E.level}}));E.perr=function(id,info,opt){E._zerr(!opt||opt.level===undefined?L.ERR:opt.level,["perr "+id+" "+E.json(info)]);if(perr_pending&&perr_pending.length<100)perr_pending.push(Array.from(arguments))};var perr_hooks=[];E.add_perr_hook=perr_hooks.push.bind(perr_hooks);var perr_dropped={};var perr_orig=E.perr;function wrap_perr(perr_fn){var send=perr_fn,pre_send;if(typeof perr_fn!="function"){send=perr_fn.send;pre_send=perr_fn.pre_send}return function(id,info,opt){opt=opt||{};var _rate_limit=opt.rate_limit||{};var ms=_rate_limit.ms||date.ms.HOUR,count=_rate_limit.count||10;var disable_drop_count=_rate_limit.disable_drop_count;var rl_hash=perr_orig.rl_hash=perr_orig.rl_hash||{};var rl=rl_hash[id]=rl_hash[id]||{};if(pre_send)pre_send(id,info,opt);perr_hooks.filter((function(h){return h.ids.test(id)})).forEach((function(h){h.fn(id,info,opt)}));if(opt.rate_limit===false||rate_limit(rl,ms,count)){if(perr_dropped[id]){if(!disable_drop_count&&info&&typeof info!="string")info.w=perr_dropped[id];perr_dropped[id]=null}return send(id,info,opt)}perr_dropped[id]=(perr_dropped[id]||0)+1;if(info&&typeof info!="string")info=zerr.json(info);zerr("perr %s %s rate too high %s %d %d",id,info,zerr.json(rl),ms,count)}}E.perr_install=function(install_fn){E.perr=wrap_perr(install_fn(perr_orig,perr_pending||[]));perr_pending=null};function err_has_stack(err){return err instanceof Error&&err.stack}E.e2s=function(err){if(!is_node&&err_has_stack(err)){var e_str=""+err,e_stack=""+err.stack;return e_stack.startsWith(e_str)?e_stack:e_str+" "+e_stack}return err_has_stack(err)?""+err.stack:""+err};E.on_exception=undefined;var in_exception;E.set_exception_handler=function(prefix,err_func){E.on_exception=function(err){if(!(err instanceof TypeError||err instanceof ReferenceError)||err.sent_perr){return}if(in_exception)return;in_exception=1;err.sent_perr=true;err_func((prefix?prefix+"_":"")+"etask_typeerror",null,err);in_exception=0}};E.on_unhandled_exception=undefined;E.catch_unhandled_exception=function(func,obj){return function(){var args=arguments;try{return func.apply(obj,Array.from(args))}catch(e){E.on_unhandled_exception(e)}}};E.set_level=function(level){var prev="L"+LINV[E.level];level=level||env.ZERR;if(!level)return prev;var val=L[level]||L[level.replace(/^L/,"")];if(val!==undefined)E.level=val;return prev};E.get_stack_trace=function(opt){if(!opt)opt={};if(opt.limit===undefined)opt.limit=Infinity;if(opt.short===undefined)opt.short=true;var old_stack_limit=Error.stackTraceLimit;if(opt.limit)Error.stackTraceLimit=opt.limit;var stack=zerr.e2s(new Error);if(opt.limit)Error.stackTraceLimit=old_stack_limit;if(opt.short){stack=stack.replace(/^.+util\/etask.+$/gm,"    ...").replace(/( {4}\.\.\.\n)+/g,"    ...\n")}return stack};E.log=[];E.log.max_size=200;E.log_tail=function(size){return(E.log||[]).join("\n").substr(-(size||4096))};function log_tail_push(msg){E.log.push(msg);if(E.log.length>E.log.max_size)E.log.splice(0,E.log.length-E.log.max_size/2)}if(is_node){E.ZEXIT_LOG_DIR=env.ZEXIT_LOG_DIR||"/tmp/zexit_logs";E.prefix="";E.prefix_fn=null;E.level=L.NOTICE;E.flush=function(){};E.set_log_buffer=function(on){if(!on){if(E.log_buffer){E.flush();E.log_buffer(0)}return}E.log_buffer=require("log-buffer");E.log_buffer(32*1024);E.flush=function(){E.log_buffer.flush()};setInterval(E.flush,1e3).unref()};var node_init=function(){if(zutil.is_mocha())E.level=L.WARN;else E.prefix=!cluster.isMaster?"C"+cluster.worker.id+" ":""};var init=function(){if(is_node)node_init();E.set_level()};init();var zerr_format=function(args){return args.length<=1?args[0]:sprintf.apply(null,args)};var __zerr=function(level,args){var k=Object.keys(L);var dyn_prefix;if(E.prefix_fn){args=Array.from(args);dyn_prefix=E.prefix_fn(level,args)}var prefix=(dyn_prefix||"")+(E.hide_timestamp?"":E.prefix+date.to_sql_ms()+" ");var msg=zerr_format(args);if(env.CURRENT_SYSTEMD_UNIT_NAME)prefix="<"+level+">"+prefix;var res=prefix+k[level]+": "+msg;console.error(res);log_tail_push(res)};E.set_logger=function(logger){__zerr=function(level,args){var msg=zerr_format(args);logger(level,msg);log_tail_push(E.prefix+date.to_sql_ms()+": "+msg)}};_zerr=function(level,args){if(level>E.level)return;__zerr(level,args)};E._zerr=_zerr;E.zexit=function(args){var stack;if(err_has_stack(args)){stack=args.stack;__zerr(L.CRIT,[E.e2s(args)])}else{var e=new Error;stack=e.stack;__zerr(L.CRIT,arguments)}if((args&&args.code)!="ERR_ASSERTION")console.error("zerr.zexit was called",(new Error).stack);E.flush();if(process.zon&&process.zon.main){var LCRIT=2;var LCONSOLE=256;var emb_zutil=process.binding("zutil");emb_zutil.zerr(LCRIT|LCONSOLE,"perr node_zexit "+E.e2s(args));process.exit(1)}if(env.NODE_ENV=="production"){var conf=require("./conf.js");var zcounter_file=require("./zcounter_file.js");zcounter_file.inc("server_zexit");args=zerr_format(arguments);write_zexit_log({id:"lerr_server_zexit",info:""+args,ts:date.to_sql(),backtrace:stack,version:version,app:conf.app});E.flush()}debugger;process.exit(1)};var write_zexit_log=function(json){try{var file=require("./file.js");file.mkdirp(E.ZEXIT_LOG_DIR);file.write_atomic_e(E.ZEXIT_LOG_DIR+"/"+date.to_log_file()+"_zexit_"+process.pid+".log",E.json(json))}catch(e){E.zerr(E.e2s(e))}}}else{var chrome;E.log=[];var L_STR=E.L_STR=["EMERGENCY","ALERT","CRITICAL","ERROR","WARNING","NOTICE","INFO","DEBUG"];E.log.max_size=200;if(is_rn){E.level=L.WARN;E.hide_timestamp=true}else{chrome=self.chrome;E.conf=self.conf;E.level=self.is_tpopup?L.CRITICAL:E.conf&&E.conf.zerr_level?L[self.conf.zerr_level]:L.WARN}var console_method=function(l){if(is_rn)return l<=L.NOTICE?"log":l<=L.INFO?"info":"debug";return l<=L.ERR?"error":!chrome?"log":l===L.WARN?"warn":l<=L.INFO?"info":"debug"};_zerr=function(l,args){var s;try{var fmt=""+args[0];var fmt_args=Array.prototype.slice.call(args,1);s=(fmt+(fmt_args.length?" "+E.json(fmt_args):"")).substr(0,1024);var prefix=(E.hide_timestamp?"":date.to_sql_ms()+" ")+L_STR[l]+": ";if(E.is(l)){Function.prototype.apply.bind(console[console_method(l)],console)([prefix+fmt].concat(fmt_args))}log_tail_push(prefix+s)}catch(err){try{console.error("ERROR in zerr "+(err.stack||err),arguments)}catch(e){}}if(l<=L.CRIT)throw new Error(s)};E._zerr=_zerr;var post=function(url,data){var use_xdr=typeof XDomainRequest=="function"&&!("withCredentials"in XMLHttpRequest.prototype);var req=use_xdr?new XDomainRequest:new XMLHttpRequest;req.open("POST",url);if(req.setRequestHeader){req.setRequestHeader("Content-Type","application/x-www-form-urlencoded; charset=UTF-8")}req.send(zescape.qs(data));return req};var perr_transport=function(id,info,opt){opt=zutil.clone(opt||{});var qs=opt.qs||{},data=opt.data||{};data.is_json=1;if(info&&typeof info!="string")info=zerr.json(info);if(opt.err&&!info)info=""+(opt.err.message||zerr.json(opt.err));data.info=info;qs.id=id;if(!opt.no_zerr){zerr._zerr(opt.level,["perr "+id+(info?" info: "+info:"")+(opt.bt?"\n"+opt.bt:"")])}return post(zescape.uri(E.conf.url_perr+"/perr",qs),data)};var perr=function(perr_orig,pending){while(pending.length)perr_transport.apply(null,pending.shift());return perr_transport};E.perr_install(perr)}return E}.apply(exports,__WEBPACK_AMD_DEFINE_ARRAY__),__WEBPACK_AMD_DEFINE_RESULT__!==undefined&&(module.exports=__WEBPACK_AMD_DEFINE_RESULT__))})()},function(module,exports,__webpack_require__){var __WEBPACK_AMD_DEFINE_ARRAY__,__WEBPACK_AMD_DEFINE_RESULT__;var module;
// LICENSE_CODE ZON
"use strict";(function(){const is_node=typeof module=="object"&&module.exports&&module.children;if(!is_node);else;!(__WEBPACK_AMD_DEFINE_ARRAY__=[__webpack_require__(11),__webpack_require__(18),__webpack_require__(10),__webpack_require__(49),__webpack_require__(12)],__WEBPACK_AMD_DEFINE_RESULT__=function(etask,zurl,zutil,pcountries,zerr){const E={};E.assert=(exp,err,msg)=>{if(exp)return;zerr("assert failed exp %s err %s msg %s",exp,err,msg);err=err||exp;throw err instanceof Error?err:new Error(err)};E.assert_bg=f=>zerr.assert(E.is_bg(),`file ${f} can only be included in background`);E.assert_ui=f=>zerr.assert(!E.is_bg(),`file ${f} can only be included in ui`);E.new_etask=n=>etask(n,(function*new_etask(){yield this.wait()}));E.set_timeout=(cb,t,opt)=>{opt=opt||{};const name="set_timeout_"+(opt.name||cb.name||"unknown");const sp=etask((function*set_timeout(){this.name=name;yield etask.sleep(t);cb()}));if(opt.sp)opt.sp.spawn(sp);return sp};E.set_interval=(cb,t,opt)=>{opt=opt||{};const name="set_interval_"+(opt.name||cb.name||"unknown");const sp=etask((function*set_interval(){this.name=name;while(true){yield etask.sleep(t);cb()}}));if(opt.sp)opt.sp.spawn(sp);return sp};E.clear_timeout=E.clear_interval=et=>{if(et)et.return()};E.is_all_browser=rule=>rule&&rule.name=="all_browser";E.is_skip_url=url=>{if(!url)return true;const protocol=zurl.get_proto(url),host=zurl.get_host(url);return host.search(/^(.*\.)?hola.org$/)!=-1&&url.search(/(access|unblock)\/([^/]*)\/using\/.*/)==-1||zurl.is_ip_port(host)||protocol.search(/^(http|https)$/)==-1||host=="localhost"||!zurl.is_valid_domain(host)};E.get_rules=(_rules,url,ignore)=>{url=url||"";var _r,rules,ret=[],r_enabled=null;if(!_rules||!(rules=_rules.unblocker_rules))return[];for(_r in rules){var r=rules[_r];if(!r.supported)continue;if(!ignore&&r.enabled&&E.is_all_browser(r))return[r];var urls=r.root_url;if(urls&&urls.some(rurl=>{try{return url.match(rurl)}catch(e){}})){if(r.enabled)r_enabled=r;else ret.push(r)}}if(r_enabled)ret.unshift(r_enabled);return ret};E.get_tld_country=host=>{if(!host)return"";var tld=zurl.get_top_level_domain(host);if(!tld)return"";tld=tld.toUpperCase();if(tld=="COM")return"US";if(tld=="UK")tld="GB";var skip_domain=["TV","FM","IO","AM"];if(skip_domain.includes(tld))return"";if(!pcountries.proxy_countries.bext.some(c=>c==tld))return"";return tld};E.get_popular_country=opt=>{var c0,c1,tld=E.get_tld_country(opt.host);var p={};c0=tld||"US";c1=c0=="US"?"GB":"US";p[c0]={proxy_country:c0,rating:.02};p[c1]={proxy_country:c1,rating:.01};var rule_ratings=opt.rule_ratings||[];rule_ratings.forEach(country_ratings=>{if(country_ratings.rating<.1)return;var country=country_ratings.proxy_country.toUpperCase();var ratings={proxy_country:country,rating:country_ratings.rating};p[country]=ratings});var popular_array=[];zutil.forEach(p,r=>{popular_array.push(r)});popular_array.sort((a,b)=>a.rating-b.rating>0?-1:1);return popular_array};E.must_verify_email=user=>user&&user.emails&&!user.verified;E.get_rule_min_fmt=rule=>zutil.pick(rule||{},"name","country");E.is_tpopup=()=>{if(E.get_tpopup_mode()=="window")return true;try{return window!=window.top}catch(e){return true}};E.is_bg=()=>location.pathname=="/js/bg.html";E.is_new_tab=url=>url=="chrome://newtab/";E.root2url=root_url=>"http://"+root_url+"/";E.get_tpopup_type=()=>zutil.get(window,"hola.tpopup_opt.type");E.get_tpopup_mode=()=>zutil.get(window,"hola.tpopup_opt.mode");return E}.apply(exports,__WEBPACK_AMD_DEFINE_ARRAY__),__WEBPACK_AMD_DEFINE_RESULT__!==undefined&&(module.exports=__WEBPACK_AMD_DEFINE_RESULT__))})()},function(module,exports,__webpack_require__){"use strict";var __WEBPACK_AMD_DEFINE_ARRAY__,__WEBPACK_AMD_DEFINE_RESULT__;// LICENSE_CODE ZON
!(__WEBPACK_AMD_DEFINE_ARRAY__=[__webpack_require__(15),__webpack_require__(12),__webpack_require__(27),__webpack_require__(11),__webpack_require__(16),__webpack_require__(23),__webpack_require__(45),__webpack_require__(47),__webpack_require__(48),__webpack_require__(21),__webpack_require__(26),__webpack_require__(10),__webpack_require__(13),__webpack_require__(22),__webpack_require__(50),__webpack_require__(51),__webpack_require__(24)],__WEBPACK_AMD_DEFINE_RESULT__=function(_,zerr,version_util,etask,date,zescape,sprintf,user_agent,ajax,storage,array,zutil,be_vpn_util,svc_util,be_no_log,zconf,conf){const E={};const is_bg=be_vpn_util.is_bg();const chrome=window.chrome;const assign=Object.assign,if_set=zutil.if_set;let ajax_cb,bext_config_cb;be_no_log=be_no_log.default;E.os_guess=user_agent.guess();E.browser_guess=user_agent.guess_browser();E.os_win=()=>E.os_guess.os=="windows";E.os_win8=()=>E.os_guess.version==8;E.os_mac=()=>E.os_guess.os=="macos";E.is_mobile=()=>E.os_guess.mobile;let _is_laptop;E.is_laptop=()=>_is_laptop;E.version=()=>zconf.ZON_VERSION;E.is_google=root_url=>root_url&&(root_url.split(".")[0]=="google"||root_url.split(".")[1]=="google");E.is_youtube=root_url=>root_url&&(root_url.split(".")[0]=="youtube"||root_url.split(".")[1]=="youtube");var check_opera=/\bOPR\b\/(\d+)/i;E.browser=()=>{if(E.browser_guess.edge)return"edge";var ua=navigator.userAgent;var opera=check_opera.exec(ua);return conf.browser.firefox?"firefox":conf.browser.opera||opera&&opera[1]?"opera":"chrome"};E.qs_ajax=o=>{var info={ext_ver:E.version(),browser:E.browser(),product:E.get_product()};if(zutil.is_mocha())info.browser=undefined;assign(info,o);for(var k in info){if(info[k]===undefined)delete info[k]}return info};let storage_perr_sent;storage.on_err=(api,key,err)=>{if(zutil.is_mocha())return;zerr("%s failed %s %s",api,key,zerr.e2s(err));if(storage_perr_sent)return;storage_perr_sent=true;E.perr("be_storage_err",api+" "+key,{err:err,rate_limit:{count:1}})};E.get_install_ms=()=>{let ts=storage.get_int("install_ts");return ts?Date.now()-ts:0};const get_bg_module=name=>{if(!is_bg)return null;let bg_main=E.rmt||window.be_bg_main;return name=="be_bg_main"?bg_main:bg_main&&bg_main[name]};E.get_manifest=()=>{if(chrome.runtime&&chrome.runtime.getManifest)return chrome.runtime.getManifest()};E.build_info=opt=>{let ext=get_bg_module("be_ext");let mode=get_bg_module("be_mode");let tabs=get_bg_module("be_tabs");let be_rule=get_bg_module("be_rule");let info={version:zconf.ZON_VERSION,local_ts:new Date,src_country:storage.get("src_country")};let manifest=E.get_manifest();if(manifest)info.manifest_version=manifest.version;if(mode){if_set(mode.get("svc.version"),info,"svc_version");if_set(mode.get("pending"),info,"svc_mode_pending")}if(ext){if_set(ext.get("ext.active"),info,"ext.active");if_set(ext.get("ext.suspended"),info,"ext.suspended");if_set(ext.get("ext.conflict"),info,"ext_conflict");if_set(ext.get("is_premium")&&1,info,"is_premium");if_set(ext.get("hola_uid"),info,"hola_uid");if_set(ext.get("session_key"),info,"session_key");info.conf_tag=E.CG("conf_tag");var f;if(f=ext.get("features"))assign(info,f)}if(tabs){info.active_url=tabs.get("active.url");info.active_tab=tabs.get("active.id");if(tabs.get("active.incognito"))info.active_incognito=true}if(info.active_url){if_set(svc_util.get_root_url(info.active_url),info,"root_url");if(be_rule){let rules=be_vpn_util.get_rules(be_rule.get("rules"),info.active_url);if(zutil.get(rules,"0.enabled"))info.proxy_country=rules[0].country}}if_set(opt&&opt.is_tpopup,info,"is_tpopup");if(chrome)info.product_type=conf.type;info.id=zutil.get(chrome,"runtime.id");var browser=E.browser();var browser_ver=browser=="opera"?E.browser_guess.opera_version:E.browser_guess.version;info.browser=browser+" "+browser_ver;info.browser_build=conf.browser.name;info.platform=navigator.platform;info.user_agent=navigator.userAgent;if(window.hola){var now=Date.now();var install_ms;if(install_ms=E.get_install_ms()){info.install_ms=install_ms;info.install_time=select_duration(install_ms)}var update,diff;if((update=storage.get_int("update_ts"))&&(diff=now-update)<=date.ms.MIN){info.after_update=true;info.update_ms=diff}}return info};var durations=[{name:"0-1h",length:1},{name:"1h-1d",length:1*24},{name:"1d-2d",length:2*24},{name:"2d-1w",length:7*24},{name:"1w-2w",length:14*24},{name:"2w-1m",length:30*24},{name:"1m-3m",length:90*24},{name:"3m-6m",length:180*24},{name:">=6m",length:Infinity}];function select_duration(len){len/=date.ms.HOUR;for(var i=0;i<durations.length;++i){if(len<durations[i].length)return durations[i].name}}E.build=opt=>{const info=E.build_info(opt);let s="";for(let f in info)s+=(s&&"\n")+f+": "+info[f];return s};E.perr_id=(id,new_name)=>{if(new_name)return"vpn."+E.browser()+"."+id;if(!id.match(/^be_/))id="be_"+id;return id};function perr_send(id,info,opt){opt=zutil.clone(opt||{});var qs=opt.qs||{},data=opt.data||{};data.is_json=1;if(info&&typeof info!="string")info=zerr.json(info);var err=opt.err;if(err){if(!info)info=""+(err.message||zerr.json(err));else if(!opt.bt)opt.bt=""+(err.message||zerr.json(err));if(err.hola_info){opt.bt="status "+err.hola_info.status+" "+err.hola_info.method+" "+err.hola_info.url+" text "+(""+err.hola_info.response_text).substr(0,256)+"\n"+(opt.bt||"")}}data.info=info;qs.id=id;opt={url:conf.url_perr+"/perr",qs:qs,data:data,method:"POST",json:1};return ajax_cb?ajax_cb(opt):ajax(opt)}function perr_install(perr_orig,pending){while(pending.length)perr_send.apply(null,pending.shift());return function(id,info,opt){perr_orig.apply(null,arguments);return perr_send(id,info,opt)}}function laptop_test(){_is_laptop=storage.get("is_laptop");if(!_is_laptop&&!E.is_mobile()&&navigator&&navigator.getBattery){navigator.getBattery().then((function(b){_is_laptop=!b.charging||b.chargingTime!=0;storage.set("is_laptop",_is_laptop)}))}}E.init=()=>{laptop_test();zerr.perr_install(perr_install)};E.get_product=()=>conf.type;E.get_connection_type=()=>{const connection=navigator&&(navigator.connection||navigator.mozConnection||navigator.webkitConnection);return connection&&connection.type};E.get_device_type=()=>E.is_mobile()?"mobile":_is_laptop?"laptop":"desktop";E.get_site_key=root_url=>{const sites=E.CG("sites",{});return Object.keys(sites).find(k=>{const v=sites[k];const urls=Array.isArray(v.root_url)?v.root_url:[v.root_url];return urls.includes(root_url)&&E.check_min_ver(v.min_ver)})};E.is_same_site=(root_url1,root_url2)=>{if(root_url1==root_url2)return true;let key1=E.get_site_key(root_url1),key2=E.get_site_key(root_url2);return!!(key1&&key2&&key1==key2)};E.get_site_conf=(root_url,path,def)=>{let site_conf=zutil.get(E.CG("sites"),E.get_site_key(root_url));if(!site_conf)return;let{override:override}=site_conf;site_conf=_.omit(site_conf,"override");if(override){let curr_ver=E.version();let versions=Object.keys(override).sort((a,b)=>-version_util.cmp(a,b));let ver=versions.find(v=>version_util.cmp(curr_ver,v)>=0);if(ver){if(E.browser()=="firefox"){site_conf=JSON.parse(JSON.stringify(site_conf));override=JSON.parse(JSON.stringify(override))}site_conf=zutil.extend_deep(site_conf,override[ver])}}return path?zutil.get(site_conf,path,def):site_conf};E.get_suggestion_conf=(site_conf,src_country)=>{if(!site_conf)return;src_country=(src_country||"").toUpperCase();var suggestion_popup=site_conf.suggestion_popup||{};return suggestion_popup[src_country]===undefined?suggestion_popup["*"]:suggestion_popup[src_country]};E.convert_url2regex=(conf,name)=>{const rules=conf&&conf[name];if(!rules)return;conf[name]=rules.map(rule=>assign({},rule,{url:typeof rule.url=="string"?new RegExp(rule.url.replace(/\./g,"\\.").replace(/\*\*/,"*").replace(/^\*/,"").replace(/\*/g,".*")):rule.url}))};E.find_conf_rule_by_url=(conf,name,url)=>{const rules=conf&&conf[name];if(!rules)return;return rules.find(r=>r.url&&r.url.test&&r.url.test(url))};E.get_site_verify_conf=(root_url,url,country)=>{let verify;if(!(verify=E.get_site_conf(root_url,"verify")))return;let sv,site,name=verify[country]===undefined?"*":country;if(!(site=E.find_conf_rule_by_url(verify,name,url))&&(!(sv=verify[name])||!sv.find(v=>!v.url))){return}let key=E.get_site_key(root_url),idx=key.indexOf("_");return assign({id:key.slice(0,idx!=-1?idx:undefined)},site)};E.get_dont_show_def_period=()=>E.CG("popup.dont_show_def_period","7d");E.reload_ext=(cb,period)=>{var info;period=period||date.ms.MIN;if(!(info=storage.get_json("reload_ext")))info={ts:Date.now(),count:0};var diff=Date.now()-info.ts;if(diff>period||diff<0){info.ts=Date.now();info.count=1}else if(info.count<2)info.count++;else return zerr("too many reload_ext "+info.count);storage.set_json("reload_ext",info);cb();return true};E.reload_ext_native=function(args){E.perr("be_runtime_reload_ext");storage.set("reload_ext_ts",Date.now());if(chrome.runtime.reload)return chrome.runtime.reload();var bg=chrome.extension.getBackgroundPage();bg.location.reload();if(window!=bg)window.close()};E.set_ajax_cb=cb=>{ajax_cb=cb};E.set_bext_config_cb=cb=>{bext_config_cb=cb};E.is_stub_rule_enabled=(stub_rule,url,is_premium)=>stub_rule&&stub_rule.enabled&&(be_vpn_util.is_skip_url(url)||E.is_google(svc_util.get_root_url(url)));E.format_log=log=>{const skips=[/backbone\.\w+\./,/ajax.*(perr| url )/,/perr.*rate too high/,/connection.*tpopup(_int)?:[0-9]+/,/be_tab_unblocker.*chrome-extension/,/stop .*cws/,/: (tab:[\d-]+ )?[a-z.]*popup /,/fetch_rules/,/be_req_bw/,/update url .* is_vpn false/,/checking if site has high unblocking/,/impl\.init/,/be_(bw_)?req_err/,/not_working_trigger/,/be\.ccgi\.send/,/be_vpn_total_active_time/,/be_media_failure/];const formats=[{from:/(perr [\w.]+) .*$/,to:"$1"}];const format=line=>{let ret=line;formats.forEach(f=>{ret=ret.replace(f.from,f.to)});return ret};const map=line=>{if(!/]$/.test(line))return format(line);let cnt=0,str;let args_len=line.split("").reverse().findIndex(c=>{if(c=='"')return void(str=!str);return!str&&(cnt+=c=="]"?1:c=="["?-1:0)==0});if(args_len==-1)return format(line);args_len++;const fmt=line.slice(0,-args_len);try{const args=JSON.parse(line.slice(-args_len));line=sprintf.apply(null,[fmt].concat(args))}catch(e){line+=" (truncated)"}return format(line)};return(log||[]).map(map).filter(line=>!skips.find(s=>s.test(line)))};function throttle_log(log,agg){const throttle=[{test:/tab_unblocker slow/,per:date.ms.MIN},{test:/media failure detected/,per:date.ms.SEC},{test:/popup not allowed/},{test:/tab already attached/},{test:/perr be_wrong_agent/}];return log.map(l=>{let t=throttle.find(_t=>_t.test.test(l));if(!t)return l;let m,prefix=(m=l.match(/^\[[\w[\]]+\] /))&&m[0]||"";let _l=l.replace(prefix,"");let date_str=_l.substr(0,23),d=new Date(date_str);if(!t.last){t.last=d;t.count=0;return l}let count=++t.count;if(!t.per||agg&&d-t.last<t.per)return;t.last=d;t.count=0;return agg&&count>1?prefix+date_str+" x"+count+_l.substr(23):l}).filter(l=>l)}E.get_zerr_log=()=>zerr.log?E.format_log(zerr.log).slice(-zerr.log.max_size):[];E.get_log=(ui_log=[])=>{let idx=0;const be_ext=get_bg_module("be_ext");const is_premium=be_ext&&be_ext.get("is_premium");const map=f=>l=>({from:f,line:l,idx:idx++});const log=E.get_zerr_log().map(map(is_bg?"bg":"ui")).concat(ui_log.map(map("ui"))).sort((a,b)=>a.from==b.from?a.idx-b.idx:a.line.localeCompare(b.line)).map(c=>"["+(is_premium?"P":"F")+"]["+c.from+"] "+c.line);return throttle_log(log,true)};E.perr_opt=(id,info,opt)=>{const bg_main=get_bg_module("be_bg_main");let{err:err,bt:bt,filehead:filehead}=opt,ver=E.version();bt=bt||err&&zerr.e2s(err);if(err&&err.hola_info){bt="status "+err.hola_info.status+" "+err.hola_info.method+" "+err.hola_info.url+" text "+(""+err.hola_info.response_text).substr(0,256)+"\n"+bt}if(err&&err.etask)opt.err=_.omit(err,"etask");let qs={id:id,ext_ver:ver,product:E.get_product(),browser:E.browser()};if(opt.with_log)filehead=(filehead||"")+"\n"+E.get_log(opt.ui_log);opt.data={bt:bt,info:info,filehead:filehead,ver:ver,build:E.build({is_tpopup:opt.is_tpopup})};qs.uuid=bg_main&&bg_main.get("uuid")||storage.get("uuid");opt.qs=qs;let err_re=/err|slow|problem|fail|bad|mismatch|invalid|wrong|missing/;opt.level=opt.level||(err||bt||id.match(err_re)?zerr.L.ERR:zerr.L.NOTICE);return{id:id,info:info,opt:opt}};let perr_cb;E.set_perr_cb=cb=>perr_cb=cb;E.perr=(id,info,opt,new_name)=>be_no_log.enabled(id)?null:etask((function*(){info=info||{};opt=opt||{};const bg_main=get_bg_module("be_bg_main");id=E.perr_id(id,new_name);if(conf.check_agree_ts&&!(bg_main&&bg_main.get("agree_ts")))return void zerr("no agree_ts, skip perr %s",id);let perr_opt=E.perr_opt(id,info,opt);if(zutil.is_mocha())return;let res=yield zerr.perr(id,perr_opt.info,perr_opt.opt);if(perr_cb)perr_cb(res);return res}));E.get_bext_config=()=>bext_config_cb?bext_config_cb():storage.get_json("bext_config_last");E.CG=(path,def)=>zutil.get(E.get_bext_config(),path,def);E.check_min_ver=min_ver=>version_util.valid(min_ver)&&version_util.cmp(E.version(),min_ver)>=0;E.proxy_error_ui_enabled=type=>{const c=E.CG("proxy_error_ui",{});return!!(E.check_min_ver(c.min_ver)&&c[type])};E.init();return E}.apply(exports,__WEBPACK_AMD_DEFINE_ARRAY__),__WEBPACK_AMD_DEFINE_RESULT__!==undefined&&(module.exports=__WEBPACK_AMD_DEFINE_RESULT__))},,function(module,exports,__webpack_require__){var __WEBPACK_AMD_DEFINE_ARRAY__,__WEBPACK_AMD_DEFINE_RESULT__;var module;
// LICENSE_CODE ZON ISC
"use strict";(function(){var is_node=typeof module=="object"&&module.exports&&module.children;if(!is_node);else;!(__WEBPACK_AMD_DEFINE_ARRAY__=[],__WEBPACK_AMD_DEFINE_RESULT__=function(){var E=date_get;E.sec={NANO:1/1e9,MS:.001,SEC:1,MIN:60,HOUR:60*60,DAY:24*60*60,WEEK:7*24*60*60,MONTH:30*24*60*60,YEAR:365*24*60*60};E.ms={};for(var key in E.sec)E.ms[key]=E.sec[key]*1e3;var ms=E.ms;function pad(num,size){return("000"+num).slice(-size)}E.ms_to_dur=function(_ms){var s="",sec=Math.floor(_ms/1e3);if(sec<0){s+="-";sec=-sec}var days=Math.floor(sec/(60*60*24));sec-=days*60*60*24;var hours=Math.floor(sec/(60*60));sec-=hours*60*60;var mins=Math.floor(sec/60);sec-=mins*60;if(days)s+=days+" "+(days>1?"Days":"Day")+" ";return s+pad(hours,2)+":"+pad(mins,2)+":"+pad(sec,2)};E.dur_to_str=function(dur,opt){opt=opt||{};var parts=[];dur=+dur;function chop(period,name){if(dur<period)return;var number=Math.floor(dur/period);parts.push(number+name);dur-=number*period}chop(ms.YEAR,"y");chop(ms.MONTH,"mo");if(opt.week)chop(ms.WEEK,"w");chop(ms.DAY,"d");chop(ms.HOUR,"h");chop(ms.MIN,"min");chop(ms.SEC,"s");if(dur)parts.push(dur+"ms");if(!parts.length)return"0s";return parts.slice(0,opt.units||parts.length).join(opt.sep||"")};E.parse_dur=function(dur,opt){opt=opt||{};var parts={};dur=+dur;function chop(period,name){if(dur<period)return;var number=Math.floor(dur/period);parts[name]=number;dur-=number*period}chop(ms.YEAR,"year");chop(ms.MONTH,"month");if(opt.week)chop(ms.WEEK,"week");chop(ms.DAY,"day");chop(ms.HOUR,"hour");chop(ms.MIN,"min");chop(ms.SEC,"sec");if(dur)parts.ms=dur;return parts};E.monotonic=undefined;E.init=function(){var adjust,last;if(typeof window=="object"&&window.performance&&window.performance.now){adjust=Date.now()-window.performance.now();E.monotonic=function(){return window.performance.now()+adjust}}else if(is_node&&!global.mocha_running){var now_fn=function(){var data=process.hrtime();var seconds=data[0],nanos=data[1];return Math.floor(seconds*E.ms.SEC+nanos*E.ms.NANO)};adjust=Date.now()-now_fn();E.monotonic=function(){return now_fn()+adjust}}else{last=adjust=0;E.monotonic=function(){var now=Date.now()+adjust;if(now>=last)return last=now;adjust+=last-now;return last}}};E.init();E.str_to_dur=function(str,opt){opt=opt||{};var month="mo|mon|months?";if(opt.short_month)month+="|m";var m=str.replace(/ /g,"").match(new RegExp("^(([0-9]+)y(ears?)?)?"+"(([0-9]+)("+month+"))?(([0-9]+)w(eeks?)?)?(([0-9]+)d(ays?)?)?"+"(([0-9]+)h(ours?)?)?(([0-9]+)(min|minutes?))?"+"(([0-9]+)s(ec|econds?)?)?(([0-9]+)ms(ec)?)?$","i"));if(!m)return;return ms.YEAR*(+m[2]||0)+ms.MONTH*(+m[5]||0)+ms.WEEK*(+m[8]||0)+ms.DAY*(+m[11]||0)+ms.HOUR*(+m[14]||0)+ms.MIN*(+m[17]||0)+ms.SEC*(+m[20]||0)+(+m[23]||0)};E.months_long=["January","February","March","April","May","June","July","August","September","October","November","December"];E.months_short=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];var months_short_lc=E.months_short.map((function(m){return m.toLowerCase()}));E.days_long=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"];E.days_short=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"];var days_short_lc=E.days_short.map((function(d){return d.toLowerCase()}));var days_long_lc=E.days_long.map((function(d){return d.toLowerCase()}));E.locale={months_long:E.months_long,months_short:E.months_short,days_long:E.days_long,days_short:E.days_short,AM:"AM",PM:"PM"};E.get=date_get;function date_get(d,_new){var y,mon,day,H,M,S,_ms;if(d===undefined)return new Date;if(d==null)return new Date(null);if(d instanceof Date)return _new?new Date(d):d;if(typeof d=="string"){var m;d=d.trim();if(m=/^((\d\d\d\d)-(\d\d)-(\d\d)|(\d\d?)-([A-Za-z]{3})-(\d\d(\d\d)?))\s*([\sT](\d\d):(\d\d)(:(\d\d)(\.(\d\d\d))?)?Z?)?$/.exec(d)){H=+m[10]||0;M=+m[11]||0;S=+m[13]||0;_ms=+m[15]||0;if(m[2]){y=+m[2];mon=+m[3];day=+m[4];if(!y&&!mon&&!day&&!H&&!M&&!S&&!_ms)return new Date(NaN);return new Date(Date.UTC(y,mon-1,day,H,M,S,_ms))}if(m[5]){y=+m[7];mon=months_short_lc.indexOf(m[6].toLowerCase())+1;day=+m[5];if(m[7].length==2){y=+y;y+=y>=70?1900:2e3}return new Date(Date.UTC(y,mon-1,day,H,M,S,_ms))}}if(/^\d+$/.test(d))return new Date(+d);return new Date(d)}if(typeof d=="number")return new Date(d);throw new TypeError("invalid date "+d)}E.to_sql_ms=function(d){d=E.get(d);if(isNaN(d))return"0000-00-00 00:00:00.000";return pad(d.getUTCFullYear(),4)+"-"+pad(d.getUTCMonth()+1,2)+"-"+pad(d.getUTCDate(),2)+" "+pad(d.getUTCHours(),2)+":"+pad(d.getUTCMinutes(),2)+":"+pad(d.getUTCSeconds(),2)+"."+pad(d.getUTCMilliseconds(),3)};E.to_sql_sec=function(d){return E.to_sql_ms(d).slice(0,-4)};E.to_sql=function(d){return E.to_sql_ms(d).replace(/( 00:00:00)?....$/,"")};E.from_sql=E.get;E.to_month_short=function(d){d=E.get(d);return E.months_short[d.getUTCMonth()]};E.to_month_long=function(d){d=E.get(d);return E.months_long[d.getUTCMonth()]};E.to_jdate=function(d){d=E.get(d);return(pad(d.getUTCDate(),2)+"-"+E.months_short[d.getUTCMonth()]+"-"+pad(d.getUTCFullYear()%100,2)+" "+pad(d.getUTCHours(),2)+":"+pad(d.getUTCMinutes(),2)+":"+pad(d.getUTCSeconds(),2)).replace(/( 00:00)?:00$/,"")};E.to_log_file=function(d){d=E.get(d);return d.getUTCFullYear()+pad(d.getUTCMonth()+1,2)+pad(d.getUTCDate(),2)+"_"+pad(d.getUTCHours(),2)+pad(d.getUTCMinutes(),2)+pad(d.getUTCSeconds(),2)};E.from_log_file=function(d){var m=d.match(/^(\d{4})(\d{2})(\d{2})_(\d{2})(\d{2})(\d{2})$/);if(!m)return;return new Date(Date.UTC(m[1],m[2]-1,m[3],m[4],m[5],m[6]))};E.to_log_ms=function(d){return E.to_sql_ms(d).replace(/-/g,".")};E.from_rcs=function(d){var m=d.match(/^(\d{4})\.(\d{2})\.(\d{2})\.(\d{2})\.(\d{2})\.(\d{2})$/);if(!m)return;return new Date(Date.UTC(m[1],m[2]-1,m[3],m[4],m[5],m[6]))};E.to_rcs=function(d){return E.to_sql_sec(d).replace(/[-: ]/g,".")};E.align=function(d,align){d=E.get(d,1);switch(align.toUpperCase()){case"MS":break;case"SEC":d.setUTCMilliseconds(0);break;case"MIN":d.setUTCSeconds(0,0);break;case"HOUR":d.setUTCMinutes(0,0,0);break;case"DAY":d.setUTCHours(0,0,0,0);break;case"WEEK":d.setUTCDate(d.getUTCDate()-d.getUTCDay());d.setUTCHours(0,0,0,0);break;case"MONTH":d.setUTCDate(1);d.setUTCHours(0,0,0,0);break;case"YEAR":d.setUTCMonth(0,1);d.setUTCHours(0,0,0,0);break;default:throw new Error("invalid align "+align)}return d};E.add=function(d,dur){d=E.get(d,1);dur=normalize_dur(dur);if(dur.year)d.setUTCFullYear(d.getUTCFullYear()+dur.year);if(dur.month)d.setUTCMonth(d.getUTCMonth()+dur.month);["day","hour","min","sec","ms"].forEach((function(key){if(dur[key])d.setTime(+d+dur[key]*ms[key.toUpperCase()])}));return d};function normalize_dur(dur){var aliases={years:"year",months:"month",days:"day",hours:"hour",minutes:"min",minute:"min",mins:"min",seconds:"sec",second:"sec",secs:"sec",y:"year",mo:"month",d:"day",h:"hour",m:"min",s:"sec"};var norm={};for(var k in dur)norm[aliases[k]||k]=dur[k];return norm}E.describe_interval=function(_ms){return _ms<2*ms.MIN?Math.round(_ms/ms.SEC)+" sec":_ms<2*ms.HOUR?Math.round(_ms/ms.MIN)+" min":_ms<2*ms.DAY?Math.round(_ms/ms.HOUR)+" hours":_ms<2*ms.WEEK?Math.round(_ms/ms.DAY)+" days":_ms<2*ms.MONTH?Math.round(_ms/ms.WEEK)+" weeks":_ms<2*ms.YEAR?Math.round(_ms/ms.MONTH)+" months":Math.round(_ms/ms.YEAR)+" years"};E.time_ago=function(d,until_date){var _ms=E.get(until_date)-E.get(d);if(_ms<ms.SEC)return"right now";return E.describe_interval(_ms)+" ago"};E.ms_to_str=function(_ms){var s=""+_ms;return s.length<=3?s+"ms":s.slice(0,-3)+"."+s.slice(-3)+"s"};E.parse=function(text,opt){opt=opt||{};if(opt.fmt)return E.strptime(text,opt.fmt);var d,a,i,v,_v,dir,_dir,amount,now=opt.now;now=!now?new Date:new Date(now);text=text.replace(/\s+/g," ").trim().toLowerCase();if(!text)return;if(text=="now")return now;if(!isNaN(d=E.get(text)))return d;d=now;a=text.split(" ");dir=a.includes("ago")?-1:a.includes("last")?-1:a.includes("next")?1:undefined;for(i=0;i<a.length;i++){v=a[i];if(/^(ago|last|next)$/.test(v));else if(v=="today")d=E.align(d,"DAY");else if(v=="yesterday")d=E.align(+d-ms.DAY,"DAY");else if(v=="tomorrow")d=E.align(+d+ms.DAY,"DAY");else if((_v=days_short_lc.indexOf(v))>=0)d=new Date(+E.align(d,"WEEK")+_v*ms.DAY+(dir||0)*ms.WEEK);else if((_v=days_long_lc.indexOf(v))>=0)d=new Date(+E.align(d,"WEEK")+_v*ms.DAY+(dir||0)*ms.WEEK);else if(_v=/^([+-]?\d+)(?:([ymoinwdhs]+)(\d.*)?)?$/.exec(v)){if(amount!==undefined)return;amount=dir!==undefined?Math.abs(+_v[1]):+_v[1];if(_v[2]){a.splice(i+1,0,_v[2]);if(_v[3])a.splice(i+2,0,_v[3])}continue}else if(/^([ywdhs]|years?|months?|mon?|weeks?|days?|hours?|minutes?|min|seconds?|sec)$/.test(v)){_v=v[0]=="m"&&v[1]=="i"?ms.MIN:v[0]=="y"?ms.YEAR:v[0]=="m"&&v[1]=="o"?ms.MONTH:v[0]=="w"?ms.WEEK:v[0]=="d"?ms.DAY:v[0]=="h"?ms.HOUR:ms.SEC;amount=amount===undefined?1:amount;_dir=dir===undefined?opt.dir||1:dir;if(_v==ms.MONTH)d.setUTCMonth(d.getUTCMonth()+_dir*amount);else if(_v==ms.YEAR)d.setUTCFullYear(d.getUTCFullYear()+_dir*amount);else d=new Date(+d+_v*amount*_dir);amount=undefined}else return;if(amount!==undefined)return}if(amount!==undefined)return;return d};E.strptime=function(str,fmt){function month(m){return months_short_lc.indexOf(m.toLowerCase())}var parse={"%":["%",function(){},0],a:["[a-z]+",function(m){},0],A:["[a-z]+",function(m){},0],b:["[a-z]+",function(m){d.setUTCMonth(month(m))},2],B:["[a-z]+",function(m){d.setUTCMonth(month(m))},2],y:["[0-9]{2}",function(m){d.setUTCFullYear(+m+(m<70?2e3:1900))},1],Y:["[0-9]{4}",function(m){d.setUTCFullYear(+m)},1],m:["[0-9]{0,2}",function(m){d.setUTCMonth(+m-1)},2],d:["[0-9]{0,2}",function(m){d.setUTCDate(+m)},3],H:["[0-9]{0,2}",function(m){d.setUTCHours(+m)},4],M:["[0-9]{0,2}",function(m){d.setUTCMinutes(+m)},5],S:["[0-9]{0,2}",function(m){d.setUTCSeconds(+m)},6],s:["[0-9]+",function(m){d=new Date(+m)},0],L:["[0-9]{0,3}",function(m){d.setUTCMilliseconds(+m)},7],z:["[+-][0-9]{4}",function(m){var timezone=+m.slice(0,3)*3600+m.slice(3,5)*60;d=new Date(+d-timezone*1e3)},8],Z:["[a-z]{0,3}[+-][0-9]{2}:?[0-9]{2}|[a-z]{1,3}",function(m){m=/^([a-z]{0,3})(?:([+-][0-9]{2}):?([0-9]{2}))?$/i.exec(m);if(m[1]=="Z"||m[1]=="UTC")return;var timezone=+m[2]*3600+m[3]*60;d=new Date(+d-timezone*1e3)},8],I:["[0-9]{0,2}",function(m){d.setUTCHours(+m)},4],p:["AM|PM",function(m){if(d.getUTCHours()==12)d.setUTCHours(d.getUTCHours()-12);if(m.toUpperCase()=="PM")d.setUTCHours(d.getUTCHours()+12)},9]};var ff=[];var ff_idx=[];var re=new RegExp("^\\s*"+fmt.replace(/%(?:([a-zA-Z%]))/g,(function(_,fd){var d=parse[fd];if(!d)throw Error("Unknown format descripter: "+fd);ff_idx[d[2]]=ff.length;ff.push(d[1]);return"("+d[0]+")"}))+"\\s*$","i");var matched=str.match(re);if(!matched)return;var d=new Date(0);for(var i=0;i<ff_idx.length;i++){var idx=ff_idx[i];var fun=ff[idx];if(fun)fun(matched[idx+1])}return d};E.apply_tz=function(date,tz){var timezone=+tz.slice(1,3)*36e5+tz.slice(4,6)*6e4;var sign=tz.slice(0,1)=="+"?1:-1;return new Date(date.getTime()+sign*timezone)};var utc_local={local:{getSeconds:function(d){return d.getSeconds()},getMinutes:function(d){return d.getMinutes()},getHours:function(d){return d.getHours()},getDay:function(d){return d.getDay()},getDate:function(d){return d.getDate()},getMonth:function(d){return d.getMonth()},getFullYear:function(d){return d.getFullYear()},getYearBegin:function(d){return new Date(d.getFullYear(),0,1)}},utc:{getSeconds:function(d){return d.getUTCSeconds()},getMinutes:function(d){return d.getUTCMinutes()},getHours:function(d){return d.getUTCHours()},getDay:function(d){return d.getUTCDay()},getDate:function(d){return d.getUTCDate()},getMonth:function(d){return d.getUTCMonth()},getFullYear:function(d){return d.getUTCFullYear()},getYearBegin:function(d){return new Date(Date.UTC(d.getUTCFullYear(),0,1))}}};E.strftime=function(fmt,d,opt){function hours12(hours){return hours==0?12:hours>12?hours-12:hours}function ord_str(n){var i=n%10,ii=n%100;if(ii>=11&&ii<=13||i==0||i>=4)return"th";switch(i){case 1:return"st";case 2:return"nd";case 3:return"rd"}}function week_num(l,d,first_weekday){var wday=l.getDay(d);if(first_weekday=="monday")wday=wday==0?wday=6:wday-1;var yday=(d-l.getYearBegin(d))/ms.DAY;return Math.floor((yday+7-wday)/7)}function padx(n,padding,length){if(typeof padding=="number"){length=padding;padding="0"}if(padding===undefined)padding="0";length=length||2;var s=""+n;if(padding)for(;s.length<length;s=padding+s);return s}opt=opt||{};d=E.get(d);var locale=opt.locale||E.locale;var formats=locale.formats||{};var tz=opt.timezone;var utc=opt.utc!==undefined?opt.utc:opt.local!==undefined?!opt.local:true;if(tz!=null){utc=true;if(typeof tz=="string"){var sign=tz[0]=="-"?-1:1;var hours=parseInt(tz.slice(1,3),10);var mins=parseInt(tz.slice(3,5),10);tz=sign*(60*hours+mins)}if(typeof tz=="number")d=new Date(+d+tz*6e4)}var l=utc?utc_local.utc:utc_local.local;function replace(fmt){return fmt.replace(/%([-_0]?.)/g,(function(_,c){var mod,padding,day;if(c.length==2){mod=c[0];if(mod=="-")padding="";else if(mod=="_")padding=" ";else if(mod=="0")padding="0";else return _;c=c[1]}switch(c){case"A":return locale.days_long[l.getDay(d)];case"a":return locale.days_short[l.getDay(d)];case"B":return locale.months_long[l.getMonth(d)];case"b":return locale.months_short[l.getMonth(d)];case"C":return padx(Math.floor(l.getFullYear(d)/100),padding);case"D":return replace(formats.D||"%m/%d/%y");case"d":return padx(l.getDate(d),padding);case"e":return l.getDate(d);case"F":return replace(formats.F||"%Y-%m-%d");case"H":return padx(l.getHours(d),padding);case"h":return locale.months_short[l.getMonth(d)];case"I":return padx(hours12(l.getHours(d)),padding);case"j":day=Math.ceil((+d-l.getYearBegin(d))/(1e3*60*60*24));return pad(day,3);case"k":return padx(l.getHours(d),padding===undefined?" ":padding);case"L":return pad(Math.floor(d.getMilliseconds()),3);case"l":return padx(hours12(l.getHours(d)),padding===undefined?" ":padding);case"M":return padx(l.getMinutes(d),padding);case"m":return padx(l.getMonth(d)+1,padding);case"n":return"\n";case"o":return""+l.getDate(d)+ord_str(l.getDate(d));case"P":return(l.getHours(d)<12?locale.AM:locale.PM).toLowerCase();case"p":return l.getHours(d)<12?locale.AM:locale.PM;case"R":return replace(formats.R||"%H:%M");case"r":return replace(formats.r||"%I:%M:%S %p");case"S":return padx(l.getSeconds(d),padding);case"s":return Math.floor(+d/1e3);case"T":return replace(formats.T||"%H:%M:%S");case"t":return"\t";case"U":return padx(week_num(l,d,"sunday"),padding);case"u":day=l.getDay(d);return day==0?7:day;case"v":return replace(formats.v||"%e-%b-%Y");case"W":return padx(week_num(l,d,"monday"),padding);case"w":return l.getDay(d);case"Y":return l.getFullYear(d);case"y":return(""+l.getFullYear(d)).slice(-2);case"Z":if(utc)return"GMT";var tz_string=d.toString().match(/\((\w+)\)/);return tz_string&&tz_string[1]||"";case"z":if(utc)return"+0000";var off=typeof tz=="number"?tz:-d.getTimezoneOffset();return(off<0?"-":"+")+pad(Math.abs(Math.trunc(off/60)),2)+pad(off%60,2);default:return c}}))}return replace(fmt)};E.compile_schedule=function(expr){var re=/^(\d\d?)(?::(\d\d?))?-(\d\d?)(?::(\d\d?))?$/;var parts=expr.split(/\s+/);var intervals=[];for(var i=0;i<parts.length;i++){if(!parts[i])continue;var m=re.exec(parts[i]);if(!m)throw new Error("Schedule syntax error: "+expr);var from=m[1]*ms.HOUR,to=m[3]*ms.HOUR;if(m[2])from+=m[2]*ms.MIN;if(m[4])to+=m[4]*ms.MIN;intervals.push({from:from%ms.DAY,to:to%ms.DAY})}return function(d){var t=E.get(d)%ms.DAY;for(var i=0;i<intervals.length;i++){var interval=intervals[i];if(interval.from<interval.to){if(t>=interval.from&&t<interval.to)return true}else{if(t<interval.to||t>=interval.from)return true}}return false}};return E}.apply(exports,__WEBPACK_AMD_DEFINE_ARRAY__),__WEBPACK_AMD_DEFINE_RESULT__!==undefined&&(module.exports=__WEBPACK_AMD_DEFINE_RESULT__))})()},function(module,exports,__webpack_require__){"use strict";var __WEBPACK_AMD_DEFINE_ARRAY__,__WEBPACK_AMD_DEFINE_RESULT__;// LICENSE_CODE ZON
!(__WEBPACK_AMD_DEFINE_ARRAY__=[__webpack_require__(15),__webpack_require__(77),__webpack_require__(14),__webpack_require__(13),__webpack_require__(51),__webpack_require__(11),__webpack_require__(10),__webpack_require__(12)],__WEBPACK_AMD_DEFINE_RESULT__=function(_,Backbone,be_util,be_vpn_util,zconf,etask,zutil,zerr){const listener_prefix="l"+(be_vpn_util.is_bg()?"b":"p");const E={};const manifest=be_util.get_manifest();function _destroy(o){try{o.destroy()}catch(err){try{console.error("error in destroy %s",err.stack||err)}catch(_err){}throw err}}E.model=Backbone.Model.extend({defaults:function(){this._listenerId=_.uniqueId(listener_prefix);if(this._defaults)this._defaults.call(this);this.on("destroy",(function(){this.off();this.stopListening();this.destroyed=true}))},_destroy:function(){_destroy(this)},sync:function(){},assert_inited:function(){be_vpn_util.assert(this.get("inited"),new Error("not inited"))},on_init:function(events,cb){this.on(events,cb);cb.call(this)},listen_to:function(other,events,cb){this.listenTo(other,events,cb);cb.call(this)},fcall:function(a0,a1){return this[a0].apply(this,a1)},ecall:function(a0,a1){return this[a0].apply(this,a1)},safe_set:function(change){var diff=this.changedAttributes(change);if(!diff)return;this.set(diff,{silent:true});_.each(diff,(function(val,key){try{this.trigger("change:"+key)}catch(err){be_util.perr("be_safe_set_err",{key:key,val:val},{err:err,rate_limit:{count:1}});console.error("error in change listener %s",err.stack||err)}}),this);try{this.trigger("change")}catch(e){be_util.perr("be_safe_set_err",{},{err:e,rate_limit:{count:1}});console.error("error in change listener %s",e.stack||e)}},set:function(attributes,options){if(typeof options=="object")options=_.clone(options);Backbone.Model.prototype.set.apply(this,[attributes,options])},assert_no_listeners:function(){if(!this._events||!Object.keys(this._events).length)return;if(Object.keys(this._events).length>1||Object.keys(this._events)[0]!="destroy"){console.error("%s: assert_no_listeners _events %s",this.model_name,Object.keys(this._events));if(zutil.is_mocha())throw new Error("has listeners")}}});let backbone_max_listeners_limit=10;let leak_warn=(obj,events,cb)=>{if(!obj._events)return;for(let event of events.split(/\s+/)){let a=obj._events[event];if(!a||a.length<backbone_max_listeners_limit)continue;console.error("%s: too many event listeners %s %s",obj.model_name,a.length,event);be_util.perr("be_backbone_max_listeners_"+backbone_max_listeners_limit,{count:a.length,module:obj.model_name,event:event,bt:zerr.get_stack_trace()},{rate_limit:{count:1}});backbone_max_listeners_limit*=10;if(zutil.is_mocha())throw new Error(obj.model_name+" too many listeners")}};if(manifest&&!manifest.update_url||zutil.is_mocha()){E.model.prototype.on=function(events,cb){leak_warn(this,events,cb);return Backbone.Model.prototype.on.apply(this,arguments)};E.model.prototype.listenTo=function(other,events,cb){leak_warn(other,events,cb);return Backbone.Model.prototype.listenTo.apply(this,arguments)}}E.task_model=E.model.extend({defaults:function(){if(this._defaults)this._defaults.call(this);this.queue=[];this.on("destroy",(function(){clearTimeout(this.queue_timer);delete this.queue;this.off();this.stopListening();this.destroyed=true}))},assert_inited:function(){be_vpn_util.assert(this.get("inited"),new Error("not inited"));be_vpn_util.assert(this.queue,new Error("in destroy"))},set_busy:function(opt){this.assert_inited();be_vpn_util.assert(this.get("status")!="error",new Error("set_busy in error"));if(this.get("status")=="ready"||!this.get("status")||this.in_clr_busy){this.in_clr_busy=false;this.set("status_opt",opt);this.set("status","busy");return true}return false},update_progress:function(opt){this.set("status_opt",opt)},clr_busy:function(){this.assert_inited();be_vpn_util.assert(this.get("status")!="error",new Error("clr_busy in error"));if(!this.queue.length){this.unset("status_opt");return this.set("status","ready")}this.queue_timer=setTimeout(function(){this.in_clr_busy=true;this.trigger.apply(this,this.queue.shift())}.bind(this),0)},clr_task:function(task){this.assert_inited();this.queue=_.filter(this.queue,(function(o){return!_.isEqual(o,task)}))},clr_task_by_id:function(id){this.assert_inited();this.queue=_.filter(this.queue,(function(o){return o[0]!=id}))},set_err:function(){this.assert_inited();be_vpn_util.assert(this.get("status")=="busy",new Error("set_err but not busy"));clearTimeout(this.queue_timer);this.queue=[];this.in_clr_busy=0;this.unset("status_opt");return this.set("status","error")},schedule:function(task){this.assert_inited();be_vpn_util.assert(this.get("status")=="busy",new Error("schedule but not busy"));this.queue.push(task)},schedule_clr:function(task){this.clr_task(task);return this.schedule(task)},recover:function(){this.assert_inited();be_vpn_util.assert(this.get("status")=="error",new Error("recover but not in error"));this.unset("status_opt");this.set("status","",{silent:true});return this.trigger("recover")}});return E}.apply(exports,__WEBPACK_AMD_DEFINE_ARRAY__),__WEBPACK_AMD_DEFINE_RESULT__!==undefined&&(module.exports=__WEBPACK_AMD_DEFINE_RESULT__))},function(module,exports,__webpack_require__){var __WEBPACK_AMD_DEFINE_ARRAY__,__WEBPACK_AMD_DEFINE_RESULT__;var module;
// LICENSE_CODE ZON ISC
"use strict";(function(){var is_node=typeof module=="object"&&module.exports&&module.children;var is_rn=typeof global=="object"&&!!global.nativeRequire||typeof navigator=="object"&&navigator.product=="ReactNative";var qs;if(is_rn);else if(!is_node);else{var _require=require;qs=_require("querystring")}!(__WEBPACK_AMD_DEFINE_ARRAY__=[__webpack_require__(10)],__WEBPACK_AMD_DEFINE_RESULT__=function(zutil){var assign=Object.assign;var E={};function replace_slashes(url){return url.replace(/\\/g,"/")}E.add_proto=function(url){if(!url.match(/^([a-z0-9]+:)?\/\//i))url="http://"+url;return url};E.rel_proto_to_abs=function(url){var proto=is_node?"http:":location.protocol;return url.replace(/^\/\//,proto+"//")};E.get_top_level_domain=function(host){var n=host.match(/\.([^.]+)$/);return n?n[1]:""};E.get_host=function(url){var n=replace_slashes(url).match(/^(https?:)?\/\/([^\/]+)\/.*$/);return n?n[2]:""};E.get_host_without_tld=function(host){return host.replace(/^([^.]+)\.[^.]{2,3}(\.[^.]{2,3})?$/,"$1")};var generic_2ld={com:1,biz:1,net:1,org:1,xxx:1,edu:1,gov:1,ac:1,co:1,or:1,ne:1,kr:1,jp:1,jpn:1,cn:1};E.get_root_domain=function(domain){if(E.is_ip(domain))return domain;var s=domain.split("."),root=s,len=s.length;if(len>2){var hd=0;if(s[len-1]=="hola"){hd=2;if(s[len-2].match(/^\d+$/))hd=3}if(generic_2ld[s[len-2-hd]])root=s.slice(-3-hd,len-hd);else root=s.slice(-2-hd,len-hd)}return root.join(".")};E.get_domain_email=function(email){var match=email.toLowerCase().match(/^[a-z0-9_.\-+]+@(.*)$/);return match&&match[1]};E.get_root_domain_email=function(email){var domain=E.get_domain_email(email);return domain&&E.get_root_domain(domain)};E.get_path=function(url){var n=url.match(/^https?:\/\/[^\/]+(\/.*$)/);return n?n[1]:""};E.get_proto=function(url){var n=url.match(/^([a-z0-9]+):\/\//);return n?n[1]:""};E.get_host_gently=function(url){var n=replace_slashes(url).match(/^(?:(?:[a-z0-9]+?:)?\/\/)?([^\/]+)/);return n?n[1]:""};E.is_ip=function(host){var m=/^(\d{1,3})\.(\d{1,3})\.(\d{1,3})\.(\d{1,3})$/.exec(host);if(!m)return false;for(var i=1;i<=4;i++){if(+m[i]>255)return false}return true};E.is_ip_mask=function(host){var m=/^(\d{1,3})\.(\d{1,3})\.(\d{1,3})\.(\d{1,3})$/.exec(host);if(!m)return false;if(E.ip2num(host)==0)return false;var final=false;var check_num_mask=function(num){var arr=(num>>>0).toString(2).split(""),fin=false;for(var i=0;i<arr.length;i++){if(fin&&arr[i]=="1")return false;if(!fin&&arr[i]=="0")fin=true}return true};for(var i=1;i<=4;i++){if(+m[i]>255)return false;if(final&&+m[i]>0)return false;if(!final&&+m[i]<255){if(!check_num_mask(+m[i]))return false;final=true}}return!!final};E.ip2num=function(ip){var num=0;ip.split(".").forEach((function(octet){num<<=8;num+=+octet}));return num>>>0};E.num2ip=function(num){return(num>>>24)+"."+(num>>16&255)+"."+(num>>8&255)+"."+(num&255)};E.is_ip_subnet=function(host){var m=/(.+?)\/(\d+)$/.exec(host);return m&&E.is_ip(m[1])&&+m[2]<=32};E.is_ip_netmask=function(host){var ips=host.split("/");if(ips.length!=2||!E.is_ip(ips[0])||!E.is_ip_mask(ips[1]))return false;return true};E.is_ip_range=function(host){var ips=host.split("-");if(ips.length!=2||!E.is_ip(ips[0])||!E.is_ip(ips[1]))return false;return E.ip2num(ips[0])<E.ip2num(ips[1])};E.is_ip_port=function(host){var m=/(.+?)(?::(\d{1,5}))?$/.exec(host);return m&&E.is_ip(m[1])&&!(+m[2]>65535)};E.is_valid_url=function(url){return/^(https?:\/\/)?([a-z0-9-]+\.)+[a-z0-9-]+(\/.*)?$/i.test(url)};E.is_valid_domain=function(domain){return/^([a-z0-9]([a-z0-9-_]*[a-z0-9])?\.)+[a-z]{2,63}$/.test(domain)};var hola_domain_re=/^(.*\.)?(hola\.org|holacdn\.com|h-cdn\.com|svd-cdn\.com|h-vpn\.org)$/;E.is_hola_domain=function(domain){return E.is_valid_domain(domain)&&domain.search(hola_domain_re)!=-1};E.is_valid_email=function(email){var re=/^[a-z0-9_\-+]+(?:\.[a-z0-9_\-+]+)*@(.*)$/;var n=email.toLowerCase().match(re);return!!(n&&E.is_valid_domain(n[1]))};E.is_alias_email=function(email){if(!E.is_valid_email(email))return false;var n=email.toLowerCase().match(/^([a-z0-9_.\-+]+)@.*$/);return!!(n&&/.+\+.+/.test(n[1]))};E.get_main_email=function(email){if(!E.is_valid_email(email))return;if(E.is_alias_email(email))return email.replace(/\+.+@/,"@");return email};E.is_ip_in_range=function(ips_range,ip){if(!E.is_ip_range(ips_range)||!E.is_ip(ip))return false;var ips=ips_range.split("-");var min_ip=E.ip2num(ips[0]),max_ip=E.ip2num(ips[1]);var num_ip=E.ip2num(ip);return num_ip>=min_ip&&num_ip<=max_ip};E.is_ip_local=function(ip){return E.is_ip_in_range("10.0.0.0-10.255.255.255",ip)||E.is_ip_in_range("172.16.0.0-172.31.255.255",ip)||E.is_ip_in_range("192.168.0.0-192.168.255.255",ip)||E.is_ip_in_range("169.254.0.0-169.254.255.255",ip)};E.host_lookup=function(lookup,host){var pos;while(1){if(host in lookup)return lookup[host];if((pos=host.indexOf("."))<0)return;host=host.slice(pos+1)}};E.uri_obj_href=function(uri){return(uri.protocol||"")+(uri.slashes?"//":"")+(uri.host?(uri.auth?uri.auth+"@":"")+uri.host:"")+uri.path+(uri.hash||"")};var protocol_re=/^((?:about|http|https|file|ftp|ws|wss):)?(\/\/)?/i;var host_section_re=/^(.*?)(?:[\/?#]|$)/;var host_re=/^(?:(([^:@]*):?([^:@]*))?@)?([a-zA-Z0-9._+-]*)(?::(\d*))?/;var path_section_re=/^([^?#]*)(\?[^#]*)?(#.*)?$/;var path_re_loose=/^(\/(?:.(?![^\/]*\.[^\/.]+$))*\/?)?([^\/]*?(?:\.([^.]+))?)$/;var path_re_strict=/^(\/(?:.(?![^\/]*(?:\.[^\/.]+)?$))*\/?)?([^\/]*?(?:\.([^.]+))?)$/;E.parse=function(url,strict){function re(expr,str){var m;try{m=expr.exec(str)}catch(e){m=null}if(!m)return m;for(var i=0;i<m.length;i++)m[i]=m[i]===undefined?null:m[i];return m}url=url||location.href;var uri={orig:url};url=replace_slashes(url);var m,remaining=url;if(!(m=re(protocol_re,remaining)))return{};uri.protocol=m[1];if(uri.protocol!==null)uri.protocol=uri.protocol.toLowerCase();uri.slashes=!!m[2];if(!uri.protocol&&!uri.slashes){uri.protocol="http:";uri.slashes=true}remaining=remaining.slice(m[0].length);if(!(m=re(host_section_re,remaining)))return{};uri.authority=m[1];remaining=remaining.slice(m[1].length);if(!(m=re(host_re,uri.authority)))return{};uri.auth=m[1];uri.user=m[2];uri.password=m[3];uri.hostname=m[4];uri.port=m[5];if(uri.hostname!==null){uri.hostname=uri.hostname.toLowerCase();uri.host=uri.hostname+(uri.port?":"+uri.port:"")}if(!(m=re(path_section_re,remaining)))return{};uri.relative=m[0];uri.pathname=m[1];uri.search=m[2];uri.query=uri.search?uri.search.substring(1):null;uri.hash=m[3];if(!(m=re(strict?path_re_strict:path_re_loose,uri.pathname)))return{};uri.directory=m[1];uri.file=m[2];uri.ext=m[3];if(uri.file=="."+uri.ext)uri.ext=null;if(!uri.pathname)uri.pathname="/";uri.path=uri.pathname+(uri.search||"");uri.href=E.uri_obj_href(uri);return uri};E.qs_parse=function(q,bin,safe){var obj={};q=q.length?q.split("&"):[];var len=q.length;var unescape_val=bin?function(val){return qs.unescapeBuffer(val,true).toString("binary")}:safe?function(val){try{return decodeURIComponent(val.replace(/\+/g," "))}catch(e){return val}}:function(val){return decodeURIComponent(val.replace(/\+/g," "))};for(var i=0;i<len;++i){var x=q[i];var idx=x.indexOf("=");var kstr=idx>=0?x.substr(0,idx):x;var vstr=idx>=0?x.substr(idx+1):"";var k=unescape_val(kstr);var v=unescape_val(vstr);if(obj[k]===undefined)obj[k]=v;else if(Array.isArray(obj[k]))obj[k].push(v);else obj[k]=[obj[k],v]}return obj};function token_regex(s,end){return end?"^"+s+"$":s}E.http_glob_host=function(host,end){var port="";var parts=host.split(":");host=parts[0];if(parts.length>1)port=":"+parts[1].replace("*","[0-9]+");var n=host.match(/^(|.*[^*])(\*+)$/);if(n){host=E.http_glob_host(n[1])+(n[2].length==1?"[^./]+":"[^/]"+(n[1]?"*":"+"));return token_regex(host+port,end)}host=host.replace(/\*\*\./,"**").replace(/\*\./,"*").replace(/\./g,"\\.").replace(/\*\*/g,"(([^./]+\\.)+)?").replace(/\*/g,"[^./]+\\.");return token_regex(host+port,end)};E.http_glob_path=function(path,end){if(path[0]=="*")return E.http_glob_path("/"+path,end);var n=path.match(/^(|.*[^*])(\*+)([^*^\/]*)$/);if(n){path=E.http_glob_path(n[1])+(n[2].length==1?"[^/]+":".*")+E.http_glob_path(n[3]);return token_regex(path,end)}path=path.replace(/\*\*\//,"**").replace(/\*\//,"*").replace(/\//g,"\\/").replace(/\./g,"\\.").replace(/\*\*/g,"(([^/]+\\/)+)?").replace(/\*/g,"[^/]+\\/");return token_regex(path,end)};E.http_glob_url=function(url,end){var n=url.match(/^((.*):\/\/)?([^\/]+)(\/.*)?$/);if(!n)return null;var prot=n[1]?n[2]:"*";var host=n[3];var path=n[4]||"**";if(prot=="*")prot="https?";host=E.http_glob_host(host);path=E.http_glob_path(path);return token_regex(prot+":\\/\\/"+host+path,end)};E.root_url_cmp=function(a,b){var a_s=a.match(/^[*.]*([^*]+)$/);var b_s=b.match(/^[*.]*([^*]+)$/);if(!a_s&&!b_s)return false;var re,s;if(a_s&&b_s&&a_s[1].length>b_s[1].length||a_s&&!b_s){s=a_s[1];re=b}else{s=b_s[1];re=a}s=E.add_proto(s)+"/";if(!(re=E.http_glob_url(re,1)))return false;try{re=new RegExp(re)}catch(e){return false}return re.test(s)};E.qs_strip=function(url){return/^[^?#]*/.exec(url)[0]};E.qs_str=function(_qs){var q=[];for(var k in _qs){(Array.isArray(_qs[k])?_qs[k]:[_qs[k]]).forEach((function(v){q.push(encodeURIComponent(k)+"="+encodeURIComponent(v))}))}return q.join("&")};E.qs_add=function(url,_qs){var u=E.parse(url),q=assign(u.query?E.qs_parse(u.query):{},_qs);u.path=u.pathname+"?"+E.qs_str(q);return E.uri_obj_href(u)};E.qs_parse_url=function(url){return E.qs_parse(url.replace(/(^.*\?)|(^[^?]*$)/,""))};E.segments=function(url){var parsed=E.parse(url||location.href);var dir=parsed.directory||"/";if(dir=="/")return[""];return dir.split("/")};E.safe_redir=function(url,default_hostname){if(!url)return;var u=E.parse(url,true);var hostname=u.hostname||default_hostname;if(!/^https?:$/.test(u.protocol)||!hostname)return;if(E.is_hola_domain(hostname)||zutil.is_mocha()&&hostname=="localhost")return"https://"+hostname+encodeURI(u.path)};return E}.apply(exports,__WEBPACK_AMD_DEFINE_ARRAY__),__WEBPACK_AMD_DEFINE_RESULT__!==undefined&&(module.exports=__WEBPACK_AMD_DEFINE_RESULT__))})()},,,function(module,exports,__webpack_require__){var __WEBPACK_AMD_DEFINE_ARRAY__,__WEBPACK_AMD_DEFINE_RESULT__;var module;
// LICENSE_CODE ZON ISC
"use strict";(function(){var is_node=typeof module=="object"&&module.exports&&module.children;if(!is_node);else;!(__WEBPACK_AMD_DEFINE_ARRAY__=[__webpack_require__(67),__webpack_require__(10)],__WEBPACK_AMD_DEFINE_RESULT__=function(cookie,zutil){var E={};var storage;function have_local_storage(){try{var _=window.localStorage;if(_.length)return true;_.setItem("_",0);_.removeItem("_");return true}catch(e){}}function select_local_storage(){storage=window.localStorage}function select_cookies(domain){var cookie_opt={domain:"."+domain,path:"/",expires:30};storage={getItem:cookie.get,setItem:function(key,val){cookie.set(key,val,cookie_opt)},removeItem:function(key){cookie.remove(key,cookie_opt)}}}E.init=function(opt){var domain;if(typeof opt=="string")domain=opt;if(E.is_test_storage=zutil.get(opt,"test_storage")&&zutil.is_mocha())return E.test_storage={};if(have_local_storage())return select_local_storage();console.error("cannot use localStorage, using cookies instead");select_cookies(domain||"hola.org")};E.init();E.on_err=function(){};E.set=function(key,val){if(E.is_test_storage)return E.test_storage[key]=val;try{return storage.setItem(key,val)}catch(err){E.on_err("storage_set",key,err)}};E.get=function(key){if(E.is_test_storage)return E.test_storage[key];try{return storage.getItem(key)}catch(err){E.on_err("storage_get",key,err)}};E.get_int=function(key){return+E.get(key)||0};E.clr=function(key){if(E.is_test_storage)return delete E.test_storage[key];try{storage.removeItem(key)}catch(err){E.on_err("storage_clr",key,err)}};E.set_json=function(key,val){try{return E.set(key,JSON.stringify(val||null))}catch(err){E.on_err("storage_set_json",key,err)}};E.get_json=function(key){var val=E.get(key);if(!val)return val;try{val=JSON.parse(val)}catch(err){console.log("err "+err)}return val};return E}.apply(exports,__WEBPACK_AMD_DEFINE_ARRAY__),__WEBPACK_AMD_DEFINE_RESULT__!==undefined&&(module.exports=__WEBPACK_AMD_DEFINE_RESULT__))})()},function(module,exports,__webpack_require__){var __WEBPACK_AMD_DEFINE_ARRAY__,__WEBPACK_AMD_DEFINE_RESULT__;var module;
// LICENSE_CODE ZON
"use strict";(function(){const is_node=typeof module=="object"&&module.exports&&module.children;if(!is_node);else;!(__WEBPACK_AMD_DEFINE_ARRAY__=[__webpack_require__(45),__webpack_require__(10),__webpack_require__(18)],__WEBPACK_AMD_DEFINE_RESULT__=function(sprintf,zutil,zurl){const E={};E.get_root_domain=zurl.get_root_domain;E.get_root_url=url=>{const n=(url||"").match(/^https?:\/\/([^\/]+)(\/.*)?$/);if(!n)return null;return E.get_root_domain(n[1])};E.find_rule=(rules,opt)=>{if(!rules)return;for(let i in rules){const r=rules[i];if(opt.name==r.name&&(opt.type===undefined||opt.type==r.type)&&(opt.md5===undefined||opt.md5==r.md5)&&(opt.country===undefined||opt.country.toLowerCase()==r.country.toLowerCase())){return r}}return null};E.gen_route_str=(route_opt,opt)=>{opt=opt||{};if(route_opt.direct)return"direct";let s=route_opt.country.toLowerCase(),r=[];if(route_opt.peer)r.push("peer");if(route_opt.pool){r.push("pool"+(typeof route_opt.pool=="string"?"_"+route_opt.pool:""))}if(!opt.no_algo&&route_opt.algo)r.push(route_opt.algo);if(r.length)s+="."+r.join(",");return s};function ip_list_to_agents(ip_list){return fix_zagent(Object.keys(ip_list).join(","))}function fix_zagent(s){return s.replace(/.hola.org/g,"").replace(/zagent/g,"za")}function pad(num,size){return("000"+num).slice(-size)}function time_str(d){d=new Date(d);if(isNaN(d))return"00:00:00.000";return pad(d.getUTCHours(),2)+":"+pad(d.getUTCMinutes(),2)+":"+pad(d.getUTCSeconds(),2)+"."+pad(d.getUTCMilliseconds(),3)}E.events_enabled=false;E.events=[];E.events_n={};E.reset_events=()=>{E.events=[];E.events_n={}};E.push_event=(name,opt)=>{try{if(!E.events_enabled)return;if(E.events.length>512)E.events.splice(0,E.events.length/2);E.events.push({name:name,ts:Date.now(),opt:opt});E.events_n[name]=(E.events_n[name]||0)+1}catch(err){console.error("push_event error %s",err&&err.stack)}};E.enable_events_logging=enabled=>{E.events_enabled=!!enabled;if(!enabled)E.reset_events()};E.get_event_n=e=>E.events_n[e];E.events_to_str=()=>{let s="",a=[];E.events.forEach(e=>{let s=time_str(e.ts)+" "+e.name,o=e.opt;switch(e.name){case">zgettunnels":s+=sprintf(" %s%s",o.country,o.exclude?" exclude "+fix_zagent(o.exclude):"");break;case"<zgettunnels":s+=sprintf(" %s%s",o.country," agents "+ip_list_to_agents(o.ip_list));break;case"set_rule":s+=sprintf(" %s%s%s%s%s",o.name,o.enabled?" "+o.country:" off",o.del?" del":"",o.src?" src "+o.src:"",!o.full_vpn?" !full_vpn":"",o.mode=="unblock"?"":" mode "+o.mode);break;case"<verify_err":s+=sprintf(" %s %s",o.host?fix_zagent(o.host):o.ip," "+o.err);break;case"<verify":s+=sprintf(" %s %s",o.host?fix_zagent(o.host):o.ip,o.rtt?o.rtt+"ms":"!rtt");break;case">verify":s+=sprintf(" %s",o.host?fix_zagent(o.host):o.ip);break;case">stuck":case">stuck_long":break;case"<stuck_end":s+=sprintf(" %sms",o.duration);break;case"pac_miss":s+=sprintf(" %s!=%s %s",o.req_ip,o.agent_ip,o.url);break;case"pac_reload":s+=sprintf(" after %ssec",(o.new_ts-o.init_ts)/1e3);break;case"navgiate":s+=sprintf(" tab %s %s",o.tab_id,o.url);break;case"popup_render":case"tpopup_render":break;case"pac_slow":s+=sprintf(" %dms %s",o.dur,(o.url||"").substr(0,50));break;default:s+=JSON.stringify(o)||"";break}a.push(s)});a=a.reverse();return a.join("\n")};class Domain_tree{constructor(){this.clear()}*[Symbol.iterator](){let parts=[];for(let item of Domain_tree.iterate_subtree(parts,this.tree))yield item}clear(){this.tree={}}get_value(domain){if(!domain)return;let parts=domain.split(".");let leaf=this.tree,value=leaf[Domain_tree.VALUE];for(let i=parts.length-1;leaf&&i>=0;i--){leaf=leaf[parts[i]];value=leaf&&Domain_tree.VALUE in leaf?leaf[Domain_tree.VALUE]:value}return value}set_value(domain,value){if(!domain)return void(this.tree[Domain_tree.VALUE]=value);let parts=domain.split(".");let leaf=this.tree;for(let i=parts.length-1;i>=0;i--)leaf=leaf[parts[i]]=leaf[parts[i]]||{};leaf[Domain_tree.VALUE]=value}}Domain_tree.VALUE=Symbol.for("value");Domain_tree.iterate_subtree=function*(parts,leaf){if(Domain_tree.VALUE in leaf)yield[parts.slice().reverse().join("."),leaf[Domain_tree.VALUE]];for(let key in leaf){parts.push(key);for(let item of Domain_tree.iterate_subtree(parts,leaf[key]))yield item;parts.pop()}};E.Domain_tree=Domain_tree;return E}.apply(exports,__WEBPACK_AMD_DEFINE_ARRAY__),__WEBPACK_AMD_DEFINE_RESULT__!==undefined&&(module.exports=__WEBPACK_AMD_DEFINE_RESULT__))})()},function(module,exports,__webpack_require__){var __WEBPACK_AMD_DEFINE_ARRAY__,__WEBPACK_AMD_DEFINE_RESULT__;var module;
// LICENSE_CODE ZON ISC
"use strict";(function(){var is_node=typeof module=="object"&&module.exports&&module.children;if(!is_node);else;!(__WEBPACK_AMD_DEFINE_ARRAY__=[],__WEBPACK_AMD_DEFINE_RESULT__=function(){var E={};E.un={};var html_escape_table={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"};E.html=function(html){return html.replace(/[&<>"']/g,(function(m){return html_escape_table[m[0]]}))};E.sh=function(s_or_a){function single(s){s=""+s;if(!s)return'""';if(/^[a-z0-9_\-.\/:]+$/i.test(s))return s;return'"'+s.replace(/([\\"`$])/g,"\\$1")+'"'}if(arguments.length==1&&!Array.isArray(s_or_a))return single(s_or_a);var s="",a=Array.isArray(s_or_a)?s_or_a:arguments;for(var i=0;i<a.length;i++)s+=(i?" ":"")+single(a[i]);return s};E.un_sh=function(s,keep_esc){var state={PARSE_STATE_INIT:0,PARSE_STATE_NORMAL_ARG:1,PARSE_STATE_QUOTE_ARG:2},cur_state=state.PARSE_STATE_INIT;var i,quote=0,argv=[],a="";for(i=0;i<s.length;i++){var esc=0;a+=s[i];if(s[i]=="\\"&&s[1]){if(!keep_esc)a=a.slice(0,-1);esc=1;i++;a+=s[i]}switch(cur_state){case state.PARSE_STATE_INIT:switch(s[i]){case"\r":case"\n":case" ":case"\t":if(!esc){a="";break}case'"':case"'":if(!esc){cur_state=state.PARSE_STATE_QUOTE_ARG;if(!keep_esc)a=a.slice(0,-1);quote=s[i];break}default:cur_state=state.PARSE_STATE_NORMAL_ARG}break;case state.PARSE_STATE_NORMAL_ARG:switch(s[i]){case"\r":case"\n":case" ":case"\t":if(!esc){cur_state=state.PARSE_STATE_INIT;a=a.slice(0,-1);argv.push(a);a=""}break;case'"':case"'":if(!esc){cur_state=state.PARSE_STATE_QUOTE_ARG;quote=s[i];if(!keep_esc)a=a.slice(0,-1)}break}break;case state.PARSE_STATE_QUOTE_ARG:if(s[i]==quote&&!esc){cur_state=state.PARSE_STATE_NORMAL_ARG;if(!keep_esc)a=a.slice(0,-1)}break}}if(cur_state==state.PARSE_STATE_NORMAL_ARG){cur_state=state.PARSE_STATE_INIT;argv.push(a)}if(cur_state!=state.PARSE_STATE_INIT)throw"error parsing shell";return argv};E.regex=function(s){return s.replace(/[[\]{}()*+?.\\^$|\/]/g,"\\$&")};E.uri_comp=function(s){return encodeURIComponent(s).replace(/%20/g,"+")};var http_escape_chars=[];(function(){var i;for(i=0;i<256;i++){var c=String.fromCharCode(i);http_escape_chars[i]=/^[a-zA-Z0-9_.~,\-]$/.test(c)?c:"%"+("0"+i.toString(16)).slice(-2)}})();E.encodeURIComponent_bin=function(s_or_b){var s=typeof Buffer!="undefined"&&s_or_b instanceof Buffer?s_or_b.toString("binary"):""+s_or_b;var esc="";for(var i=0;i<s.length;i++)esc+=http_escape_chars[s.charCodeAt(i)]||encodeURIComponent(s[i]);return esc};E.qs=function(param,opt){opt=opt||{};var qs=opt.qs||"";var sep=qs||opt.amp?"&":"";if(!param)return qs;var uri_comp=opt.space_plus===undefined||opt.space_plus?E.uri_comp:encodeURIComponent;var uri_comp_val=opt.bin?E.encodeURIComponent_bin:uri_comp;for(var i in param){var val=param[i];if(val===undefined)continue;var key=uri_comp(i);qs+=sep;if(val===null)qs+=key;else if(Array.isArray(val)){if(!val.length)continue;qs+=val.map((function(val){return key+"="+uri_comp_val(val)})).join("&")}else qs+=key+"="+uri_comp_val(val);sep="&"}return qs};E.uri=function(uri,qs,hash){var opt;if(typeof uri=="string")opt={uri:uri,_qs:qs,hash:hash};else{opt=Object.assign({},uri);opt._qs=opt.qs;opt.qs=undefined}uri=opt.uri;qs=typeof opt._qs=="string"?opt._qs:E.qs(opt._qs,opt);hash=typeof opt.hash=="string"?opt.hash:E.qs(opt.hash,opt);if(qs){if(!uri.includes("?"))uri+="?";else if(uri[uri.length-1]!="?"&&uri[uri.length-1]!="&")uri+="&"}else qs="";if(hash)hash="#"+hash;else hash="";return uri+qs+hash};E.mailto_url=function(mail){return"mailto:"+(mail.to||"")+"?"+E.qs({cc:mail.cc,bcc:mail.bcc,subject:mail.subject,body:mail.body},{space_plus:false})};E.parse={};E.parse.eat_token=function(s_obj,re){var match;if(!(match=re.exec(s_obj.s)))return match;s_obj.s=s_obj.s.substr(match.index+match[0].length);return match};E.parse.http_words=function(val){var res=[],o={s:val},eat_token=E.parse.eat_token,match;while(o.s){if(match=eat_token(o,/^\s*(=*[^\s=;,]+)/)){var v=match[1];if(match=eat_token(o,/^\s*=\s*\"([^\"\\]*(?:\\.[^\"\\]*)*)\"/))res.push([v,match[1].replace(/\\(.)/,"$1")]);else if(match=eat_token(o,/^\s*=\s*([^;,\s]*)/))res.push([v,match[1].replace(/\s+$/,"")]);else res.push([v,null])}else if(match=eat_token(o,/^\s*,/));else if((match=eat_token(o,/^\s*;/))||(match=eat_token(o,/^\s+/)));else throw new Error("This should not happen: "+o.s)}return res};return E}.apply(exports,__WEBPACK_AMD_DEFINE_ARRAY__),__WEBPACK_AMD_DEFINE_RESULT__!==undefined&&(module.exports=__WEBPACK_AMD_DEFINE_RESULT__))})()},,,function(module,exports,__webpack_require__){var __WEBPACK_AMD_DEFINE_ARRAY__,__WEBPACK_AMD_DEFINE_RESULT__;var module;
// LICENSE_CODE ZON ISC
"use strict";(function(){var is_node=typeof module=="object"&&module.exports&&module.children;if(!is_node);else;!(__WEBPACK_AMD_DEFINE_ARRAY__=[],__WEBPACK_AMD_DEFINE_RESULT__=function(){var E={};var proto_slice=Array.prototype.slice;E.copy=function(a){switch(a.length){case 0:return[];case 1:return[a[0]];case 2:return[a[0],a[1]];case 3:return[a[0],a[1],a[2]];case 4:return[a[0],a[1],a[2],a[3]];case 5:return[a[0],a[1],a[2],a[3],a[4]];default:return proto_slice.call(a)}};E.push=function(a){for(var i=1;i<arguments.length;i++){var arg=arguments[i];if(Array.isArray(arg))a.push.apply(a,arg);else a.push(arg)}return a.length};E.unshift=function(a){for(var i=arguments.length-1;i>0;i--){var arg=arguments[i];if(Array.isArray(arg))a.unshift.apply(a,arg);else a.unshift(arg)}return a.length};E.slice=function(args,from,to){return Array.prototype.slice.call(args,from,to)};E.compact=function(a){return E.compact_self(a.slice())};E.compact_self=function(a){var i,j,n=a.length;for(i=0;i<n&&a[i];i++);if(i==n)return a;for(j=i;i<n;i++){if(!a[i])continue;a[j++]=a[i]}a.length=j;return a};E.flatten_shallow=function(a){return Array.prototype.concat.apply([],a)};E.flatten=function(a){var _a=[],i;for(i=0;i<a.length;i++){if(Array.isArray(a[i]))Array.prototype.push.apply(_a,E.flatten(a[i]));else _a.push(a[i])}return _a};E.unique=function(a){var _a=[];for(var i=0;i<a.length;i++){if(!_a.includes(a[i]))_a.push(a[i])}return _a};E.to_nl=function(a,sep){if(!a||!a.length)return"";if(sep===undefined)sep="\n";return a.join(sep)+sep};E.sed=function(a,regex,replace){var _a=new Array(a.length),i;for(i=0;i<a.length;i++)_a[i]=a[i].replace(regex,replace);return _a};E.grep=function(a,regex,replace){var _a=[],i;for(i=0;i<a.length;i++){if(a[i].search(regex)<0)continue;if(replace!==undefined)_a.push(a[i].replace(regex,replace));else _a.push(a[i])}return _a};E.rm_elm=function(a,elm){var i=a.indexOf(elm);if(i<0)return;a.splice(i,1);return elm};E.rm_elm_tail=function(a,elm){var i=a.length-1;if(elm===a[i]){a.pop();return elm}if((i=a.lastIndexOf(elm,i-1))<0)return;a.splice(i,1);return elm};E.add_elm=function(a,elm){if(a.includes(elm))return;a.push(elm);return elm};E.split_every=function(a,n){var ret=[];for(var i=0;i<a.length;i+=n)ret.push(a.slice(i,i+n));return ret};E.split_at=function(a,delim){var ret=[];delim=delim||"";for(var i=0;i<a.length;i++){var chunk=[];for(;i<a.length&&a[i]!=delim;i++)chunk.push(a[i]);if(chunk.length)ret.push(chunk)}return ret};E.rotate=function(a,n){if(a&&a.length>1&&(n=n%a.length))E.unshift(a,a.splice(n));return a};E.move=function(a,from,to,n){return Array.prototype.splice.apply(a,[to,n].concat(a.slice(from,from+n)))};E.to_array=function(v){return Array.isArray(v)?v:v==null?[]:[v]};var proto={};proto.sed=function(regex,replace){return E.sed(this,regex,replace)};proto.grep=function(regex,replace){return E.grep(this,regex,replace)};proto.to_nl=function(sep){return E.to_nl(this,sep)};proto.push_a=function(){return E.push.apply(null,[this].concat(Array.from(arguments)))};proto.unshift_a=function(){return E.unshift.apply(null,[this].concat(Array.from(arguments)))};var installed;E.prototype_install=function(){if(installed)return;installed=true;for(var i in proto){Object.defineProperty(Array.prototype,i,{value:proto[i],configurable:true,enumerable:false,writable:true})}};E.prototype_uninstall=function(){if(!installed)return;installed=false;for(var i in proto)delete Array.prototype[i]};return E}.apply(exports,__WEBPACK_AMD_DEFINE_ARRAY__),__WEBPACK_AMD_DEFINE_RESULT__!==undefined&&(module.exports=__WEBPACK_AMD_DEFINE_RESULT__))})()},function(module,exports,__webpack_require__){var __WEBPACK_AMD_DEFINE_ARRAY__,__WEBPACK_AMD_DEFINE_RESULT__;var module;
// LICENSE_CODE ZON ISC
"use strict";(function(){var is_node=typeof module=="object"&&module.exports&&module.children;if(is_node);else;!(__WEBPACK_AMD_DEFINE_ARRAY__=[__webpack_require__(45),__webpack_require__(65)],__WEBPACK_AMD_DEFINE_RESULT__=function(sprintf,conv){var E={};var ver_regexp=/^(\d{1,3})\.(\d{1,3})\.(\d{1,3})$/;E._expand=function(ver){var v;if(!ver)return"";if(!(v=ver_regexp.exec(ver)))return;return sprintf("%03d.%03d.%03d",+v[1],+v[2],+v[3])};E.expand=conv.cache_str_fn(E._expand);E._trim=function(ver){var v;if(!ver)return"";if(!(v=ver_regexp.exec(ver)))return;return""+ +v[1]+"."+ +v[2]+"."+ +v[3]};E.trim=conv.cache_str_fn(E._trim);E._cmp=function(v1,v2){if(!v1||!v2)return+!!v1-+!!v2;var _v1=(""+v1).split("."),_v2=(""+v2).split("."),i;for(i=0;i<_v1.length&&i<_v2.length&&+_v1[i]==+_v2[i];i++);if(_v1.length==i||_v2.length==i)return _v1.length-_v2.length;return+_v1[i]-+_v2[i]};E.cmp=conv.cache_str_fn2(E._cmp);E._valid=function(v){return ver_regexp.test(""+v)};var version_valid_cache={};E.valid=function(v){var cache=version_valid_cache,res;v=""+v;if(v in cache)return cache[v];if(res=E._valid(v))cache[v]=res;return res};function iter_ver(version,cb){var v;if(!E.valid(version))return version;v=version.split(".");for(var i=v.length-1;i>=0&&!cb(v,i);i--);return v.join(".")}E.inc=function(version){return iter_ver(version,(function(v,i){if(v[i]<999){v[i]=+v[i]+1;return true}v[i]=0}))};E.dec=function(version){return iter_ver(version,(function(v,i){if(v[i]>0){v[i]=+v[i]-1;return true}v[i]=999}))};E.get_max=function(versions,cmp){var v,i;versions=versions.sort(cmp||function(v1,v2){return E.cmp(v2.version,v1.version)});for(i=0;i<versions.length;i++){v=versions[i];if(+v.isbranch||!+v.soft_tag||!+v.onsymbol||v.repository!="zon"||!E.valid(v.version)){continue}return v.version}};E.hash=function(ver){return conv.md5("wQ"+ver+"\n",8)};E.ver2int=function(ver){var m=ver_regexp.exec(ver);return m&&+m[1]*1e6+ +m[2]*1e3+ +m[3]};E.int2ver=function(n){if(!n)return"";var n3=n%1e3;n=n/1e3|0;var n2=n%1e3;n=n/1e3|0;return n+"."+n2+"."+n3};return E}.apply(exports,__WEBPACK_AMD_DEFINE_ARRAY__),__WEBPACK_AMD_DEFINE_RESULT__!==undefined&&(module.exports=__WEBPACK_AMD_DEFINE_RESULT__))})()},function(module,exports,__webpack_require__){"use strict";var __WEBPACK_AMD_DEFINE_ARRAY__,__WEBPACK_AMD_DEFINE_RESULT__;// LICENSE_CODE ZON
!(__WEBPACK_AMD_DEFINE_ARRAY__=[__webpack_require__(11),__webpack_require__(12),__webpack_require__(78),__webpack_require__(17),__webpack_require__(79),__webpack_require__(15),__webpack_require__(27),__webpack_require__(80),__webpack_require__(47),__webpack_require__(10),__webpack_require__(13)],__WEBPACK_AMD_DEFINE_RESULT__=function(etask,zerr,be_msg,be_backbone,be_chrome,_,version_util,be_transport,user_agent,zutil,be_vpn_util){const chrome=window.chrome;const is_tpopup=be_vpn_util.is_tpopup();const is_tpopup_window=be_vpn_util.get_tpopup_mode()=="window";const use_msg=is_tpopup&&!is_tpopup_window;const use_backbone_over_msg=use_msg;const bg=is_tpopup&&!is_tpopup_window?null:chrome.extension.getBackgroundPage();const E=new(be_backbone.model.extend({model_name:"browser",_defaults:function(){this.use_msg=use_msg;this.bg=bg;this.msg=new be_msg;this.on("destroy",()=>E.uninit())}}));if(zutil.is_mocha()){chrome.browserAction={setIcon:()=>{},setBadgeText:()=>{},setBadgeBackgroundColor:()=>{}};chrome.windows={getLastFocused:()=>{},onFocusChanged:{addListener:()=>{},removeListener:()=>{}}};chrome.storage={local:{get:()=>{},set:()=>{},remove:()=>{}}};chrome.tabs={update:()=>{},reload:()=>{},query:()=>{},get:()=>{},onFocusChanged:{addListener:()=>{},removeListener:()=>{}},onCreated:{addListener:()=>{},removeListener:()=>{}},onUpdated:{addListener:()=>{},removeListener:()=>{}},onActivated:{addListener:()=>{},removeListener:()=>{}},onRemoved:{addListener:()=>{},removeListener:()=>{}},onReplaced:{addListener:()=>{},removeListener:()=>{}}}}E.uninit=()=>{if(!E.inited)return;if(zutil.is_mocha()){be_chrome.uninit();E.msg.uninit()}else{be_chrome._destroy();E.msg._destroy()}E.inited=false};E.init=opt=>{if(E.inited)return;E.inited=true;E.browser_version=user_agent.guess_browser().version;E.os=user_agent.guess().os;opt=opt||{};E.msg.init(get_transport(),{context:opt.context!==undefined?opt.context:{}});E.rpc=use_msg?E.rpc_types.chrome_msg:E.rpc_types.chrome_native;E.rpc.init()};function get_transport(){if(is_tpopup&&!is_tpopup_window){return be_transport.tpopup(chrome,zutil.get(window,"hola.tpopup_opt.tab_id"))}return be_transport.chrome_tabs(chrome)}E.rpc_types={chrome_native:{init:function(){if(this.inited)return;this.inited=true;be_chrome.init(E.msg);be_chrome.impl.init();E.runtime.id=be_chrome.impl.id;E.runtime.url=be_chrome.impl.url;E.runtime.manifest=be_chrome.impl.manifest},call_api:function(obj,sub,func,args,cb,ms,error_cb){var _this=this,_cb=!cb?null:function(){E.runtime.last_error=_this.last_error=chrome.runtime.lastError;return cb.apply(null,arguments)};return be_chrome.impl.call_api(obj,sub,func,args,_cb)},add_listener:(obj,sub,cb,opt,extra)=>be_chrome.impl.add_listener(obj,sub,cb,opt,extra),del_listener:(obj,sub,cb)=>be_chrome.impl.del_listener(obj,sub,cb)},chrome_msg:{init:function(){if(this.inited)return;this.inited=true;be_chrome.init(E.msg);E.rpc.call_api("impl","","init",[],(function(o){E.runtime.id=o.id;E.runtime.manifest=o.manifest;if(E.runtime.url=o.url)return;E.runtime.url=chrome?"chrome-extension://"+o.id:"resource://"+o.id.replace("@","-at-").toLowerCase()+"/hola_firefox_ext"}))},call_api:function(obj,sub,func,args,cb,ms,error_cb){var _this=this;return E.msg.send({msg:"call_api",obj:obj,sub:sub,func:func,args:args,has_cb:!!cb},(function(ret){if(!cb)return;E.runtime.last_error=_this.last_error=ret.last_error;if(ret.error){if(error_cb)error_cb(ret);return}cb.apply(null,ret.args)}),ms)},add_listener:(obj,sub,cb)=>E.msg.add_listener({obj:obj,sub:sub},cb),del_listener:(obj,sub,cb)=>E.msg.del_listener({obj:obj,sub:sub},cb)}};E.tabs={disconnect:(tab_id,cb)=>{if(use_msg)return E.rpc.call_api("tabs","","disconnect",[tab_id],cb);var m=E.msg;m.disconnect(tab_id);if(cb)cb()},is_connected:tab_id=>!!E.msg.tab_connections[tab_id],get_tab_connections:tab_id=>E.msg.tab_connections[tab_id]};E.runtime={};function get_backbone_obj(id){var main=bg&&bg.be_bg_main;return main&&main.be_browser.backbone.server.obj[id]}E.backbone={client:{obj:{}},server:{obj:{},cb:{}}};E.backbone.client.ping=function(id,ms,cb){if(!use_backbone_over_msg){if(get_backbone_obj(id))return be_vpn_util.set_timeout(()=>cb({}));be_vpn_util.set_timeout(()=>{const o=get_backbone_obj(id);cb(o?{}:{error:"no_object"})},ms);return}E.rpc.call_api("backbone","server","ping",[id],cb,ms,cb)};E.backbone.client.start=function(id){zerr.debug("backbone.client.start "+id);if(!use_backbone_over_msg)return get_backbone_obj(id);var o=this.obj[id],_this=this;zerr.assert(!o,"client "+id+" already started");o=this.obj[id]=new be_backbone.model;E.msg.on_backbone_event=function(info){var o=_this.obj[info.id];if(!o)return;var ename=info.ename;if(ename.includes("change:")){var attr=ename.replace("change:",""),val=info.args[0];o.set(attr,val)}else o.trigger.apply(o,[ename].concat(info.args))};o.fcall=(func,args)=>E.rpc.call_api("backbone.server.obj."+id,"fcall",func,args);o.ecall=(func,args)=>etask((function*(){const ret=yield etask.cb_apply(E.rpc,".call_api",["backbone.server.obj."+id,"ecall",func,args]);be_vpn_util.assert(!zutil.get(ret,"_error"),zutil.get(ret,"_error"));return ret}));E.rpc.call_api("backbone","server","connect",[id],(function(ret){var o=_this.obj[id];if(!o)return zerr("client %s got connected after stop",id);if(ret.error)return zerr("backbone.client.start error: "+ret.error);o.set(ret.attributes);o.set("_backbone_client_started",true)}));return o};E.backbone.client.stop=function(id){zerr.debug("backbone.client.stop "+id);if(!use_backbone_over_msg)return;var o=this.obj[id];zerr.assert(o,"client "+id+" not started");E.rpc.call_api("backbone","server","disconnect",[id,o.get("_backbone_client_id")]);o._destroy();delete this.obj[id]};E.backbone.server.start=function(obj,id){zerr.debug("backbone.server.start "+id+" cid "+obj.cid);zerr.assert(!this.obj[id],"server "+id+" already started");this.obj[id]=obj};E.backbone.server.stop=function(id){zerr.debug("backbone.server.stop "+id);var o=this.obj[id];zerr.assert(o,"server "+id+" not started");delete this.obj[id]};return E}.apply(exports,__WEBPACK_AMD_DEFINE_ARRAY__),__WEBPACK_AMD_DEFINE_RESULT__!==undefined&&(module.exports=__WEBPACK_AMD_DEFINE_RESULT__))},,,function(module,exports,__webpack_require__){var __WEBPACK_AMD_DEFINE_ARRAY__,__WEBPACK_AMD_DEFINE_RESULT__;var module;
// LICENSE_CODE ZON ISC
"use strict";(function(){var is_node=typeof module=="object"&&module.exports&&module.children;var is_rn=typeof global=="object"&&!!global.nativeRequire||typeof navigator=="object"&&navigator.product=="ReactNative";if(is_rn){}else if(is_node);else;!(__WEBPACK_AMD_DEFINE_ARRAY__=[__webpack_require__(26)],__WEBPACK_AMD_DEFINE_RESULT__=function(array){var E={};E.rm_empty_last=function(a){if(a[a.length-1]==="")a.pop();return a};E.split_trim=function(s,sep,limit){return array.compact_self(s.split(sep,limit))};E.split_ws=function(s){return E.split_trim(s,/\s+/)};E.qw=function(s){if(Array.isArray(s)&&!s.raw)return s;return E.split_ws(!Array.isArray(s)?s:E.es6_str(arguments))};E.chomp=function(s){return s.replace(/\n$/,"")};E.split_crlf=function(s){return E.rm_empty_last(s.split(/\r?\n/))};E.split_nl=function(s){return E.rm_empty_last(s.split("\n"))};E.to_array_buffer=function(s){var buf=new ArrayBuffer(s.length),buf_view=new Uint8Array(buf),i;for(i=0;i<s.length;i++)buf_view[i]=s.charCodeAt(i);return buf};E.from_array_buffer=function(buf){return String.fromCharCode.apply(null,new Uint8Array(buf))};E.capitalize=function(s){s=""+s;return(s[0]||"").toUpperCase()+s.slice(1)};E.trunc=function(s,len){if(s.length<=len)return s;return s.slice(0,len)+"..."};E.template=function(strings){var keys=Array.prototype.slice.call(arguments,1);return function(){var values=arguments;var dict=values[values.length-1]||{};var result=[strings[0]];keys.forEach((function(key,i){var value=Number.isInteger(key)?values[key]:dict[key];result.push(value,strings[i+1])}));return result.join("")}};E.es6_str=function(args){var parts=args[0],s="";if(!Array.isArray(parts))return parts;s+=parts[0];for(var i=1;i<parts.length;i++){s+=args[i];s+=parts[i]}return s};E.align=function(){var str=E.es6_str(arguments),lines=str.split("\n");if(!lines[0])lines.shift();var spaces=Infinity;for(var i=0;i<lines.length;i++){var space=lines[i].match(/^\s*/)[0];if(space.length==lines[i].length)space=lines[i]="";else spaces=Math.min(spaces,space.length)}if(spaces>0&&spaces!=Infinity)lines=array.sed(lines,new RegExp("^ {"+spaces+"}"),"");return lines.join("\n")};E.nl2sp=function(){return E.es6_str(arguments).replace(/\n\s*/g," ")};E.detach=function(s){return(" "+s).slice(1)};E.hash=function(s){var hash=0;for(var i=0,l=s.length;i<l;i++)hash=(hash<<5)-hash+s.charCodeAt(i)>>>0;return hash};var alphabet="0123456789abcdefghijklmnopqrstuvwxyz";E.generate=function(len){len=len||12;var ret="";for(var i=0;i<len;i++)ret+=alphabet[Math.random()*alphabet.length|0];return ret};E.longest=function(){var i,s;for(i=0;i<arguments.length;i++)s=(arguments[i]||"").length>(s||"").length?arguments[i]:s;return s};return E}.apply(exports,__WEBPACK_AMD_DEFINE_ARRAY__),__WEBPACK_AMD_DEFINE_RESULT__!==undefined&&(module.exports=__WEBPACK_AMD_DEFINE_RESULT__))})()},,,,,,,,,,,,function(module,exports,__webpack_require__){var __WEBPACK_AMD_DEFINE_ARRAY__,__WEBPACK_AMD_DEFINE_RESULT__;var module;(function(){var is_node=typeof module=="object"&&module.exports&&module.children;var is_rn=typeof global=="object"&&!!global.nativeRequire||typeof navigator=="object"&&navigator.product=="ReactNative";if(!is_node&&!is_rn);else;!(__WEBPACK_AMD_DEFINE_ARRAY__=[],__WEBPACK_AMD_DEFINE_RESULT__=function(){function EventEmitter(){this._events={}}EventEmitter.prototype.listeners=function listeners(name){var events=this._events&&this._events[name]||[];var length=events.length,listeners=[],event;for(var i=0;i<length;event=events[++i])listeners.push(events[i].fn);return listeners};EventEmitter.prototype.emit=function emit(name,a1,a2,a3,a4,a5){if(!this._events||!this._events[name])return false;var listeners=this._events[name],length=listeners.length;var len=arguments.length,event=listeners[0],args,i;if(length===1){switch(len){case 1:event.fn.call(event.context||this);break;case 2:event.fn.call(event.context||this,a1);break;case 3:event.fn.call(event.context||this,a1,a2);break;case 4:event.fn.call(event.context||this,a1,a2,a3);break;case 5:event.fn.call(event.context||this,a1,a2,a3,a4);break;case 6:event.fn.call(event.context||this,a1,a2,a3,a4,a5);break;default:for(i=1,args=new Array(len-1);i<len;i++)args[i-1]=arguments[i];event.fn.apply(event.context||this,args)}if(event.once)remove_listener.apply(this,[name,event])}else{for(i=1,args=new Array(len-1);i<len;i++)args[i-1]=arguments[i];for(i=0;i<length;event=listeners[++i]){event.fn.apply(event.context||this,args);if(event.once)remove_listener.apply(this,[name,event])}}return true};function add_listener(name,fn,opt){opt=opt||{};if(!this._events)this._events={};if(!this._events[name])this._events[name]=[];var event={fn:fn};if(opt.context)event.context=opt.context;if(opt.once)event.once=opt.once;if(opt.prepend)this._events[name].unshift(event);else this._events[name].push(event);return this}function remove_listener(name,listener){if(!this._events||!this._events[name])return this;var listeners=this._events[name],events=[];var is_fn=typeof listener=="function";for(var i=0,length=listeners.length;i<length;i++){if(!listener)continue;if(is_fn&&listeners[i].fn!==listener||!is_fn&&listeners[i]!==listener){events.push(listeners[i])}}if(events.length)this._events[name]=events;else this._events[name]=null;return this}EventEmitter.prototype.on=function on(name,fn,context){return add_listener.apply(this,[name,fn,{context:context}])};EventEmitter.prototype.once=function once(name,fn,context){return add_listener.apply(this,[name,fn,{context:context,once:true}])};EventEmitter.prototype.prependListener=function prependListener(name,fn,context){return add_listener.apply(this,[name,fn,{context:context,prepend:true}])};EventEmitter.prototype.prependOnceListener=function prependOnceListener(name,fn,context){return this.prependListener(name,fn,{context:context,prepend:true,once:true})};EventEmitter.prototype.removeListener=function removeListener(name,fn){return remove_listener.apply(this,[name,fn])};EventEmitter.prototype.removeAllListeners=function removeAllListeners(name){if(!this._events)return this;if(name)this._events[name]=null;else this._events={};return this};EventEmitter.prototype.off=EventEmitter.prototype.removeListener;EventEmitter.prototype.addListener=EventEmitter.prototype.on;EventEmitter.prototype.setMaxListeners=function setMaxListeners(){return this};EventEmitter.prototype.eventNames=function eventNames(){var _this=this;return Object.keys(this._events).filter((function(e){return _this._events[e]!==null}))};EventEmitter.EventEmitter=EventEmitter;EventEmitter.EventEmitter2=EventEmitter;EventEmitter.EventEmitter3=EventEmitter;return EventEmitter}.apply(exports,__WEBPACK_AMD_DEFINE_ARRAY__),__WEBPACK_AMD_DEFINE_RESULT__!==undefined&&(module.exports=__WEBPACK_AMD_DEFINE_RESULT__))})()},,function(module,exports,__webpack_require__){var __WEBPACK_AMD_DEFINE_ARRAY__,__WEBPACK_AMD_DEFINE_RESULT__;var module;
// LICENSE_CODE ZON ISC
"use strict";(function(){var is_node=typeof module=="object"&&module.exports&&module.children;if(!is_node);else;!(__WEBPACK_AMD_DEFINE_ARRAY__=[],__WEBPACK_AMD_DEFINE_RESULT__=function(){var E=sprintf;E.sprintf=sprintf;var has=Object.prototype.hasOwnProperty;function sprintf(fmt){if(has.call(E.cache,fmt))return E.cache[fmt](arguments);E.cache[fmt]=E.parse(fmt);E.cache_n++;if(E.cache_cb)E.cache_cb(fmt);return E.cache[fmt](arguments)}E.cache={};E.cache_n=0;E.to_int=function(num){return(num=+num)>=0?Math.floor(num):-Math.floor(-num)};E.thousand_grouping=function(num_s){var m=/^([-+])?(\d*)(\.\d*)?$/.exec(num_s);if(!m)return num_s;m[2]=(m[2]||"").replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1"+",");return(m[1]||"")+m[2]+(m[3]||"")};E.stringify=function(value,replacer){if(is_array(replacer)){var r={},v;for(var i=0,l=replacer.length;i<l;i++){v=value_of(replacer[i]);if(typeof v=="string"||typeof v=="number")r[v]=true}replacer=r}else if(typeof replacer!="function")replacer=undefined;return _stringify("",{"":value},replacer,[])};function json_escape(str){return JSON.stringify(str)}function _stringify(key,holder,replacer,stack){var value;try{value=holder[key]}catch(e){value="__ERROR__: "+e}if(value&&typeof value=="object"&&typeof value.toJSON=="function")value=value.toJSON(key);if(typeof replacer=="function")value=replacer.call(holder,key,value);value=value_of(value);switch(typeof value){case"boolean":return value?"true":"false";case"string":return json_escape(value);case"number":return Number.isFinite(value)?json_escape(value):"null";case"object":if(value===null)return"null";if(stack.indexOf(value)>=0)return'"__CIRCULAR__"';stack.push(value);var s,a=[],p,ret;if(is_array(value)){for(var i=0,l=value.length;i<l;i++){s=_stringify(""+i,value,replacer,stack);a.push(s==null?"null":s)}ret="["+a.join(",")+"]"}else{for(p in value){if(!has.call(value,p))continue;if(typeof replacer=="object"&&!replacer[p])continue;if((s=_stringify(p,value,replacer,stack))!=null)a.push(json_escape(p)+":"+s)}ret="{"+a.join(",")+"}"}stack.pop();return ret;default:return undefined}}function value_of(v){return typeof v=="object"&&(v instanceof Number||v instanceof String||v instanceof Boolean)?v.valueOf():v}function is_array(a){return Object.prototype.toString.call(a)=="[object Array]"}function stringify(value){try{return JSON.stringify(value)}catch(e){return E.stringify(value)}}E.parse_fast=function(fmt){return E.parse_slow(fmt)};E.parse_slow=function(fmt){var _fmt=fmt,match=[],arg_names=0,cursor=1;var _f=[],out,arg,arg_s,argv,sign;function f(fn){_f.push(fn)}for(;_fmt;_fmt=_fmt.substring(match[0].length))(function(){if(match=/^[^%]+/.exec(_fmt)){var _match=match;f((function(){return out+=_match[0]}))}else if(match=/^%%/.exec(_fmt))f((function(){return out+="%"}));else if(match=/^%(?:([1-9]\d*)\$|\(([^\)]+)\))?(\+)?(0|'[^$])?(-)?(\d+)?(?:\.(\d+))?(')?([bcdefoOsuxX])/.exec(_fmt)){var positional=match[1],keyword=match[2],sign=match[3];var pad_zero=match[4],pad_min=match[5],pad_max=match[6];var precision=match[7],thousand_grouping=match[8]=="'";var conversion=match[9],keyword_list=[],_cursor=cursor;if(keyword){arg_names|=1;var _keyword=keyword,kmatch;if(!(kmatch=/^([a-z_][a-z_\d]*)/i.exec(_keyword)))throw"sprintf: invalid keyword property name "+_keyword;keyword_list.push(kmatch[1]);while(_keyword=_keyword.substring(kmatch[0].length)){if(kmatch=/^\.([a-z_][a-z_\d]*)/i.exec(_keyword))keyword_list.push(kmatch[1]);else if(kmatch=/^\[(\d+)\]/.exec(_keyword))keyword_list.push(kmatch[1]);else throw"sprintf: invalid keyword format "+_keyword}}else arg_names|=2;if(arg_names===3){throw"sprintf: mixing positional and named placeholders is "+"not (yet) supported"}f((function(){sign=false}));if(keyword_list.length){f((function(){arg=argv[_cursor];for(var k=0;k<keyword_list.length&&arg!=null;k++)arg=arg[keyword_list[k]]}))}else if(positional)f((function(){arg=argv[positional]}));else{f((function(){arg=argv[_cursor]}));cursor++}if(/[^sO]/.test(conversion))f((function(){return arg=+arg}));switch(conversion){case"b":f((function(){arg_s=arg.toString(2)}));break;case"c":f((function(){arg_s=String.fromCharCode(arg)}));break;case"d":f((function(){arg=sprintf.to_int(arg);arg_s=""+arg}));if(thousand_grouping)f((function(){arg_s=sprintf.thousand_grouping(arg_s)}));break;case"e":f((function(){arg_s=arg.toExponential(precision?precision:undefined)}));break;case"f":if(precision)f((function(){arg_s=arg.toFixed(precision)}));else f((function(){arg_s=""+arg}));if(thousand_grouping)f((function(){arg_s=sprintf.thousand_grouping(arg_s)}));break;case"o":f((function(){arg_s=arg.toString(8)}));break;case"O":f((function(){arg_s=stringify(arg)}));break;case"u":f((function(){arg=arg>>>0;arg_s=""+arg}));break;case"x":f((function(){arg_s=arg.toString(16)}));break;case"X":f((function(){arg_s=arg.toString(16).toUpperCase()}));break;case"s":f((function(){arg_s=""+arg}));if(precision)f((function(){arg_s=arg_s.substring(0,precision)}));break}if(/[def]/.test(conversion)){if(sign)f((function(){if(arg>=0)arg_s="+"+arg_s}));f((function(){sign=arg_s[0]=="-"||arg_s[0]=="+"}))}var pad_chr=!pad_zero?" ":pad_zero=="0"?"0":pad_zero[1];f((function(){var pad_chrs=pad_chr.repeat(Math.max(+pad_max-arg_s.length,0));var arg_padded=!pad_max?arg_s:pad_min?arg_s+pad_chrs:sign&&pad_chr[0]=="0"?arg_s[0]+pad_chrs+arg_s.slice(1):pad_chrs+arg_s;out+=arg_padded}))}else throw"sprintf invalid format "+_fmt})();return function(_argv){argv=_argv;out="";for(var i=0;i<_f.length;i++)_f[i](argv);return out}};E.parse=E.parse_slow;E.vsprintf=function(fmt,argv,opt){if(opt){if(opt.fast)return E.parse_fast(fmt)([fmt].concat(argv));if(opt.slow)return E.parse_slow(fmt)([fmt].concat(argv))}return E.sprintf.apply(null,[fmt].concat(argv))};return E}.apply(exports,__WEBPACK_AMD_DEFINE_ARRAY__),__WEBPACK_AMD_DEFINE_RESULT__!==undefined&&(module.exports=__WEBPACK_AMD_DEFINE_RESULT__))})()},function(module,exports,__webpack_require__){var __WEBPACK_AMD_DEFINE_ARRAY__,__WEBPACK_AMD_DEFINE_RESULT__;var module;
// LICENSE_CODE ZON ISC
"use strict";(function(){var is_node=typeof module=="object"&&module.exports&&module.children;var is_rn=typeof global=="object"&&!!global.nativeRequire||typeof navigator=="object"&&navigator.product=="ReactNative";if(!is_node&&!is_rn);else;!(__WEBPACK_AMD_DEFINE_ARRAY__=[],__WEBPACK_AMD_DEFINE_RESULT__=function(){var E=rate_limit;function rate_limit(rl,ms,n){var now=Date.now();if(!rl.count||rl.ts+ms<now){rl.count=1;rl.ts=now;return true}rl.count++;return rl.count<=n}E.leaky_bucket=function leaky_bucket(size,rate){this.size=size;this.rate=rate;this.time=Date.now();this.level=0};E.leaky_bucket.prototype.inc=function(inc){if(inc===undefined)inc=1;var now=Date.now();this.level-=this.rate*(now-this.time);this.time=now;if(this.level<0)this.level=0;var new_level=this.level+inc;if(new_level>this.size)return false;this.level=new_level;return true};return E}.apply(exports,__WEBPACK_AMD_DEFINE_ARRAY__),__WEBPACK_AMD_DEFINE_RESULT__!==undefined&&(module.exports=__WEBPACK_AMD_DEFINE_RESULT__))})()},function(module,exports,__webpack_require__){var __WEBPACK_AMD_DEFINE_RESULT__;var module;
// LICENSE_CODE ZON
"use strict";(function(){var is_node=typeof module=="object"&&module.exports&&module.children;if(!is_node);else;!(__WEBPACK_AMD_DEFINE_RESULT__=function(){var E={};var win_versions={"10.0":"10.0",6.3:"8.1",6.2:"8",6.1:"7","6.0":"vista",5.2:"2003",5.1:"xp","5.0":"2000"};var arch_mapping={x86_64:"64",i686:"32",arm:"arm"};var check_hola=/\bhola_android\b/i;var check_android_cdn=/Android.* CDNService\/([0-9\.]+)$/;var check_ios_cdn=/ CDNService\/([0-9\.]+)$/;var check_hola_player_app=/ (Spark|Hola)Player/;var check_opera=/\bOPR\b\/(\d+)/i;var check_edge=/\bEdge\b\/(\d+)/i;var check_xbox=/\bxbox\b/i;var check_ucbrowser=/\bUCBrowser\b\/(\d+)/i;var check_webview=/ Version\/(\d+)(\.\d)/;var check_chromium_edge=/\bEdg\/(\d+)/i;var is_browser=!is_node&&typeof window!="undefined";function is_ipad_os(ua){return/Macintosh/.test(ua)&&typeof navigator=="object"&&navigator.maxTouchPoints>1}function ios_ua(ua,safari_ver){var res;if(res=/(?:iPhone|iPad|iPod|iPod touch);.*?OS ([\d._]+)/.exec(ua)){var ios_ver=res[1];var is_chrome=/CriOS/.test(ua);var is_firefox=/FxiOS/.test(ua);var is_hola_ios=is_browser&&(window.hola_cdn_sdk||window.spark_ios_sdk)||check_ios_cdn.test(ua);var ucbrowser_ver=(check_ucbrowser.exec(ua)||[])[1];var is_ucbrowser=!!ucbrowser_ver;return{browser:"safari",version:safari_ver||ios_ver,ios:ios_ver,hola_ios:is_hola_ios,chrome:is_chrome,firefox:is_firefox,ucbrowser:is_ucbrowser,ucbrowser_version:ucbrowser_ver,webview:/Twitter/.test(ua)?"twitter":/GSA\/\d+/.test(ua)?"googlesearch":/FBAV\/\d+/.test(ua)?"facebook":!safari_ver&&!is_chrome&&!is_firefox&&!is_ucbrowser&&!is_hola_ios}}if(/HolaCDN iOS/.exec(ua))return{browser:"safari",hola_ios:true}}function check_chromium(ua){if(check_webview.test(ua)||/Android/.test(ua)||/ Mobile /.test(ua)||check_opera.test(ua)||check_chromium_edge.test(ua)){return false}var group="(?: (\\w*)\\/)?",ver="\\/[\\d\\.]+";var res=new RegExp("AppleWebKit"+ver+"(?: \\(.*\\))?"+group+".* Chrome"+ver+group+".* Safari"+ver+group).exec(ua);return res&&(res[1]||res[2]||res[3])}E.guess_browser=function(ua){var res;ua=ua||(is_browser?window.navigator&&navigator.userAgent:"");if(res=/\bOpera Mini\/(\d+)/.exec(ua))return{browser:"opera_mini",version:res[1]};var ucbrowser=check_ucbrowser.exec(ua);if(res=/[( ]MSIE ([6789]|10).\d[);]/.exec(ua))return{browser:"ie",version:res[1],xbox:check_xbox.test(ua)};if(res=/[( ]Trident\/\d+(\.\d)+.*rv:(\d\d)(\.\d)+[);]/.exec(ua))return{browser:"ie",version:res[2],xbox:check_xbox.test(ua)};if(res=/ Chrome\/(\d+)(\.\d+)+.* Safari\/\d+(\.\d+)+/.exec(ua)){var opera=check_opera.exec(ua);var edge;if(edge=check_edge.exec(ua))return{browser:"edge",version:edge[1]};var chromium_based=check_chromium(ua);return{browser:"chrome",version:res[1],android:ua.match(/Android/),webview:ua.match(check_webview),hola_android:check_hola.test(ua),hola_browser:chromium_based=="Hola",hola_app:check_android_cdn.test(ua),hola_player_app:check_hola_player_app.test(ua),chromium_based:chromium_based,edge:check_chromium_edge.test(ua),opera:opera&&!!opera[1],opera_version:opera?opera[1]:undefined,ucbrowser:ucbrowser&&!!ucbrowser[1],ucbrowser_version:ucbrowser?ucbrowser[1]:undefined,webos_app:/Web0S/.test(ua),samsung_browser:/SamsungBrowser/.test(ua)}}if(res=/ QupZilla\/(\d+\.\d+\.\d+).* Safari\/\d+.\d+/.exec(ua))return{browser:"qupzilla",version:res[1]};if(res=/\(PlayStation (\d+) (\d+\.\d+)\).* AppleWebKit\/\d+.\d+/.exec(ua)){return{browser:"playstation"+res[1],version:res[2]}}if(res=/\(SMART-TV; Linux; Tizen ([0-9.]+)\) AppleWebkit\//.exec(ua))return{browser:"samsung_tizen",version:res[1]};if(res=/ Version\/(\d+)(\.\d)+.* Safari\/\d+.\d+/.exec(ua)){if(!ua.match(/Android/))return ios_ua(ua,res[1])||{browser:"safari",version:res[1]};return{browser:"chrome",version:res[1],android:true,webview:true,hola_android:check_hola.test(ua),hola_app:check_android_cdn.test(ua),hola_player_app:check_hola_player_app.test(ua),ucbrowser:ucbrowser&&!!ucbrowser[1],ucbrowser_version:ucbrowser?ucbrowser[1]:undefined,samsung_browser:/SamsungBrowser/.test(ua)}}if(res=/ (Firefox|PaleMoon)\/(\d+).\d/.exec(ua)){return{browser:"firefox",version:res[2],palemoon:res[1]=="PaleMoon"}}if(/Hola\/\d+\.\d+.*?(?:iPhone|iPad|iPod)/.exec(ua))return{browser:"safari",version:"Hola"};if(res=ios_ua(ua))return res;return{}};E.browser_to_string=function(browser){if(typeof browser!="object"||!browser.browser)return"unknown";var s=browser.browser=="ie"&&browser.version>11?"edge":browser.browser;if(browser.version)s+=" "+browser.version;if(browser.chrome)s+=" chrome";if(browser.firefox)s+=" firefox";if(browser.xbox)s+=" xbox";if(browser.android)s+=" android";if(browser.webview){s+=" webview";if(typeof browser.webview=="string")s+="-"+browser.webview}if(browser.chromium_based)s+=" chromium_based";if(browser.samsung_browser)s+=" samsung";if(browser.edge)s+=" edge";if(browser.opera){s+=" opera";if(browser.opera_version)s+="-"+browser.opera_version}if(browser.hola_android)s+=" hola_android";if(browser.hola_app)s+=" hola_app";if(browser.hola_player_app)s+=" hola_player_app";if(browser.ucbrowser){s+=" ucbrowser";if(browser.ucbrowser_version)s+="-"+browser.ucbrowser_version}if(browser.palemoon)s+=" palemoon";if(browser.ios)s+=" ios";if(browser.webos_app)s+=" webos_app";return s?s:"unknown"};E.guess=function(ua,platform){var res;ua=ua||(is_browser?navigator.userAgent:"");platform=platform||(is_browser?navigator.platform:"");if(check_xbox.exec(ua))return{os:"xbox",mobile:false};if(res=/Windows(?: NT(?: (.*?))?)?[);]/.exec(ua)){return{os:"windows",version:win_versions[res[1]],release_version:res[1],arch:ua.match(/WOW64|Win64|x64/)?"64":"32",mobile:false}}if(/Windows Phone/.exec(ua))return{os:"winphone",mobile:true};if(/Macintosh/.exec(ua)){if(is_ipad_os(ua))return{os:"ios",mobile:true};if(res=/Macintosh.*; (?:Intel|PPC) Mac OS X (\d+[._]\d+)/.exec(ua)){return{os:"macos",version:res[1].replace("_","."),mobile:false}}return{os:"macos",mobile:false}}if(/Web0S.*SmartTV/.exec(ua)){return{os:"webos",version:/Chrome/.test(ua)?"3":"2",mobile:false,tv:true}}if(res=/(Android|Andr0id)(?: (\d+\.\d+))?/.exec(ua))return{os:"android",version:res[2],mobile:true};if(res=/(Linux|CrOS|OpenBSD|FreeBSD)(?: (x86_64|i686|arm))?/.exec(ua)){if(check_opera.test(ua)&&res[1]=="Linux"&&res[2]=="x86_64"&&/^Linux arm/.test(platform)){return{os:"android",mobile:true}}return{os:res[1].toLowerCase(),arch:arch_mapping[res[2]],nix:true,mobile:false}}if(res=/(?:iPhone|iPad|iPod|iPod touch);.*?OS (\d+[._]\d+)/.exec(ua))return{os:"ios",version:res[1].replace("_","."),mobile:true};if(/iPhone|iPad|iPod|HolaCDN iOS/.exec(ua))return{os:"ios",mobile:true};if(/PLAYSTATION/.exec(ua))return{os:"ps",mobile:false};if(/HitLeap Viewer/.exec(ua))return{os:"windows",mobile:false};return{}};E.guess_device=function(ua){var res;ua=ua||(is_browser?navigator.userAgent:"");if(res=/(iPhone|iPad|iPod)/.exec(ua))return{device:res[1].toLowerCase()};if(/Macintosh/.test(ua))return{device:is_ipad_os(ua)?"ipad":"mac"};return{}};E.support_fullscreen=function(){return!!(is_browser&&typeof document!="undefined"&&(document.fullscreenEnabled||document.mozFullScreenEnabled||document.webkitFullscreenEnabled||document.msFullscreenEnabled))};E.support_hover=function(){if(!is_browser)return false;if(window.matchMedia&&window.matchMedia("(hover: hover)").matches)return true;return!E.guess().mobile};return E}.call(exports,__webpack_require__,exports,module),__WEBPACK_AMD_DEFINE_RESULT__!==undefined&&(module.exports=__WEBPACK_AMD_DEFINE_RESULT__))})()},function(module,exports,__webpack_require__){var __WEBPACK_AMD_DEFINE_ARRAY__,__WEBPACK_AMD_DEFINE_RESULT__;var module;
// LICENSE_CODE ZON ISC
"use strict";(function(){var is_node=typeof module=="object"&&module.exports&&module.children;if(!is_node);else;!(__WEBPACK_AMD_DEFINE_ARRAY__=[__webpack_require__(66),__webpack_require__(11),__webpack_require__(16),__webpack_require__(23),__webpack_require__(12),__webpack_require__(43)],__WEBPACK_AMD_DEFINE_RESULT__=function($,etask,date,zescape,zerr,events){var E=ajax;var assign=Object.assign;E.events=new events.EventEmitter;E.json=function(opt){return ajax(assign({},opt,{json:1}))};E.abort=function(aj){aj.goto("abort")};function ajax(opt){var timeout=opt.timeout||20*date.ms.SEC,slow=opt.slow||2*date.ms.SEC;var retry=opt.retry,data=opt.data,qs=zescape.qs(opt.qs);var url=zescape.uri(opt.url,qs),perr=opt.perr;var method=opt.method||opt.type||"GET";var data_type=opt.json?"json":"text";var t0=Date.now();var xhr;zerr.debug("ajax("+data_type+") url "+url+" retry "+retry);return etask([function(){var ajopt={dataType:data_type,type:method,url:url,data:data,timeout:timeout,xhrFields:{}};if(opt.headers)ajopt.headers=opt.headers;if(opt.content_type)ajopt.contentType=opt.content_type;if(opt.with_credentials)ajopt.xhrFields.withCredentials=true;if(opt.onprogress)ajopt.xhrFields.onprogress=opt.onprogress;if(opt.onuploadprogress){ajopt.xhr=function(){var _xhr=$.ajaxSettings.xhr();_xhr.upload.onprogress=opt.onuploadprogress;return _xhr}}if(opt.multipart){ajopt.contentType=false;ajopt.processData=false;delete ajopt.dataType}if(opt.async!==undefined)ajopt.async=opt.async;xhr=$.ajax(ajopt);var _this=this;xhr.done((function(v){_this.continue(v)}));xhr.fail((function(_xhr,status_text,err){if(data_type=="json"&&_xhr&&_xhr.status==200&&["","ok","OK"].includes(_xhr.responseText)){_this.continue(null);return}if(!err&&data_type=="text"&&_xhr&&_xhr.responseText)err=_xhr.responseText;_this.throw(err instanceof Error?err:new Error(""+err))}));return this.wait()},function catch$(err){xhr=xhr||{};zerr("ajax("+data_type+") failed url "+url+" data "+zerr.json(data).substr(0,200)+" status: "+xhr.status+" "+xhr.statusText+"\nresponseText: "+(xhr.responseText||"").substr(0,200));if(retry&&(!opt.should_retry||opt.should_retry(err,xhr)))return this.return(ajax(assign({},opt,{retry:retry-1})));if(xhr.statusText=="timeout")E.events.emit("timeout",this);if(opt.no_throw){return{err:err,url:url,method:method,status:+xhr.status||0,data:get_res_data(xhr),xhr:xhr,error:xhr.statusText||"no_status",message:xhr.responseText}}err.hola_info={url:url,method:method,status:xhr.status,data:get_res_data(xhr),response_text:xhr.responseText};err.x_error=xhr.getResponseHeader("X-Luminati-Error")||xhr.getResponseHeader("X-Hola-Error");throw err},function(data){var t=Date.now()-t0;zerr[t>slow?"err":"debug"]("ajax("+data_type+") "+(t>slow?"SLOW ":"ok ")+t+"ms url "+url);if(t>slow&&perr)perr({id:"be_ajax_slow",info:t+"ms "+url});if(E.do_op)E.do_op(data&&data.do_op);return this.return(data)},function abort(){xhr.abort()}])}["GET","POST","PUT","DELETE"].forEach((function(m){E[m.toLowerCase()]=function(url,opt){url=typeof url=="string"?{url:url}:url;opt=assign({method:m,json:1},url,opt);if(!{get:1,delete:1}[opt.method.toLowerCase()]&&opt.data!=null&&typeof opt.data!="string"){opt.content_type=opt.content_type||"application/json";if(opt.content_type.startsWith("application/json"))opt.data=JSON.stringify(opt.data)}return ajax(opt)}}));function get_res_data(xhr){if(xhr.responseJSON!=null&&xhr.responseJSON!=="")return xhr.responseJSON;var content_type=xhr.getResponseHeader("content-type")||"";if(xhr.responseText&&content_type.includes("application/json")){try{return JSON.parse(xhr.responseText)}catch(e){}}return xhr.responseText||""}return E}.apply(exports,__WEBPACK_AMD_DEFINE_ARRAY__),__WEBPACK_AMD_DEFINE_RESULT__!==undefined&&(module.exports=__WEBPACK_AMD_DEFINE_RESULT__))})()},function(module,exports,__webpack_require__){var __WEBPACK_AMD_DEFINE_ARRAY__,__WEBPACK_AMD_DEFINE_RESULT__;var module;
// LICENSE_CODE ZON
"use strict";(function(){var is_node=typeof module=="object"&&module.exports&&module.children;if(!is_node);else;!(__WEBPACK_AMD_DEFINE_ARRAY__=[__webpack_require__(10)],__WEBPACK_AMD_DEFINE_RESULT__=function(zutil){var E={};E.ports_offset=24e3;E.ports={af:{port:0},ax:{port:1},al:{port:2},dz:{port:3},as:{port:4},ad:{port:5},ao:{port:6},ai:{port:7},aq:{port:8},ag:{port:9},ar:{port:10},am:{port:11},aw:{port:12},au:{port:13},at:{port:14},az:{port:15},bs:{port:16},bh:{port:17},bd:{port:18},bb:{port:19},by:{port:20},be:{port:21},bz:{port:22},bj:{port:23},bm:{port:24},bt:{port:25},bo:{port:26},bq:{port:27},ba:{port:28},bw:{port:29},bv:{port:30},br:{port:31},io:{port:32},bn:{port:33},bg:{port:34},bf:{port:35},bi:{port:36},kh:{port:37},cm:{port:38},ca:{port:39},cv:{port:40},ky:{port:41},cf:{port:42},td:{port:43},cl:{port:44},cn:{port:45},cx:{port:46},cc:{port:47},co:{port:48},km:{port:49},cg:{port:50},cd:{port:51},ck:{port:52},cr:{port:53},ci:{port:54},hr:{port:55},cu:{port:56},cw:{port:57},cy:{port:58},cz:{port:59},dk:{port:60},dj:{port:61},dm:{port:62},do:{port:63},ec:{port:64},eg:{port:65},sv:{port:66},gq:{port:67},er:{port:68},ee:{port:69},et:{port:70},fk:{port:71},fo:{port:72},fj:{port:73},fi:{port:74},fr:{port:75},gf:{port:76},pf:{port:77},tf:{port:78},ga:{port:79},gm:{port:80},ge:{port:81},de:{port:82},gh:{port:83},gi:{port:84},gr:{port:85},gl:{port:86},gd:{port:87},gp:{port:88},gu:{port:89},gt:{port:90},gg:{port:91},gn:{port:92},gw:{port:93},gy:{port:94},ht:{port:95},hm:{port:96},va:{port:97},hn:{port:98},hk:{port:99},hu:{port:100},is:{port:101},in:{port:102},id:{port:103},ir:{port:104},iq:{port:105},ie:{port:106},im:{port:107},il:{port:108},it:{port:109},jm:{port:110},jp:{port:111},je:{port:112},jo:{port:113},kz:{port:114},ke:{port:115},ki:{port:116},kp:{port:117},kr:{port:118},kw:{port:119},kg:{port:120},la:{port:121},lv:{port:122},lb:{port:123},ls:{port:124},lr:{port:125},ly:{port:126},li:{port:127},lt:{port:128},lu:{port:129},mo:{port:130},mk:{port:131},mg:{port:132},mw:{port:133},my:{port:134},mv:{port:135},ml:{port:136},mt:{port:137},mh:{port:138},mq:{port:139},mr:{port:140},mu:{port:141},yt:{port:142},mx:{port:143},fm:{port:144},md:{port:145},mc:{port:146},mn:{port:147},me:{port:148},ms:{port:149},ma:{port:150},mz:{port:151},mm:{port:152},na:{port:153},nr:{port:154},np:{port:155},nl:{port:156},nc:{port:157},nz:{port:158},ni:{port:159},ne:{port:160},ng:{port:161},nu:{port:162},nf:{port:163},mp:{port:164},no:{port:165},om:{port:166},pk:{port:167},pw:{port:168},ps:{port:169},pa:{port:170},pg:{port:171},py:{port:172},pe:{port:173},ph:{port:174},pn:{port:175},pl:{port:176},pt:{port:177},pr:{port:178},qa:{port:179},re:{port:180},ro:{port:181},ru:{port:182},rw:{port:183},bl:{port:184},sh:{port:185},kn:{port:186},lc:{port:187},mf:{port:188},pm:{port:189},vc:{port:190},ws:{port:191},sm:{port:192},st:{port:193},sa:{port:194},sn:{port:195},rs:{port:196},sc:{port:197},sl:{port:198},sg:{port:199},sx:{port:200},sk:{port:201},si:{port:202},sb:{port:203},so:{port:204},za:{port:205},gs:{port:206},ss:{port:207},es:{port:208},lk:{port:209},sd:{port:210},sr:{port:211},sj:{port:212},sz:{port:213},se:{port:214},ch:{port:215},sy:{port:216},tw:{port:217},tj:{port:218},tz:{port:219},th:{port:220},tl:{port:221},tg:{port:222},tk:{port:223},to:{port:224},tt:{port:225},tn:{port:226},tr:{port:227},tm:{port:228},tc:{port:229},tv:{port:230},ug:{port:231},ua:{port:232},ae:{port:233},gb:{port:234},us:{port:235},um:{port:236},uy:{port:237},uz:{port:238},vu:{port:239},ve:{port:240},vn:{port:241},vg:{port:242},vi:{port:243},wf:{port:244},eh:{port:245},ye:{port:246},zm:{port:247},zw:{port:248}};E.init=function(){var pc=E.proxy_countries={bext:[]};for(var key in E.ports)pc.bext.push(key.toUpperCase());var no_flag=zutil.bool_lookup("AX BL BQ BV IO CX CC CW FK "+"GF TF HM YT NU NF MP PN SH MF PM "+"SX GS SS SJ TK UM WF ZW GP RE AQ");E.proxy_countries.bext=E.proxy_countries.bext.filter((function(c){return!no_flag[c]}))};E.init();return E}.apply(exports,__WEBPACK_AMD_DEFINE_ARRAY__),__WEBPACK_AMD_DEFINE_RESULT__!==undefined&&(module.exports=__WEBPACK_AMD_DEFINE_RESULT__))})()},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);var _util_storage_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(21);var _util_storage_js__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(_util_storage_js__WEBPACK_IMPORTED_MODULE_0__);var _util_util_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(10);var _util_util_js__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(_util_util_js__WEBPACK_IMPORTED_MODULE_1__);
// LICENSE_CODE ZON
const E={};let status_cb,no_log_for_plus,no_log_for_uid={};let allowed_perrs={be_install:true,be_update:true};let cached=_util_storage_js__WEBPACK_IMPORTED_MODULE_0___default.a.get_json("no_log")||{};let enabled=cached.enabled;let is_plus=cached.is_plus;let uuid=cached.uuid;const invalidate=()=>{let no_log=!!(uuid&&uuid in no_log_for_uid?no_log_for_uid[uuid]:is_plus&&no_log_for_plus);if(enabled!==no_log){enabled=no_log;if(status_cb)status_cb(enabled)}_util_storage_js__WEBPACK_IMPORTED_MODULE_0___default.a.set_json("no_log",{enabled:enabled,is_plus:is_plus,uuid:uuid})};E.set_plus=_is_plus=>{if(_is_plus===undefined||_is_plus===is_plus)return;is_plus=_is_plus;invalidate()};E.set_config=conf=>{no_log_for_plus=conf.no_log_for_plus;no_log_for_uid=conf.no_log_for_uid||{};allowed_perrs=_util_util_js__WEBPACK_IMPORTED_MODULE_1___default.a.bool_lookup(conf.no_log_perrs||[]);invalidate()};E.set_uuid=_uuid=>{if(_uuid===undefined||_uuid===uuid)return;uuid=_uuid;invalidate()};E.set_status_cb=cb=>{status_cb=cb;cb(enabled)};E.enabled=perr_id=>enabled&&!(perr_id&&allowed_perrs[perr_id]);__webpack_exports__["default"]=E},function(module){module.exports=JSON.parse('{"CONFIG_MAKEFLAGS":"DIST=APP RELEASE=y AUTO_SIGN=y CONFIG_BATREQ=y CONFIG_BAT_CYCLE=y CONFIG_BAT_PLATFORM=app_win64r","CONFIG_LUM":false,"ARCH_CPU":"X86","BUILDTYPE_DEBUG":false,"_RELEASE":true,"_RELEASE_LEVEL":2,"CONFIG_BUILD_DATE":"07-May-20 08:17:23","ZON_VERSION":"1.168.667","ZON_VERSION_1":1,"ZON_VERSION_2":168,"ZON_VERSION_3":667,"ZON_COPYRIGHT_YEAR":"2020","UI_EXE":"hola.exe","SVC_EXE":"hola_svc.exe","SVC_EXE_ANDROID":"libhola_svc.so","UPDATER_EXE":"hola_updater.exe","NET_SVC_EXE":"net_svc.exe","NET_SVC_ZIP":"net_svc-x64-1.168.667.zip","NET_SVC_ZIP_PDB":"net_svc-x64-1.168.667-pdb.zip","SVC_AGENTS_POOL":"192.241.230.135:22224:zagent812,167.71.174.172:22224:zagent613,167.172.115.135:22224:zagent687,67.205.129.168:22224:zagent586,144.172.65.19:22224:zagent2055","BEXT_CHROME_ID_REL":"pnknnijoleibcpmkdcooclmnjmmdhgbg","BEXT_CHROME_CWS_ID_REL":"gkojfkhlekighikafcpjkiklfbnlmeio","BEXT_OPERA_ADDONS_ID_REL":"ekmmelpnmfdegjhnmadddcfjcahpajnm","BEXT_EDGE_ID_REL":"nfjgmgjhcihmkobljembcfodkajehoej","BEXT_FF_ID_REL_SIGNED":"ff_ext@hola.org","BEXT_FF_ORIGIN_SIGNED":"resource://ff_ext-at-hola-dot-org","BEXT_FF_ID_REL":"jid1-4P0kohSJxU1qGg@jetpack","BEXT_FF_ORIGIN":"resource://jid1-4p0kohsjxu1qgg-at-jetpack","CONFIG_MP_CHROME":false,"CONFIG_MP_OPERA":true,"BEXT":1,"BEXT_VA_CHROME_ID_REL":"chgpmaaockmdehmidghebcjafhihlgha","HOLA_ADBLOCK_ID_REL":"lalfpjdbhpmnhfofkckdpkljeilmogfl"}')},,,,,,,,,,,,,,function(module,exports,__webpack_require__){var __WEBPACK_AMD_DEFINE_ARRAY__,__WEBPACK_AMD_DEFINE_RESULT__;var module;
// LICENSE_CODE ZON ISC
"use strict";(function(){var hash,assert,zerr,vm;var is_node=typeof module=="object"&&module.exports&&module.children;var is_rn=typeof global=="object"&&!!global.nativeRequire||typeof navigator=="object"&&navigator.product=="ReactNative";if(!is_node){if(is_rn){}else;assert=function(){};if(!is_rn&&self.hola&&self.hola.zerr)zerr=self.hola.zerr;else{zerr=function(){console.log.apply(console,arguments)};zerr.perr=zerr}}else{require("./config.js");zerr=require("./zerr.js");hash=require("crypto");assert=require("assert");vm=require("vm")}!(__WEBPACK_AMD_DEFINE_ARRAY__=[__webpack_require__(10)],__WEBPACK_AMD_DEFINE_RESULT__=function(zutil){var E={};var has_map=typeof Map=="function"&&Map.prototype.get&&Map.prototype.set;has_map=0;E.cache_str_map_fn=function(fn){var cache=new Map;return function(s){s=""+s;var v=cache.get(s);if(v!==undefined||cache.has(s))return v;cache.set(s,v=fn(s));return v}};E.cache_str_obj_fn=function(fn){var cache={};return function(s){if(s in cache)return cache[s];return cache[s]=fn(s)}};E.cache_str_fn=has_map?E.cache_str_map_fn:E.cache_str_obj_fn;E.cache_str_fn2=function(fn){var cache={};return function(s1,s2){var cache2=cache[s1]=cache[s1]||{};if(s2 in cache2)return cache2[s2];return cache2[s2]=fn(s1,s2)}};E.o=function(oct_str){return parseInt(oct_str,8)};E.md5=function(buf,hash_len,encoding){return hash.createHash("md5").update(buf,encoding||"utf8").digest("hex").slice(0,hash_len)};E.md5_zero=function(key,hash_len){assert(hash_len<=32,"invalid hash len"+hash_len);if(!key||!key.length)return"0".repeat(hash_len);return E.md5(key,hash_len)};E.md5_etag=function(buf){return E.md5(buf,8)};E.inet_ntoa_t=function(ip){return((ip&4278190080)>>>24)+"."+((ip&16711680)>>>16)+"."+((ip&65280)>>>8)+"."+(ip&255)};E.inet_addr=function(ip){var code,res=0,shift=24,num=undefined;ip=""+ip;for(var i=0,l=ip.length;i<l;++i){code=ip.charCodeAt(i);if(code>47&&code<58){num=(num||0)*10+code-48;continue}if(code==46){if(num==undefined||num>255)return null;res+=num<<shift;num=undefined;shift-=8;continue}return null}return shift==0&&num!=undefined&&num<256?res+(num|0)>>>0:null};function flags_to_str_once(flags,conv){var f='var s = "";\n';f+='if (!flags) return "";\n';for(var i in conv){if(!conv.hasOwnProperty(i))continue;f+="if (flags & "+conv[i]+") "+"{ s += "+JSON.stringify(i.toLowerCase())+'+" ";'+" flags &= ~"+conv[i]+"; }\n"}f+="if (flags && conv.__conv_to_str.err) "+"conv.__conv_to_str.err(flags, conv);\n";f+="return s.slice(0, -1);\n";var func=new Function(["flags","conv"],f);Object.defineProperty(conv,"__conv_to_str",{enumerable:false,writable:true});conv.__conv_to_str=func;func.err=function(_flags,_conv){zerr.perr("flags_str_invalid","flags "+_flags+" "+JSON.stringify(_conv).slice(0,30))};return conv.__conv_to_str(flags,conv)}E.flags_to_str=function(flags,conv){if(conv.__conv_to_str)return conv.__conv_to_str(flags,conv);return flags_to_str_once(flags,conv)};function flags_from_str_once(s,conv){var f="var flags = 0, a, i;\n";f+="if (!s) return 0;\n";f+="s = s.toUpperCase();\n";f+='a = s.split(",");\n';f+="for (i=0; i<a.length; i++)\n";f+="{\n";f+="    if (!conv[a[i]])\n";f+="    {\n";f+="        if (flags && conv.__conv_from_str.err) "+"conv.__conv_from_str.err(flags, conv);\n";f+="        return -1;\n";f+="    }\n";f+="    flags |= conv[a[i]];\n";f+="}\n";f+="return flags;\n";var func=new Function(["s","conv"],f);Object.defineProperty(conv,"__conv_from_str",{enumerable:false,writable:true});conv.__conv_from_str=func;func.err=function(_s,_conv){zerr.perr("flags_str_invalid","flags "+_s+" "+JSON.stringify(_conv).slice(0,30))};return conv.__conv_from_str(s,conv)}E.flags_from_str=function(s,conv){if(conv.__conv_from_str)return conv.__conv_from_str(s,conv);return flags_from_str_once(s,conv)};E.scale_vals={1e3:[{s:"",n:1},{s:"K",n:1e3},{s:"M",n:1e6},{s:"G",n:1e9},{s:"T",n:1e12},{s:"P",n:1e15}],1024:[{s:"",n:1},{s:"K",n:1024},{s:"M",n:Math.pow(1024,2)},{s:"G",n:Math.pow(1024,3)},{s:"T",n:Math.pow(1024,4)},{s:"P",n:Math.pow(1024,5)}]};function apply_scale(num,opt){opt=opt||{};var per=opt.per,scale=opt.scale;var base=opt.base==1024?1024:1e3,ratio=opt.ratio||1;var scale_vals=E.scale_vals[base],i=0;if(num<0)num=-num;if(scale==null)for(;i<scale_vals.length-1&&num>=scale_vals[i+1].n*ratio;i++);else i=scale_vals.findIndex((function(_scale){return _scale.s==scale}));if(per=="ms"&&i){per="s";i--;num=num/1e3}return{num:num,per:per,base:base,scale:scale_vals[i]}}E.get_unit=function(num,opt){var res=apply_scale(num,opt);return res.scale.s+(res.per?E.fmt_per(res.per):"")};E.scaled_number=function(num,opt){opt=opt||{};var sign="";var unit=opt.unit===undefined||opt.unit;if(num<0){sign="-";num=-num}if(num===undefined)return"";if(isNaN(num))return opt.nan||"x";if(num==Infinity)return sign+"";var res=apply_scale(num,opt);var _per=unit&&res.per?E.fmt_per(res.per):"";num=res.num;if(opt.is_scale)return res.scale.n;num/=res.scale.n;if(num<.001)return"0"+_per;if(num>=res.base-1)num=Math.trunc(num);var str=num.toFixed(num<1?3:num<10?2:num<100?1:0);return sign+str.replace(/((\.\d*[1-9])|\.)0*$/,"$2")+(unit?(opt.space?" ":"")+res.scale.s:"")+_per};E.scaled_bytes=function(num,opt){return E.scaled_number(num,Object.assign({base:1e3},opt))};E.fmt_currency=function(amount,digits,currency_sign){if(amount===undefined)return;if(digits===undefined)digits=2;if(currency_sign===undefined)currency_sign="$";var sign=amount<0?"-":"";amount=Math.abs(amount);amount=(+amount).toLocaleString("en-GB",{useGrouping:true,maximumFractionDigits:digits})||amount;return sign+currency_sign+amount};E.fmt_per=function(per){if(!per)return"";switch(per){case"s":case"ms":return per;case"%":case"%%":return"%";default:return"/"+per[0]}};E.parse_function=function(f){var m=/^function\s*([\w$]+)?\s*\(\n?([\s\w$,]*?)(\s*\/\*`*\*\/)?\)\s*\{\n?([\s\S]*?)\n?\}$/.exec(f);return{name:m[1]||null,args:m[2]?m[2].split(/\s*,\s*/):[],body:m[4]}};function date_stringify(d){return{__ISODate__:d.toISOString()}}var pos_inf={__Infinity__:1};var neg_inf={__Infinity__:-1};function replace_inf(k,v){switch(v){case Infinity:return pos_inf;case-Infinity:return neg_inf;default:return v}}E.JSON_stringify=function(obj,opt){var s,prev_date,_date,prev_func,prev_re;var date_class,func_class,re_class;opt=opt||{};if(opt.date)_date=typeof opt.date=="function"?opt.date:date_stringify;if(opt.mongo)_date=date_stringify;if(_date){date_class=opt.vm_context?vm.runInContext("Date",opt.vm_context):Date;prev_date=date_class.prototype.toJSON;date_class.prototype.toJSON=function(){return _date(this)}}if(opt.func){func_class=opt.vm_context?vm.runInContext("Function",opt.vm_context):Function;prev_func=func_class.prototype.toJSON;func_class.prototype.toJSON=function(){return{__Function__:this.toString()}}}if(opt.re){re_class=opt.vm_context?vm.runInContext("RegExp",opt.vm_context):RegExp;prev_re=re_class.prototype.toJSON;Object.defineProperty(re_class.prototype,"toJSON",{value:function(){return{__RegExp__:this.toString()}},writable:true})}var opt_replacer=opt.replacer;var replacer=opt_replacer;if(opt.inf){if(opt_replacer&&typeof opt_replacer=="function"){replacer=function(k,v){if(this==pos_inf||this==neg_inf)return v;return opt_replacer.call(this,k,replace_inf.call(this,k,v))}}else if(opt_replacer&&Array.isArray(opt_replacer)){replacer=function(k,v){if(v==obj||this==pos_inf||this==neg_inf)return v;if(opt_replacer.includes(k))return replace_inf.call(this,k,v)}}else replacer=replace_inf}try{s=JSON.stringify(obj,replacer,opt.spaces)}finally{if(_date)date_class.prototype.toJSON=prev_date;if(opt.func)func_class.prototype.toJSON=prev_func;if(opt.re)re_class.prototype.toJSON=prev_re}if(opt.mongo)s=s.replace(/\{"__ISODate__":("[0-9TZ:.-]+")\}/g,"ISODate($1)");return s};function parse_leaf(v,opt){if(!v||typeof v!="object"||Object.keys(v).length!=1)return v;if(v.__ISODate__&&opt.date)return new Date(v.__ISODate__);if(v.__Function__&&opt.func){if(vm)return vm.runInThisContext('"use strict";('+v.__Function__+")");return new Function("",'"use strict";return ('+v.__Function__+");")()}if(v.__RegExp__&&opt.re){var parsed=/^\/(.*)\/(\w*)$/.exec(v.__RegExp__);if(!parsed)throw new Error("failed parsing regexp");return new RegExp(parsed[1],parsed[2])}if(v.__Infinity__&&opt.inf)return v.__Infinity__<0?-Infinity:Infinity;if(v.__ObjectId__&&typeof opt.object_id=="function")return opt.object_id(v.__ObjectId__);return v}function parse_obj(v,opt){if(!v||typeof v!="object")return v;if(Array.isArray(v)){for(var i=0;i<v.length;i++)v[i]=parse_obj(v[i],opt);return v}var v2=parse_leaf(v,opt);if(v2!==v)return v2;for(var key in v)v[key]=parse_obj(v[key],opt);return v}E.JSON_parse=function(s,opt){opt=Object.assign({date:true,re:true,inf:true},opt,{func:false});return JSON.parse(s,(function(k,v){return parse_leaf(v,opt)}))};E.JSON_parse_obj=function(v,opt){opt=Object.assign({date:true,re:true,inf:true},opt,{func:false});return parse_obj(v,opt)};E.JSON_parse_unsafe=function(s,opt){opt=Object.assign({date:true,re:true,func:true,inf:true},opt);return JSON.parse(s,(function(k,v){return parse_leaf(v,opt)}))};E.JSON_parse_obj_unsafe=function(v,opt){opt=Object.assign({date:true,re:true,func:true,inf:true},opt);return parse_obj(v,opt)};E.hex2bin=function(hex,opt){var byte_array=opt&&opt.byte_array;var bin=byte_array?new Uint8Array:[];var re=/('.)|([0-9a-f][0-9a-f]?)|\s+|[.-]|(.)/gi;var m,v;for(re.lastIndex=0;m=re.exec(hex);){if(m[1])v=m[1].charCodeAt(1);else if(m[2])v=parseInt(m[2],16);else if(m[3])return null;else continue;bin.push(v)}return bin};E.bin2hex=function(arr){var s="",v,i;for(i=0;i<arr.length;i++){v=(arr[i]&255).toString(16).toUpperCase();s+=(v.length<2?"0":"")+v+" "}return s.trim()};E.str2bin=function(s,offset){var len;if(!s||!(len=s.length))return;offset=offset||0;var arr=new Uint8Array(len-offset);for(var i=offset,j=0;i<len;i++,j++)arr[j]=s.charCodeAt(i);return arr};E.tab2sp=function(line){var added=0;return line.replace(/\t/g,(function(m,offset,str){var insert=8-(added+offset)%8;added+=insert-1;return" ".repeat(insert)}))};E.str2utf8bin=function(s){if(!s||!s.length)return;var arr=new Uint8Array(s.length*3);var len=s.length,i=0,j=0,c,extra;while(i<len){c=s.charCodeAt(i++);if(c>=55296&&c<=56319&&i<len){extra=s.charCodeAt(i++);if((extra&64512)==56320)c=((c&1023)<<10)+(extra&1023)+65536;else i--}if((c&4294967168)==0)arr[j++]=c;else{if((c&4294965248)==0)arr[j++]=c>>6&31|192;else if((c&4294901760)==0){arr[j++]=c>>12&15|224;arr[j++]=c>>6&63|128}else if((c&4292870144)==0){arr[j++]=c>>18&7|240;arr[j++]=c>>12&63|128;arr[j++]=c>>6&63|128}arr[j++]=c&63|128}}return arr.slice(0,j)};E.utf8bin2str=function(arr,offset,len){if(arr.byteLength&&!arr.length)arr=new Uint8Array(arr);var out="",i=offset||0,cp;var c,char2,char3,char4;len=len?i+len:arr.length;while(i<len){c=arr[i++];switch(c>>4){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:out+=String.fromCharCode(c);break;case 12:case 13:char2=arr[i++];out+=String.fromCharCode((c&31)<<6|char2&63);break;case 14:char2=arr[i++];char3=arr[i++];out+=String.fromCharCode((c&15)<<12|(char2&63)<<6|(char3&63)<<0);break;case 15:char2=arr[i++];char3=arr[i++];char4=arr[i++];cp=(c&3)<<18|(char2&63)<<12|(char3&63)<<6|char4&63;cp-=65536;out+=String.fromCharCode(55296|cp>>10);out+=String.fromCharCode(56320|cp&1023);break}}return out};return E}.apply(exports,__WEBPACK_AMD_DEFINE_ARRAY__),__WEBPACK_AMD_DEFINE_RESULT__!==undefined&&(module.exports=__WEBPACK_AMD_DEFINE_RESULT__))})()},,,,,,,,,,,,,function(module,exports,__webpack_require__){"use strict";var __WEBPACK_AMD_DEFINE_ARRAY__,__WEBPACK_AMD_DEFINE_RESULT__;// LICENSE_CODE ZON
!(__WEBPACK_AMD_DEFINE_ARRAY__=[__webpack_require__(15),__webpack_require__(17),__webpack_require__(13),__webpack_require__(12),__webpack_require__(26)],__WEBPACK_AMD_DEFINE_RESULT__=function(_,be_backbone,be_vpn_util,zerr,array){const E=be_backbone.model.extend({model_name:"msg",_defaults:function(){this.id=1;this.unique=Math.random();this.queue={};this.listeners={};this.connections={};this.tab_connections={};this.on("destroy",(function(){this.uninit()}))},unique_id:function(){return this.unique+"_"+this.id++},init:function(transport,opt){if(this.inited)return;this.inited=true;this.opt=opt||{};this.context=this.opt.context;this.transport=transport;this._on_msg=this.on_msg.bind(this);this.transport.add_listener(this._on_msg);if(!this.transport.add_connection_listener||!be_vpn_util.is_bg())return;this._on_connection=this.on_connection.bind(this);this.transport.add_connection_listener(this._on_connection)},uninit:function(){if(!this.inited)return;this.transport.remove_listener(this._on_msg);if(this._on_connection)this.transport.remove_connection_listener(this._on_connection);_.each(this.connections,(function(port){port.disconnect()}));this.inited=false},disconnect:function(tid,cid){var cids=cid?[cid]:(this.tab_connections[tid]||[]).slice();cids.forEach((function(_cid){this.connections[_cid].disconnect();this._after_disconnect(_cid,tid)}),this)},send:function(msg,cb,ms){var j={id:this.unique_id(),msg:msg,cb:cb};this.queue[j.id]=j;if(ms)j.timer=be_vpn_util.set_timeout(()=>this.cancel_send(j.id),ms);this.transport.send({type:"be_msg_req",id:j.id,msg:msg,context:this.context})},resp:function(j,ret){this.transport.send({type:"be_msg_resp",id:j.id,ret:ret,_tab_id:j._tab_id,_connection_id:j._connection_id,context:j.context})},cancel_send:function(id){var j=this.queue[id];if(!j)return;j.timer=be_vpn_util.clear_timeout(j.timer);if(j.cb)j.cb({error:"cancel_send"});delete this.queue[id]},add_listener:function(msg,cb){be_vpn_util.assert(!cb.__listener_id,new Error("listener_id "+cb.__listener_id+" already exists"));cb.__listener_id=this.unique_id();var j={id:cb.__listener_id,msg:msg,cb:cb};this.listeners[j.id]=j;this.transport.send({type:"be_msg_add_listener",id:j.id,msg:msg,context:this.context})},del_listener:function(msg,cb){const id=cb.__listener_id;be_vpn_util.assert(id,new Error("no listener id"));delete this.listeners[id];delete cb.__listener_id;this.transport.send({type:"be_msg_del_listener",id:id,msg:msg,context:this.context})},send_event:function(j,args){this.transport.send({type:"be_msg_event",id:j.id,args:args,_tab_id:j._tab_id,_connection_id:j._connection_id,context:j.context})},send_backbone_event:function(j,info){this.transport.send({type:"be_msg_backbone_event",info:info,_tab_id:j._tab_id,_connection_id:j._connection_id,context:j.context})},on_connection:function(port){var _this=this,connection_id=port.name;var tab_id=port.sender.tab&&port.sender.tab.id;this.add_connection(port,connection_id,tab_id);if(this.on_connect)this.on_connect(connection_id);port.onDisconnect.addListener((function(){_this._after_disconnect(connection_id,tab_id)}))},on_msg:function(msg){var j;if(!this.transport.is_valid(msg))return;var data=this.transport.get_data(msg);if(!data)return;switch(data.type){case"be_msg_req":if(!this.on_req)return;return this.on_req(data);case"be_msg_resp":j=this.queue[data.id];if(!j)return;j.timer=be_vpn_util.clear_timeout(j.timer);if(j.cb)j.cb(data.ret);delete this.queue[data.id];return;case"be_msg_add_listener":if(!this.on_add_listener)return;return this.on_add_listener(data);case"be_msg_del_listener":if(this.on_del_listener)return;return this.on_del_listener(data);case"be_msg_event":j=this.listeners[data.id];if(!j)return;j.cb.apply(null,data.args);return;case"be_msg_backbone_event":if(!this.on_backbone_event)return;return this.on_backbone_event(data.info);case"be_msg_connect":var _this=this;var port={name:data._connection_id,sender:{tab:{id:data._tab_id}},disconnect:()=>{_this.send({msg:"call_api",obj:"firefox",sub:"workers",func:"disconnect",args:[data._connection_id]})}};this.add_connection(port,data._connection_id,data._tab_id);if(this.on_connect)this.on_connect(data._connection_id);return;case"be_msg_disconnect":_this._after_disconnect(data._connection_id,data._tab_id);return}},add_connection:function(port,cid,tid){zerr.info("accepted connection "+cid+" from tab "+tid);if(!cid)return zerr("add_connection without connection_id");if(this.connections[cid])return zerr("connection "+cid+" already exists");this.connections[cid]=port;if(!tid)return zerr.notice("not a tab connection: "+cid);this.tab_connections[tid]=this.tab_connections[tid]||[];this.tab_connections[tid].push(cid)},del_connection:function(cid,tid){zerr.info("connection "+cid+" from tab "+tid+" disconnected");if(!cid)return zerr("del_connection without connection_id");if(!this.connections[cid])return zerr("no connection with id: "+cid);delete this.connections[cid];if(!tid)return zerr.notice("not a tab connection: "+cid);var tab_conn=this.tab_connections[tid];if(!tab_conn||!tab_conn.includes(cid))return zerr("no connection "+cid+" for tab "+tid);array.rm_elm(tab_conn,cid);if(!tab_conn.length)delete this.tab_connections[tid]},_after_disconnect:function(cid,tid){this.del_connection(cid,tid);if(this.on_disconnect)this.on_disconnect(cid)}});return E}.apply(exports,__WEBPACK_AMD_DEFINE_ARRAY__),__WEBPACK_AMD_DEFINE_RESULT__!==undefined&&(module.exports=__WEBPACK_AMD_DEFINE_RESULT__))},function(module,exports,__webpack_require__){"use strict";var __WEBPACK_AMD_DEFINE_ARRAY__,__WEBPACK_AMD_DEFINE_RESULT__;// LICENSE_CODE ZON
!(__WEBPACK_AMD_DEFINE_ARRAY__=[__webpack_require__(15),__webpack_require__(11),__webpack_require__(17),__webpack_require__(12),__webpack_require__(10),__webpack_require__(47),__webpack_require__(24),__webpack_require__(13)],__WEBPACK_AMD_DEFINE_RESULT__=function(_,etask,be_backbone,zerr,zutil,user_agent,conf,be_vpn_util){const chrome=!be_vpn_util.is_tpopup()&&window.chrome;const noop=()=>{};const E=new(be_backbone.model.extend({model_name:"chrome",_defaults:function(){this.on("destroy",(function(){E.uninit()}))}}));E.init=msg=>{if(E.inited||!be_vpn_util.is_bg())return;E.inited=true;E.listeners={"":{}};E.msg=msg;E.msg.on_req=on_req;E.msg.on_add_listener=on_add_listener;E.msg.on_del_listener=on_del_listener;E.msg.on_connect=on_connect;E.msg.on_disconnect=on_disconnect};E.uninit=()=>{if(!E.inited)return;E.msg.on_req=undefined;E.msg.on_add_listener=undefined;E.msg.on_del_listener=undefined;E.msg.on_connect=undefined;E.msg.on_disconnect=undefined};function on_req(j){var req=j.msg;switch(req.msg){case"call_api":var cb=!req.has_cb?null:function(){E.msg.resp(j,{args:_.toArray(arguments),last_error:!chrome?0:chrome.runtime.lastError})};E.impl.call_api(req.obj,req.sub,req.func,req.args,cb,j);if(!req.has_cb&&!req.skip_resp)E.msg.resp(j,{args:[]});break}}function on_add_listener(j){var req=j.msg,id=j.id,cid=j._connection_id||"";var cb=function(){E.msg.send_event(j,_.toArray(arguments))};cb.__j=j;var l=E.listeners[cid];if(!l)return zerr("add: listeners for "+cid+" not inited");zerr.assert(!l[id],"add: listener "+id+" already exists");l[id]=cb;E.impl.add_listener(req.obj,req.sub,cb)}function on_del_listener(j){var req=j.msg,id=j.id,cid=j._connection_id||"";var l=E.listeners[cid];if(!l)return zerr("del: listeners for "+cid+" not inited");var cb=l[id];zerr.assert(cb,"del: listener "+id+" not found");E.impl.del_listener(req.obj,req.sub,cb);delete l[id]}function on_connect(cid){if(E.listeners[cid])return zerr("connect: listeners for "+cid+" already inited");E.listeners[cid]={}}function on_disconnect(cid){var l=E.listeners[cid];if(!l)return zerr("disc: listeners for "+cid+" not inited");_.each(zutil.clone(l),(function(e,i){var t;if(t=e.__j)on_del_listener(t);else if(t=e.__backbone)del_backbone_listener(t.id,cid,t.backbone_client_id)}));zerr.assert(_.isEmpty(l),"listeners not empty");delete E.listeners[cid]}function del_backbone_listener(id,connection_id,backbone_client_id){var o=get_backbone_obj(id);var l=E.listeners[connection_id];if(!l){return zerr("del_backbone: listeners for "+connection_id+" not inited")}var cb=l[backbone_client_id];delete l[backbone_client_id];if(!o)return;E.stopListening(o,"all",cb)}function join_dot(obj,sub,func){return _.compact(arguments).join(".")}function get_obj(root,obj,sub){let a=obj.split(".").concat(sub||[]),o=root,i;for(i=0;i<a.length&&o;i++)o=o[a[i]];return i<a.length?null:o}function get_backbone_obj(id){var main=window.be_bg_main;return main&&main.be_browser.backbone.server.obj[id]}function perr(id,info,opt,new_name){let perr_func=zutil.get(window,"be_bg_main.be_util.perr");if(perr_func)return perr_func(id,info,opt,new_name);zerr("perr "+id+" "+(info?info:"")+(opt.err?"\n"+zerr.e2s(opt.err):""))}let sent;function _perr(obj,sub,func,args,err){if(sent)return console.error("skip be_msg_err %s",err);var err_info=err?err.hola_info:undefined;perr("be_msg_err",{method:join_dot(obj,sub,func),args:args,err_info:err_info},{err:err});sent=true}E.impl={};E.impl.init=function(){if(this.inited)return;this.inited=true;if(!chrome)return;this.id=chrome.runtime.id;this.url=chrome.runtime.getURL("").slice(0,-1);this.manifest=chrome.runtime.getManifest()};E.impl["impl.init"]=chrome&&function(args,cb){this.init();if(cb)cb({id:this.id,url:this.url,manifest:this.manifest})};E.impl["tpopup.set_dont_show_again"]=function(args){if(!window.be_bg_main||!window.be_bg_main.be_info)return zerr("no be_bg_main or be_info");window.be_bg_main.be_info.set_dont_show_again(args[0])};E.impl["tpopup.send_tpopup_msg"]=function(args){chrome.tabs.sendMessage(args[0],args[1])};E.impl["tpopup.trigger"]=function(args){if(!window.be_bg_main||!window.be_bg_main.be_tpopup)return;window.be_bg_main.be_tpopup.trigger(args[0],args[1])};E.impl["be_premium.login_popup_done"]=function(args){if(!window.be_bg_main||!window.be_bg_main.be_premium)return;window.be_bg_main.be_premium.login_popup_done()};E.impl["tpopup.perr"]=function(args){perr(args[1],args[2],args[3],true)};E.impl["backbone.server.connect"]=function(args,cb,j){cb=cb||noop;var id=args[0],o=get_backbone_obj(id),cid=j._connection_id||"";if(!o)return;var attr=o.attributes;var bcid=attr._backbone_client_id=_.uniqueId("bbl");var l=E.listeners[cid];if(!l)return zerr("connect: listeners for "+cid+" not inited");zerr.assert(!l[bcid],"backbone listener for"+bcid+" already exists");var _cb=l[bcid]=function(ename){var _args=[];if(ename.includes("change:"))_args=[o.get(ename.replace("change:",""))];else if(ename!="change")_args=[].slice.call(arguments,1);E.msg.send_backbone_event(j,{id:id,ename:ename,args:_args})};_cb.__backbone={id:id,backbone_client_id:bcid};E.listenTo(o,"all",_cb);cb({attributes:attr})};E.impl["backbone.server.disconnect"]=function(args,cb,j){del_backbone_listener(args[0],j._connection_id||"",args[1]);if(cb)cb({})};E.impl["backbone.server.ping"]=function(args,cb,j){cb=cb||noop;var id=args[0],o=get_backbone_obj(id);if(o)cb({})};E.impl.call_api=function(obj,sub,func,args,cb,j){try{var o;if(obj.startsWith("backbone.server.obj.")){cb=cb||noop;var id=obj.replace("backbone.server.obj.","");o=get_backbone_obj(id);if(!o)return;if(sub=="ecall"){return etask([function(){return o.ecall(func,args)},function(){cb.apply(null,arguments)},function catch$(err){cb({_error:""+err});_perr(obj,sub,func,args,err)}])}o[sub].call(o,func,args);cb({});return}var s=join_dot(obj,sub,func);if(_.isFunction(this[s])){if(zerr.is.info())zerr.info(s+"("+zerr.json(args).substr(0,100)+")");return void this[s].call(this,args,cb,j)}o=get_obj(chrome,obj,sub);if(!o||!o[func])return _perr(obj,sub,func,args,new Error("not found"));return o[func].apply(o,args.concat(cb||[]))}catch(e){_perr(obj,sub,func,args,e)}};E.impl.add_listener=function(obj,sub,cb,opt,extra){try{var s=join_dot(obj,sub,"add_listener");if(_.isFunction(this[s])){zerr.info(s+"()");return void this[s].call(this,cb,opt,extra)}var o=get_obj(chrome,obj,sub);if(!o||!o.addListener)return _perr(obj,sub,"add_listener",new Error("not found"));if(!opt)return o.addListener(cb);o.addListener(cb,opt,extra)}catch(e){_perr(obj,sub,"add_listener",{opt:opt,extra:extra},e)}};E.impl.del_listener=function(obj,sub,cb){try{var s=join_dot(obj,sub,"del_listener");if(_.isFunction(this[s])){zerr.info(s+"()");return void this[s].call(this,cb)}var o=get_obj(chrome,obj,sub);if(!o||!o.removeListener)return _perr(obj,sub,"del_listener");o.removeListener(cb)}catch(e){_perr(obj,sub,"del_listener",[],e)}};return E}.apply(exports,__WEBPACK_AMD_DEFINE_ARRAY__),__WEBPACK_AMD_DEFINE_RESULT__!==undefined&&(module.exports=__WEBPACK_AMD_DEFINE_RESULT__))},function(module,exports,__webpack_require__){"use strict";var __WEBPACK_AMD_DEFINE_ARRAY__,__WEBPACK_AMD_DEFINE_RESULT__;// LICENSE_CODE ZON
!(__WEBPACK_AMD_DEFINE_ARRAY__=[__webpack_require__(15),__webpack_require__(14)],__WEBPACK_AMD_DEFINE_RESULT__=function(_,be_util){const E={errors:0};function wrap_cb(cb){return function(){try{return cb.apply(this,arguments)}catch(err){E.errors++;E.last_error=err;if(E.errors==1){console.error("transport error %o",err);be_util.perr("be_transport_err",{},{err:err})}}}}E.chrome_tabs=chrome=>({add_connection_listener:wrap_cb(cb=>{if(chrome.runtime)chrome.runtime.onConnect.addListener(cb)}),remove_connection_listener:wrap_cb(cb=>{if(chrome.runtime)chrome.runtime.onConnect.removeListener(cb)}),add_listener:wrap_cb(cb=>{if(chrome.runtime)chrome.runtime.onMessage.addListener(cb)}),remove_listener:wrap_cb(cb=>{if(chrome.runtime)chrome.runtime.onMessage.removeListener(cb)}),send:wrap_cb(data=>{if(!data._tab_id)throw new Error("no _tab_id");data._type="tpopup";chrome.tabs.sendMessage(data._tab_id,data)}),get_data:e=>e,is_valid:e=>e&&e._tab_id&&e._type=="tpopup"||e._type=="login_done_popup"});E.tpopup=(chrome,tab_id)=>{const connection_id=tab_id+":tpopup_int:"+_.random(Number.MAX_SAFE_INTEGER);let port=chrome.runtime.connect({name:connection_id});port.onDisconnect.addListener((function uninit(){port.onDisconnect.removeListener(uninit);port=null}));return{add_listener:wrap_cb(cb=>{if(chrome.runtime)chrome.runtime.onMessage.addListener(cb)}),remove_listener:wrap_cb(cb=>{if(chrome.runtime)chrome.runtime.onMessage.removeListener(cb)}),send:wrap_cb(data=>{if(!port)return;data._type="tpopup";data._tab_id=tab_id;if(chrome.runtime)chrome.runtime.sendMessage(data)}),get_data:e=>e,is_valid:e=>e&&e._tab_id==tab_id&&e._type=="tpopup"}};return E}.apply(exports,__WEBPACK_AMD_DEFINE_ARRAY__),__WEBPACK_AMD_DEFINE_RESULT__!==undefined&&(module.exports=__WEBPACK_AMD_DEFINE_RESULT__))}]]);
//# sourceMappingURL=https://hola.org/be_source_map/1.168.667/3.js.map