i4e.prototype.$ra=W(1504,function(){return[]});i4e.prototype.Pra=W(1503,ea("Answers feedback"));oW.prototype.sL=W(1502,ea(10));KW.prototype.sL=W(1501,g("Sa"));MW.prototype.sL=W(1500,g("D"));P9e.prototype.sL=W(1499,ea(10));RYe.prototype.rda=W(1495,ea(null));i4e.prototype.rda=W(1494,g("F"));var hSf={1:eka,2:Xf},iSf={2:{1:[{1:[hSf],2:hSf}]}};function jSf(a,b){return L(a,1,b)}function kSf(a,b){L(a,2,b)}function lSf(a,b){D(a,1,b)}function mSf(a){var b=Ra();L(a,3,b)}
function nSf(a,b,c){var d=Yj(a.C,oT,1),e=new oT;L(e,1,b);L(e,2,c);L(e,4,0);mSf(e);d.push(e);zd(d,function(f,h){return(h.dj()||0)-(f.dj()||0)});wd(d,void 0,function(f){return K(f,1)+", "+f.mb()});bk(a.C,1,vd(d,0,a.R));$me(a)}function oSf(a){return a.D["ritz-ShouldDisplaySmartFillSurvey"]}function pSf(a,b){a.C.Ja=b}function qSf(a,b){a=a.C;a.Sa=b;null==a.Da||a.Sa.includes(a.Da)||UO(a)}function rSf(a){bo.call(this,a)}t(rSf,bo);rSf.prototype.hasType=function(){return this.message.hasType()};
rSf.prototype.getType=function(){return this.message.getType()};rSf.prototype.setType=function(a){return go(this,1,a)};rSf.prototype.clearType=function(){return eo(this,1)};function sSf(a){this.Hd=Mn(a,-1,0)}t(sSf,Qn);sSf.prototype.rf=function(){return new rSf(this)};sSf.prototype.hasType=function(){return Tn(this,1)};sSf.prototype.getType=function(){return Xn(this,1,0)};function tSf(a,b,c){vJ.call(this,156);this.kb=a;this.F=b;this.C=c}t(tSf,vJ);
tSf.prototype.Id=function(){var a=new qTb;this.C.forEach(function(b){var c=C(b,1),d=new Or;b=b.getValue();D(d,3,b);b=new Pr;var e=c.Bj();D(b,1,e);c=c.getColumnIndex();D(b,2,c);D(b,3,d);Xg(a,2,b)});lSf(a,no(this.F,this.kb.Jb()));return a};tSf.prototype.Bg=ea(!1);
function uSf(a,b){var c=a.D.sb(b);return new Up(function(d,e){Sl(Tl(Xq(Rl(er(fr(a.C.We("/smartFill/getSuggestion"),"POST")),1).setTimeout(3E4),["data",Rm(c)]),function(f){f=a.D.Ld(tS.getDescriptor(),f.Oe());1!=f.getStatus()&&e(f);d(f)}),function(){var f=new tS;D(f,1,2);e(f)}).Re()})}function vSf(a){A.call(this);this.D=a;this.C=oSf(this.D.F).getValue()}t(vSf,A);
function wSf(a){a.C&&oSf(a.D.F).getValue()?(lA.getInstance().postMessage(oA("Please take a quick 3 question survey about SmartFill","Take survey",function(){cf("https://google.qualtrics.com/jfe/form/SV_5pEvy5W5UY82FjT")},"promo",void 0,void 0)),a.C=!1,oSf(a.D.F).setValue(!1)):a.C=!1}function xSf(a){a.C&&eq(function(){return wSf(a)},6E4)}function ySf(a,b,c,d){this.C=a;this.H=b;this.D=c;this.J=d;this.F=0}ySf.prototype.sj=g("H");ySf.prototype.Ed=g("J");
ySf.prototype.equals=function(a){if(!a||this.C!=a.C)return!1;if(null!=this.Ed()){if(!a.Ed()||this.Ed().length!=a.Ed().length)return!1;for(var b=0;b<this.Ed().length;b++)if(!this.Ed()[b].equals(a.Ed()[b]))return!1;return!0}return this.sj()==a.sj()};function zSf(a){var b=DFd.getInstance(),c=a.rect;if(!c)return null;b=b.C[a.C];if(!b)return null;var d=b[c.left+c.width-1];if(!d)return null;d=d.D;return!d||a.rect.top<d.Bj()?null:b[c.left+c.width-1]||null}
function ASf(a,b){var c=DFd.getInstance(),d=a.rect;if(d){a=a.C;var e=c.C[a];if(e){d=d.left+d.width-1;var f=e[d]||null;ee(e,d);b&&f&&(b=c.D[a],b||(b={},c.D[a]=b),c=b[d],c||(c=[],b[d]=c),c.push(f))}}}function BSf(a,b){var c=b.rect;return c?(a=a.D[b.C])?a[c.left+c.width-1]||[]:[]:[]}function CSf(a,b){var c=DFd.getInstance();return!!id(BSf(c,a),function(d){return b.equals(d)})}function DSf(a){return z(y(),"femfs")&&Src(a.F.F)}function ESf(a){var b=a.F.C,c=b.C;return fsc(a.F)?cI(b,a.F.Qa):c}
function FSf(a){return(a=AJ(a.C))?a.H:null}function GSf(a){return a.D.isEnabled()||MI(a.D)}function j_(a,b,c,d,e,f){var h=az(new $y,22);c&&(c=1E3*((new Date).getTime()-c),c=zk(new yk,c),cz(az(h,41),c));c=new Q9d;d&&L(c,1,d);e&&Zj(c,2,e);f&&L(c,3,f);d=new Dk;d=Zj(d,31,c);dz(h,d);a.xa.C(b,ez(h))}
function HSf(a,b){if(DSf(a)&&Vg(b,1)){var c=(new Date).getTime();uSf(a.ZCa,b).then(function(d){var e=C(d,4);j_(a,36766,c,e);var f=C(d,2),h=$g(d,5);d=h&&0<h.length?new ySf(e,null,C(d,7),h):d.sj()?new ySf(e,d.sj(),C(d,7),null):null;h=oo(f);if(d&&!CSf(h,d)&&(f=DFd.getInstance(),e=h.rect)){h=h.C;var k=f.C[h];k||(k={},f.C[h]=k);k[e.left+e.width-1]=d}},function(d){var e=void 0;d instanceof tS&&Vg(d,6)&&(e=C(d,6));j_(a,36767,c,void 0,void 0,e)})}}
function ISf(a,b){b=b.D;b=tn(b.Bj(),b.getColumnIndex());a=jme(a,b,["S","W"]);return new qn(a.dc(),a.Uc()-1,a.Sc(),a.Uc())}function JSf(a){return(a=FSf(a))?a.Sa:null}function KSf(a,b){b=void 0===b?!1:b;var c=AJ(a.C);c&&(ritz_api.GridViewApi.removeSmartFillSuggestion(c.L.J),(a=JSf(a))&&a.Me(),b&&c.Oc())}
function LSf(a,b,c,d,e,f,h,k,l,n){A.call(this);this.F=a;this.C=b;this.O=c;this.xa=d;this.Za=e;this.ZCa=CFd.getInstance();this.H=new Gl;this.R=h;this.V=k;this.ma=n;(this.D=z(y(),"fess")?new vSf(this.F):null)&&this.qa(this.D);this.J=new Xo(this);this.qa(this.J);this.L=new Tz(this);this.qa(this.L);a=vG(this.O);this.J.listen(this.C,"inputBoxDeactivate",this.L5b).listen(this.C,"inputBoxActivate",this.K5b).listen(a,["oc","pc","qc","rc"],this.M5b).listen(a,["Sb","Tb","Ub"],this.wCb);DSf(this)&&(mCb.Pa(!0),
mCb.setVisible(!0),l.C(lCb,FFd).F(lCb,FFd).C(nCb,FFd).F(nCb,FFd));DSf(this)&&this.L.subscribe(lCb,"action",this.Gpb).subscribe(nCb,"action",this.CRa).subscribe(mCb,"action",this.N5b)}t(LSf,A);m=LSf.prototype;
m.L5b=function(a){if(a.ma){if(!DSf(this))return;a=(new Date).getTime();var b=ESf(this),c=AJ(this.C);if(b&&c){var d=FSf(this);if(d&&!d.H.L){var e=b.Ec();if(!GSf(e)){var f=e&&TH(e,$N(d).Xs);if(f&&0!=f.x){var h=new Ln(b.mb(),sn(f)),k=zSf(h);k&&3<=k.F&&ASf(h,!0);if((d=$N(d))&&d.getValue()&&0!=d.getValue().trim().length&&d.Pc!=d.getValue()&&(d=d.getValue(),!PE(d)||z(y(),"fesfs")&&ritz_api.RitzModelApi.hasValidSmartfillFunctions(d,b.mb(),f.y,f.x)))if(k)a=ritz_api.GridViewApi.getSmartFillSuggestionValueAt(c.L.J,
b.mb(),f.y,f.x),""!=d&&a&&d!=a&&!PE(d)&&this.CRa();else{c=DFd.getInstance();if(h=!(3<=BSf(c,h).length))a:{for(h=1;10>=h;h++)if(c=e,k=new Um(f.x,f.y+h),0>k.x||0>k.y?0:zI(vI(c,k),c.Jb(),k.y,k.x)){h=!1;break a}h=!0}if(h){b=ritz_api.RitzModelApi.getSmartFillRequestTriggerResult(b.mb(),f.y,f.x);b=Hl(b,iSf);b=this.H.Ld(AFd.getDescriptor(),b);a:switch(C(b,1)){case 3:j_(this,36754,a);a=!0;break a;case 4:j_(this,36755,a);a=z(y(),"fesfs");break a;case 2:j_(this,36757,a);a=!1;break a;default:j_(this,36756,a),
a=!1}a&&HSf(this,b.Qm())}}}}}}}KSf(this,!0)};
m.K5b=function(){var a=this;if(DSf(this)){var b=ESf(this),c=AJ(this.C);if(b&&c){var d=FSf(this);if(d&&!d.H.L&&$N(d)){var e=b.Ec();if(!GSf(e)){var f=e&&TH(e,$N(d).Xs);if(f)if(f=new Ln(b.mb(),sn(f)),(f=zSf(f))&&f.D){e=ISf(e,f);var h=new Ln(b.mb(),e);b=(new Date).getTime();if(f.sj()){var k=f.sj();var l=Il(this.H.sb(f.D),eka);k=this.R.getCalculatedSmartFillSuggestion(fUe(h).sb(),k.startsWith("=")?k:"="+k,l,c.Sc()+50)}else k=ritz_api.GridViewApi.getSmartFillSuggestionForValues(f.Ed().map(function(n){return Il(a.H.sb(n),hSf)}));
if(k){if(h=JSf(this))h.H=!0,h.D=d.O,h.D.V?h.F=null:h.F=h.D==d.C?d.L:null,pQc(h,!0);ritz_api.GridViewApi.updateSmartFillModel(c.L.J,k);c.Oc();f.F+=1;d=new O9d;kSf(jSf(d,e.Sc()-e.dc()),ritz_api.GridViewApi.getSmartFillSuggestionAvgCharCount(c.L.J));j_(this,36773,b,f.C,d);uJ("SmartFill suggestion shown. Preview added to cells in range {"+(gM(e)+"}"))}else KSf(this),ASf(h,!0)}else KSf(this,!0)}}}}};
m.Gpb=function(){var a=this;if(DSf(this)){var b=ESf(this),c=b.Ec();if(!GSf(c)){var d=c.F,e=new Ln(b.mb(),d),f=zSf(e);if(f){var h=ISf(c,f),k=void 0;if(b=AJ(this.C))k=ritz_api.GridViewApi.getSmartFillSuggestionAvgCharCount(b.L.J),dO(b,!1);var l,n=f.Ed();n?l=new tSf(c,h,f.Ed()):l=new Uvd(c,h,f.sj());wJ(l,function(q){if(q){KSf(a,!0);ASf(e,!1);q=new O9d;jSf(q,h.Sc()-h.dc());k&&kSf(q,k);j_(a,36777,void 0,f.C,q);if(q=AJ(a.C)){var r=5===f.C;SRc(q,n?r?"Cells filled using Domain Directory.":"Cells filled with public data.":
"Cells filled with a formula.","Send feedback",function(){(Ot(),Cv).qb({source:"smartfill"})})}a.D&&xSf(a.D)}});this.V.C(l)}}}};
m.CRa=function(){if(DSf(this)){var a=ESf(this),b=a.Ec();if(!GSf(b)){var c=b.F;a=new Ln(a.mb(),c);var d=zSf(a);if(d){b=jme(b,c,["N","S","W"]);c=new O9d;jSf(c,b.Sc()-b.dc());var e=AJ(this.C);e&&kSf(c,ritz_api.GridViewApi.getSmartFillSuggestionAvgCharCount(e.L.J));j_(this,36778,void 0,d.C,c);KSf(this,!0);ASf(a,!0);uJ("SmartFill suggestion rejected for range ("+(gM(b)+")."));this.D&&xSf(this.D)}}}};
m.N5b=function(){var a=ESf(this),b=a.Ec().F;a=new Ln(a.mb(),b);zSf(a)&&(a=JSf(this))&&a.H&&(a.La().focus(),this.ma.Db(2))};m.M5b=function(){var a=ESf(this);a&&(a=a.Ec(),GSf(a)&&KSf(this))};m.wCb=function(){DFd.getInstance().clear();KSf(this)};function MSf(a,b){var c=Tn(a,1)?ko(a):Number.MIN_VALUE;a=Tn(a,2)?Wn(a,2):Number.MAX_VALUE;var d=Tn(b,1)?ko(b):Number.MIN_VALUE;b=Tn(b,2)?Wn(b,2):Number.MAX_VALUE;return b>c&&a>d||c==d&&a==b}function NSf(a){return co(VCa(TCa(),a))}
function OSf(a,b,c){var d=a.Sc(),e=a.Uc();switch(b){case 0:d=Math.min(d,a.dc()+c);break;case 1:e=Math.min(e,a.Zb()+c)}return bUb(a.mb(),a.dc(),a.Zb(),d,e)}
function PSf(){return S('<div class="waffle-assistant-padded-card"><div class="waffle-assistant-answercard-content"><div class="waffle-assistant-answercard-interpret-content"><div class="waffle-assistant-answercard-interpret"></div></div><div class="waffle-assistant-answercard-answer-content"><div class="waffle-assistant-answercard-pivot-content"></div></div></div></div>')}
function QSf(a,b){return S(R(aA({cd:"waffle-assistant-insert-pivottable-button waffle-assistant-readonly-hidden",content:hx(""+R(yB({icon:"docs-icon-img docs-icon-insert-pivot-table"},b))),style:4},b))+'<div class="waffle-assistant-button-separator waffle-assistant-readonly-hidden"></div>'+R(aA({cd:"waffle-assistant-zoom-button",content:hx(""+R(yB({icon:"docs-icon-img docs-icon-zoom-in"},b))),style:4},b)))}
function RSf(a,b,c,d,e,f,h){cX.call(this,a,b,c,PR.getInstance(),"regular",e,f,h);this.Ra=d;this.R=new iz(null,new oR,this.oa());this.Ga(this.R);a=a.C;c=new bO(c,!0,!0);this.V=new R9e(a,new p5e(c),b);this.V.Ba=this.F;b=co(ho(kfc(hfc(),!0),12,mrb));this.Va=new P$e(b);this.D=this.xa=null;this.ma=[]}t(RSf,cX);m=RSf.prototype;m.Gc=function(a){cX.prototype.Gc.call(this,a);this.R.Wa(this.oa().eb("waffle-answers-button"))};
m.Ia=function(){cX.prototype.Ia.call(this);this.getHandler().listen(this.Ra,"selectionChange",this.zXb)};m.XWa=function(a){this.V.L=a;this.O.WE(a)};m.yY=function(){cX.prototype.yY.call(this);this.getHandler().listen(this.R,"action",this.Fqb);SSf(this)};m.uG=function(){var a=this.J;return mI(a.C)?VXe(a)?cX.prototype.uG.call(this):!1:!1};m.Pa=function(a){cX.prototype.Pa.call(this,a);lW(this.R.getElement(),a?"":this.Kca());this.R.Pa(a)};
m.QLa=function(){if(this.D){var a=jo(ritz_api.TablesApi.getTableGridRange(this.D));a=oG(a);return b3e(a,iI(this.J.C))}return null};m.ICa=function(){if(this.D){var a=jo(ritz_api.TablesApi.getTableGridRange(this.D));if(50>pG(a).height)return!1}a=hp("docs-titlebar-buttons");a=a.offsetWidth+Rw(a).right;return(Kw(this.H.getElement())?a:a+200)+700<=window.innerWidth};m.Kca=ea("Answers is unavailable, try using Explore");
m.eP=function(){cX.prototype.eP.call(this);var a=M$e(this),b=this.ICa();this.R.setVisible(!b&&a)};m.Fqb=function(){a2e(null,this.ma,null,this.F)};m.DSa=function(a){a2e(a,this.ma,null,this.F)};m.zXb=function(){TSf(this)&&SSf(this)};m.ava=function(){var a=cX.prototype.ava.call(this);a&&(this.D=null,TSf(this)&&SSf(this));return a};function TSf(a){a=a.J;return mI(a.C)&&qM(a)}
function SSf(a){if(a.uG()){var b=a.J.C,c=pI(b),d=yrd(c);if(0<d.length)b=jo(ritz_api.TablesApi.getTableGridRange(d[0])),a.D&&b.equals(jo(ritz_api.TablesApi.getTableGridRange(a.D)))||(a.D=d[0],a.H9());else if(null!=a.D){d=jo(ritz_api.TablesApi.getTableGridRange(a.D));b=d.mb()!=iI(b);var e=!1;if(!b){var f=dJ(c);c=ritz_api.TablesApi.getCurrentlyDetectedTables(nG(f,c.Jb()).sb());c=ja(c);for(f=c.next();!f.done;f=c.next())if(f=jo(ritz_api.TablesApi.getTableGridRange(f.value)),f==d||null!=f&&f.equals(d)){e=
!0;break}}if(b||!e)a.D=null,a.L.C(36726,N$e(a)),a.H9()}}else a.rC()}m.H9=function(){var a=this;this.rC();if(this.D){var b=jo(ritz_api.TablesApi.getTableGridRange(this.D)),c=[oG(b)];null!=this.xa&&this.xa.cancel();5E4<P1e(b)?this.L.C(36727,N$e(this)):(this.xa=Q$e(this.Va,c),this.xa.then(function(d){a.tb()&&USf(a,d.C)}).Ch(function(){a.rC()}))}};
function USf(a,b){a.ma=b;var c=null;b=ja(b);for(var d=b.next();!d.done;d=b.next())d=d.value,3==ah(d,1)&&(c=d);if(c&&.6<C(c,2)){a.L.C(36728,N$e(a));b=C(c,9)||new iJ;var e=ed($g(b,1),function(l){return l.getName()}),f=[],h=[];d=ja($g(b,2));for(var k=d.next();!k.done;k=d.next())k=k.value,f.push(k.getName()),h=h.concat($g(k,2));d=oo(BV(c));k=Vg(c,11)?C(c,11):null;c=null==k?null:oo(C(c,10));a.V.init(b,d,c,k,[],[]);a.V.HZ();a.V.IZ().then(function(l){var n=h;l=void 0===l?[]:l;(e.length||f.length||n.length||
l.length)&&a.Pa(!0);a.O.Y_(e,f,n);0<l.length&&(a.O.HO(l),z(y(),"feaipu")&&a.C&&a.C.D.setAttribute("placeholder","Try '"+(l[0].query+"'")));a.C&&H8e(a.C)})}b2e(a.ma,null,a.F)}m.rC=function(){cX.prototype.rC.call(this);this.ma=[];this.V.reset();b2e(null,null,this.F)};function VSf(a,b){hS.call(this,void 0,b,!1,!0);this.H=a;this.setTitle("Additional info");this.C.setVisible(!1)}t(VSf,hS);
VSf.prototype.Ca=function(){var a=this;hS.prototype.Ca.call(this);Dx(this.La(),"waffle-assistant-feedback-product-info-dialog");var b=Object.keys(this.H).map(function(c){var d=a.H[c];return Qe("DIV",void 0,[Qe("DT",void 0,c+":"),Qe("DD",void 0,String(d))])});Tx(this,Se(b))};function WSf(a){var b=a.wT,c=a.index,d=a.checked;return S(R(LR({cd:"waffle-assistant-feedback-dialog-radio-button",name:hx(""+R(a.name)),label:b,checked:d,value:c+1},void 0)))}
function XSf(){var a='<div class="'+T("waffle-assistant-feedback-dialog-legal")+'"><small><div class="'+T("waffle-assistant-feedback-dialog-legal-information-text")+'">';a=a+'We will use the information you give us to help address technical issues and to improve our services, subject to our  <a href="https://www.google.com/intl/en/policies/privacy/" target="_blank" class="uf-legal-link">Privacy Policy </a>   and  <a href="https://www.google.com/intl/en/policies/terms/" target="_blank" class="uf-legal-link">Terms of Service</a> .</div><div class="'+
(T("waffle-assistant-feedback-dialog-product-info-display-text")+'"><span tabindex="0" role="link">');return S(a+"What will be shared with Google?</span></div></small></div>")}function YSf(a,b){hS.call(this,void 0,b,!0,!0);this.R=a;this.L=a.bza();this.ma=a.$ra();this.H=this.V=this.O=null;this.setTitle(a.Pra());this.C.setContent("Submit")}t(YSf,hS);m=YSf.prototype;
m.Ca=function(){hS.prototype.Ca.call(this);Dx(this.La(),"waffle-assistant-feedback-dialog");var a=this.L.length,b=this.R.hsa();var c=this.ma;var d="";if(0<a){d+='<div class="'+T("waffle-assistant-feedback-dialog-header")+'">';d=d+'Recent suggestions</div><div class="'+(T("waffle-assistant-feedback-dialog-suggestions-radio-buttons-control")+'">');a=Math.max(0,Math.ceil(a));for(var e=0;e<a;e++){var f=e;d+=WSf({name:"waffle-assistant-feedback-dialog-suggestions-radio-buttons",wT:"",checked:f==b,index:f})}d+=
"</div>"}d+='<div class="'+T("waffle-assistant-feedback-dialog-header")+'">';d+="Issue</div>";if(0<c.length){d+='<div class="'+T("waffle-assistant-feedback-dialog-feedback-radio-buttons-control")+'">';b=c.length;for(a=0;a<b;a++)d+=WSf({name:"waffle-assistant-feedback-dialog-feedback-radio-buttons",wT:c[a],checked:!1,index:a});d+=WSf({name:"waffle-assistant-feedback-dialog-feedback-radio-buttons",wT:"Other",checked:!1,index:c.length});d+="</div>"}d+='<div class="'+T("waffle-assistant-feedback-dialog-other-feedback-textarea-wrapper")+
'"><textarea class="'+T("waffle-assistant-feedback-dialog-other-feedback-textarea")+" "+T("jfk-textinput")+'" placeholder="'+T("Tell us a bit more")+'"></textarea></div>';c=S(d);Tx(this,cx(c));c=Vx(this);this.oa().zt(c,zy(XSf),0)};
m.Ia=function(){var a=this;hS.prototype.Ia.call(this);if(0<this.L.length){this.O=C7e("waffle-assistant-feedback-dialog-suggestions-radio-buttons",this.Fa("waffle-assistant-feedback-dialog-suggestions-radio-buttons-control"));this.qa(this.O);for(var b=0;b<this.L.length;b++){var c=this.L[b];JW(this.O,b).xI(this.R.render(c))}}0<this.ma.length&&(this.V=C7e("waffle-assistant-feedback-dialog-feedback-radio-buttons",this.Fa("waffle-assistant-feedback-dialog-feedback-radio-buttons-control")),this.qa(this.V));
b=this.Fa("waffle-assistant-feedback-dialog-product-info-display-text");c=new Hy(b);this.qa(c);this.getHandler().listen(b,"click",this.mSa).listen(c,"key",function(d){13===d.keyCode&&(a.mSa(),d.stopPropagation())})};m.$z=function(){var a=ZSf(this);Ltb.qb(a,a.$Ya);var b=this.R.rda();b&&b(a);hS.prototype.$z.call(this)};
function ZSf(a){var b=null;a.O&&(b=parseInt(y7e(a.O),10)-1,b=a.L[b]);var c=-1;a.V&&(c=parseInt(y7e(a.V),10)-1);var d=a.Fa("waffle-assistant-feedback-dialog-other-feedback-textarea");d=Md(d.value)||"[No feedback entered]";return a.R.aza(b,c,d)}m.mSa=function(){var a=this,b=ZSf(this).via;this.H=new VSf(b,this.oa());this.H.setVisible(!0);this.getHandler().listen(this.H,"hide",function(){Tf(a.H);a.H=null})};m.Ka=function(){hS.prototype.Ka.call(this);Tf(this.H)};
function $Sf(){return S('<div class="waffle-assistant-padded-card"><div class="waffle-assistant-before-chart-preview" tabindex="0"></div><div class="waffle-assistant-chart-preview"></div><div class="waffle-assistant-after-chart-preview" tabindex="0"></div><div class="waffle-assistant-chart-highlights"></div></div>')}
function aTf(a,b){return S(R(aA({cd:"waffle-assistant-insert-chart-button waffle-assistant-readonly-hidden",content:hx(""+R(yB({icon:"docs-icon-img docs-icon-insert-autovis-chart"},b))),style:4},b))+'<div class="waffle-assistant-button-separator waffle-assistant-readonly-hidden"></div>'+R(aA({cd:"waffle-assistant-zoom-button",content:hx(""+R(yB({icon:"docs-icon-img docs-icon-zoom-in"},b))),style:4},b)))}function bTf(a,b,c,d){Q.call(this,d);this.O=a;this.D=b;this.C=c;ez(az(new $y,10))}t(bTf,Q);
bTf.prototype.ZPa=function(a,b){this.F(this.O,2746,a,b)};
function cTf(a){var b=a.Rkb,c='<div class="waffle-assistant-facet-section"><div class="waffle-assistant-facet-header"><div class="waffle-assistant-pie-icon"></div><div class="waffle-assistant-facet-top-text">',d='By <span class="waffle-assistant-facet-title">'+(R(a.ndb)+"</span>");a=0==b.length;c=c+d+'</div><div class="waffle-assistant-facet-toggle" tabindex="0"></div></div>';if(a)b=S('<div class="waffle-assistant-facet-by-color-container"><div class="waffle-assistant-faceted-chart waffle-assistant-facet-by-color"></div></div>');else{d=
'<div class="waffle-assistant-facet-charts-container">';for(var e=b.length,f=0;f<e;f++){var h=b[f];d+=(0==f%2?'<div class="waffle-assistant-facet-chart-row">':"")+'<div class="waffle-assistant-single-facet"><div class="waffle-assistant-single-facet-title">';d=h?d+R(h):d+"(empty)";d+='</div><div class="waffle-assistant-faceted-chart"></div></div>'+(1==f%2||f==e-1?"</div>":"")}b=S(d+"</div>")}c+='<div class="waffle-assistant-facet-content-wrapper'+(a?" waffle-assistant-facet-white-section":"")+'">'+
b+(uC?'<div class="waffle-assistant-facet-feedback-container"></div><div class="waffle-assistant-facet-thumbs-container"></div>':"")+"</div></div>";return S(c)}function dTf(){N2c.apply(this,arguments)}t(dTf,N2c);dTf.prototype.Rsa=g("element");function eTf(){C2c.call(this);D2c(this,this);this.xa="waffle-assistant-dragged-card"}t(eTf,kQ);eTf.prototype.contains=function(a){return!!$c(this.F,function(b){if(b.element==a)return!0})};
eTf.prototype.J4=function(a){var b=kQ.prototype.J4.call(this,a);a=a.querySelectorAll("CANVAS");for(var c=b.querySelectorAll("CANVAS"),d=0;d<a.length;d++)c[d].getContext("2d").drawImage(a[d],0,0);return b};function fTf(a,b,c,d,e,f,h,k,l,n){bTf.call(this,e,f,h,n);this.V=a;this.L=b;this.ma=c;this.H=d;this.R=k;this.J=l}t(fTf,bTf);fTf.prototype.Ia=function(){bTf.prototype.Ia.call(this);Y7e(this.ma,this.La(),this.D,this.C,void 0,void 0,this.H)};
fTf.prototype.F=function(a,b,c,d){pI(this.V).dispatchEvent(new x5e(this.L.copy(),this.H,a,b,c,d,void 0,this.R,this.J))};function gTf(a,b,c,d,e,f){bTf.call(this,c,d,e,f);this.R=a;this.J=b;this.H=null}t(gTf,bTf);gTf.prototype.Ia=function(){bTf.prototype.Ia.call(this);(new KV(tqc,this.J.Ol)).send(u(this.L,this,this.J))};gTf.prototype.F=function(a,b,c,d){this.dispatchEvent(new y5e(this.R.clone(),a,this.H,b,c,d))};
gTf.prototype.L=function(a,b){if(b)if(b.Jk())wL.lK(this.La(),b);else{a.Pj(b.Se());EW(a,a.Se());var c=(b=a.Se())?b.toJSON():null,d=ritz.charts.model.GvizChart.create();d.updateChartWrapperJsonString(a.toJSON());c&&d.updateDataTableJsonString(c);Y7e(d,this.La(),this.D,this.C,void 0,void 0,void 0);this.H=b}};
function hTf(a,b,c,d,e,f,h,k){Q.call(this,k);this.C=a;this.Va=b;this.Ma=c;this.Sa=d;this.R=e;this.Ja=f;this.Ra=h;this.H=$g(this.C,23);this.O=C(this.C,22);this.F=C(this.C,26);this.V=[];this.Qa=new Gl;this.xa=this.L=this.D=null;this.Ba=!1;this.Da=new bA("",this.oa());this.Ga(this.Da);this.J=this.ma=null}t(hTf,Q);m=hTf.prototype;m.Ca=function(){Q.prototype.Ca.call(this);this.pb(zy(cTf,{ndb:this.F,Rkb:this.H}));this.La().style.visibility="hidden"};
m.Ia=function(){Q.prototype.Ia.call(this);var a=this.Fa("waffle-assistant-facet-toggle");this.Da.Wa(a);this.getHandler().listen(this.La(),"mousedown",this.vXb).listen(this.Da,"action",this.HLb);uC&&(this.xa=new W3e("assistantAutovisFacetFeedback",null,"",this.oa()),this.xa.render(this.Fa("waffle-assistant-facet-feedback-container")),this.D=new a4e(this.oa()),this.Ga(this.D),this.D.render(this.Fa("waffle-assistant-facet-thumbs-container")),b4e(this.D,this.H.length?"Were these charts useful?":"Was this chart useful?"),
this.getHandler().listen(this.D,"thumbs-up",this.yLb).listen(this.D,"thumbs-down",this.xLb));iTf(this,z(y(),"fefsbd"))};m.Pd=g("Ba");m.vXb=function(a){a.stopPropagation()};m.HLb=function(){var a=Cx(this.Fa("waffle-assistant-facet-content-wrapper"),"waffle-assistant-facet-charts-wrapper-hidden");iTf(this,a);jTf(this,a?2647:2646)};
function iTf(a,b){var c=a.Fa("waffle-assistant-facet-toggle");Ep(c,b?"HIDE":"SHOW");Hx(a.Fa("waffle-assistant-facet-content-wrapper"),"waffle-assistant-facet-charts-wrapper-hidden",!b);$c(a.Vf("waffle-assistant-faceted-chart"),function(e){Fp(e,b)});a.D&&P(a.D.La(),b);var d='Show chart broken down by "'+(a.F+'"');a='Hide chart broken down by "'+(a.F+'"');lW(c,b?a:d)}
function kTf(a,b){var c=a.Vf("waffle-assistant-faceted-chart");1==c.length&&2==b.getTypeOrdinal()&&b.setStackingType(1);var d=C(a.C,28).clone();Zg(d,1);for(var e=$g(a.C,27),f=0;f<e.length;f++)d.addRange(e[f]);for(e=0;e<c.length;e++){f="string"===typeof a.H[e]?a.H[e]:null;var h=b.copy();f?h.setFilter(a.O,f):h.setFacet(a.O,[a.O-1]);var k=a,l=h.getTitle();l||(l=r2e(h));h.setTitle(lTf(k,l,f));k=h.copy();l=Il(a.Qa.sb(d),qg);k.setChartDataSource(ritz_api.ChartsApi.createChartDataSource(l));$7e(k);l=new fTf(a.Va,
h,k,d,a.Ma,a.Sa,a.R,a.C.getSource(),a.Ra,a.oa());a.Ga(l);var n=c[e];l.Wa(n);a.V.push(l);mTf(a,n,r2e(h),f);a.ma=k}nTf(a);a.La().style.visibility="visible"}function mTf(a,b,c,d){var e=c+(' broken down by "'+(a.F+('" for "'+(d+'"'))));a=c+(' broken down by "'+(a.F+'"'));zx(b,d?e:a)}function lTf(a,b,c){var d=b+(' when "'+(a.F+('" is "'+(c+'"'))));a=b+(' by "'+(a.F+'"'));return c?d:a}
function oTf(a){a.setOption("legend","top");a.setOption("titleTextStyle.fontSize",10);a.setOption("allowAsync",!0);a.setOption("applyAggregateData",void 0);a.setOption("pieSliceTextStyle.fontSize",11);a.setOption("tooltip.textStyle.fontSize",11);"BarChart"==a.De()&&a.setOption("isStacked",!0)}function pTf(a){"BarChart"==a.De()&&a.setOption("isStacked",!0);a.setOption("applyAggregateData",void 0)}
function nTf(a){a.Ba||$c(a.V,function(b){var c=b.La();if(!a.Ja.contains(c)){var d=a.Ja;b=new dTf(c,b);E4c(d,b)}})}m.yLb=function(){jTf(this,2649)};m.xLb=function(){jTf(this,2648);this.xa.show(!0)};function jTf(a,b){if(a.ma)fzd(a.R,b,new yR,10,a.ma,C(a.C,28));else if(a.J){var c=a.R,d=new yR,e=a.J.De();d.F=e;(e=a.J.Se())?d.C=e.clone():d.C=null;kzd(c,b,d,10,a.J,a.J.Ol)}}
function qTf(a,b,c,d,e,f,h,k){oW.call(this,a,k);this.J=CV(a);this.L=b;this.ob=c;this.rb=d;this.R=e;this.Sa=f;this.ub=h;this.ma=new bA("",this.oa());this.Ga(this.ma);this.xa=new bA("",this.oa());this.Ga(this.xa);this.Ra=new Gl;this.fb=null;this.Ma=!1;this.Xa=[];this.Va=[];this.cb=[];this.Ja=this.C=this.D=this.Ba=null;this.Qa=[];a=b3e(this.ub,iI(b));this.F=ez(bz(az(new $y,10),a))}t(qTf,oW);m=qTf.prototype;m.sC=function(a){var b=this;this.isDisposed()||(ritz_api.ChartsApi?(this.fb=a,rTf(this)):ritz_api.RitzEntryPoint.loadChartsApi(function(){b.sC(a)}))};
m.lD=function(){var a=this;if(!this.isDisposed())if(z(y(),"fecpmr"))if(ritz_api.ChartsApi){var b=v2e(this.createChartModel(),C(this.J,28));zx(this.La(),b)}else ritz_api.RitzEntryPoint.loadChartsApi(function(){a.lD()});else sTf(this,function(c){c&&(c=w2e(a.L,c),zx(a.La(),c))},!1)};m.XI=ea(!0);m.YD=ea("autovisFeedback");m.zH=ea(2208);m.yH=ea(2207);m.uda=ea("Was this chart useful?");
m.Ca=function(){oW.prototype.Ca.call(this);pW(this).appendChild(zy($Sf));e4e(this).appendChild(zy(aTf));if(Vg(this.J,22)){this.C=new hTf(this.J,this.L,this.V,this.rb,this.R,this.Sa,this.Qa,this.oa());this.Ga(this.C,!0);var a=this.C,b=this.Pd();a.Ba=b;nTf(a)}};
m.Ia=function(){oW.prototype.Ia.call(this);Dx(this.La(),"waffle-assistant-card-draggable");var a=this.Fa("waffle-assistant-insert-chart-button");this.ma.Wa(a);lW(a,"Insert chart");a=this.Fa("waffle-assistant-zoom-button");this.xa.Wa(a);lW(a,"View full size");a=this.Fa("waffle-assistant-before-chart-preview");var b=this.Fa("waffle-assistant-after-chart-preview");this.getHandler().listen(this.La(),"keydown",this.tXb).listen(a,"focus",this.vrb).listen(b,"focus",this.oqb).listen(this.ma,"action",this.vAb).listen(this.ma.La(),
"mousedown",this.nya).listen(this.xa,"action",this.yNb).listen(this.xa.La(),"mousedown",this.nya).listen(this.Fa("waffle-assistant-chart-highlights"),"mousedown",this.nya).listen(vG(this.L),"fc",this.uXb);tTf(this);this.R.C(2790,this.F);this.C&&this.R.C(2791,this.F)};m.kx=function(a){oW.prototype.kx.call(this,a);tTf(this);this.tb()&&uTf(this)};function tTf(a){if(a.tb()){var b=a.Pd();a.ma.setVisible(!b);a=a.oa().Fa("waffle-assistant-button-separator",e4e(a));P(a,!b)}}
m.tXb=function(a){13==a.keyCode&&a.target==this.La()&&(a.preventDefault(),a.stopPropagation(),vTf(this,2255))};
function wTf(a){var b=a.De(),c=!!C(a.J,14),d=C(a.J,16),e=!!C(a.J,15),f="Histogram"==b;b="PieChart"==b;var h=qo($g(a.H,4));if(!h[0]||h[0].C==iI(a.L)){for(var k=1<h.length,l=[],n=0;n<h.length;n++){var q=h[n].rect;q=c!=b?$Ba(q,new bn(q.width,1)):$Ba(q,new bn(1,q.height));ud(l,q)}c=AJ(a.ob).F;var r=[];for(w in JBa)r.push(Jzc(c,JBa[w]));var w=ed(l,function(x){return ed(r,Qa(un,x))});f&&e&&(w=vd(w,1));a.cb=xTf(w.length,b&&0<d||!f&&!b&&e,b&&k);d=AJ(a.ob);for(e=0;e<w.length;e++)for(f=a.cb[e],b=0;b<w[e].length;b++)w[e][b]&&
Jn(w[e][b])&&(k=yYe(d,w[e][b],"waffle-assistant-styled-rect"),a.qa(k),QO(d.V,"default",k,!0),tw(k.La(),"background-color",f),k.setVisible(!0),a.Xa.push(k),k=TO(d,w[e][b],"waffle-assistant-styled-border",1,0),a.qa(k),SBc(k,f),k.setVisible(!0),a.Va.push(k))}}function yTf(a){Uf(a.Xa);Uf(a.Va);a.Xa=[];a.Va=[];a.cb=[]}m.uXb=function(){this.Ma&&(yTf(this),wTf(this))};m.VS=function(){oW.prototype.VS.call(this);this.Ja=Ra();this.Ma||(wTf(this),this.Ma=!0)};
m.qN=function(){oW.prototype.qN.call(this);"number"===typeof this.Ja&&500<Ra()-this.Ja&&this.R.C(2789,this.F);this.Ja=null;yTf(this);this.Ma=!1};m.vrb=function(){var a=this.Fa("waffle-assistant-chart-highlights");Kw(a)?a.focus():this.La().nextSibling&&this.La().nextSibling.focus()};m.oqb=function(){this.O&&X3e(this.O)||this.xa.La().focus()};m.vAb=function(){vTf(this,2255)};m.nya=function(a){a.stopPropagation()};m.yNb=function(){fub.qb(this,this.F)};m.ZPa=function(a,b){vTf(this,2257,a,b)};
function vTf(a,b,c,d){if(z(y(),"fecpmr")){var e=a.createChartModel();pI(a.L).dispatchEvent(new x5e(e,C(a.J,28),a.V,b,c,d,Ik(a.F),a.J.getSource(),a.Qa))}else sTf(a,function(f){f&&(f=new y5e(f,a.V,a.D&&a.D.Se(),b,c,d,Ik(a.F),a.J.getSource(),a.Qa),pI(a.L).dispatchEvent(f))},!1)}function zTf(a,b){Y7e(b,ATf(a),a.rb,a.R,function(){null!==a.Ba&&(gl(cl(),a.Ba),a.Ba=null);a.isDisposed()||(a.fb(),uTf(a))})}function uTf(a){if(!a.Pd()){var b=ATf(a);if(!a.Sa.contains(b)){var c=a.Sa;a=new dTf(b,a);E4c(c,a)}}}
function BTf(a,b,c){var d=[];try{var e=a.Ra.sb(c),f=Il(e,qg),h=ritz_api.RitzModelApi.getVerbalHighlightsForProto(f,ritz.charts.model.ChartTypes.toGviz(b.getTypeOrdinal()),0!=b.getStackingTypeOrdinal(),b.getTitle(),aX(b,ritz.charts.model.AxisNames.X),aX(b,ritz.charts.model.AxisNames.Y),aX(b,ritz.charts.model.AxisNames.RIGHT),b.getDomainDataBacked());d=ed(h,I$e)}catch(k){d=[]}a=a.Fa("waffle-assistant-chart-highlights");P(a,0<d.length);0<d.length&&(a.appendChild(d[0]),Fp(a,!0))}
m.createChartModel=function(){CTf(this);var a=ritz.charts.model.ChartImpl.create(),b=C(this.J,28);ritz_api.ChartsApi.setChartModel(a,Il(this.Ra.sb(b.Xk()),hg));b=Il(this.Ra.sb(b),qg);a.setChartDataSource(ritz_api.ChartsApi.createChartDataSource(b));return a};function DTf(a){CTf(a);C(a.J,16);var b=Y4e(a.J);b.VBa(tqc);var c=I4e(a.H);b.np(c.toString());a.C&&(c=c.clone(),a.C.L=c);return b}function CTf(a){a.Vd&&(a.Ba=fl(cl(),"aaoar"),a.Vd=!1)}
function rTf(a){if(z(y(),"fecpmr")){var b=a.createChartModel(),c=b.copy();$7e(c);BTf(a,b,C(a.J,28));zTf(a,c);a.C&&kTf(a.C,b)}else{var d=Z4e(DTf(a),a.Fa("waffle-assistant-card-inner"));(new KV(tqc,d.Ol)).send(function(e){if(e)if(e.Jk())wL.lK(ATf(a),e);else{d.Pj(e.Se());EW(d,d.Se());e=new Xs;e.setContext(d.toJSON());var f=!!C(a.J,14);D(e,3,f);var h=C(a.J,16);D(e,4,h);D(e,5,f);D(e,8,0);C(a.J,24)&&(f=C(a.J,25),D(e,9,f));f=qo($g(a.H,4));for(h=0;h<f.length;h++)e.addRange(no(f[h].rect,f[h].C));f=(f=d.Se())?
f.toJSON():null;h=ritz.charts.model.GvizChart.create();h.updateChartWrapperJsonString(d.toJSON());f&&h.updateDataTableJsonString(f);BTf(a,h,e);a.D=d;e=(e=d.Se())?e.toJSON():null;f=ritz.charts.model.GvizChart.create();f.updateChartWrapperJsonString(d.toJSON());e&&f.updateDataTableJsonString(e);zTf(a,f)}});a.C&&sTf(a,function(e){var f=a.C,h=d;e=new DL(e.toJSON());h=new DL(h.toJSON());var k=f.Vf("waffle-assistant-faceted-chart");if(1<k.length){pTf(e);var l=h;oTf(l);l.setOption("pieSliceText","percentage");
l.setOption("axisFontSize",0);l.setOption("hAxis.title",null);l.setOption("hAxis.textPosition","none");l.setOption("vAxes.0.title",null);l.setOption("vAxes.0.textPosition","none");l.setOption("vAxes.1.title",null);l.setOption("vAxes.1.textPosition","none");l.setOption("legend","none");l.setOption("titleTextStyle.fontSize",0)}else l=e,pTf(l),l.setOption("applyAggregateData",void 0),l.setOption("legend","right"),oTf(h);l=qo($g(f.C,27));uqc(f.L,l);l=C(f.C,25);for(var n=0;n<k.length;n++){var q="string"===
typeof f.H[n]?f.H[n]:null,r=l.clone(),w=f.O,x=new uWa;D(x,1,w);"string"===typeof q&&x.setValue(q);D(r,7,x);f.L.Ob("dt",encodeURIComponent(JSON.stringify(f.Qa.sb(r))));r=new DL(e.toJSON());r.np(f.L.toString());w=h.clone();w.np(f.L.toString());x=f;var F=r.getOption("title");F||(F=s2e(r));x=lTf(x,F,q);r.setOption("title",x);w.setOption("title",x);x=new gTf(r,w,f.Ma,f.Sa,f.R,f.oa());f.Ga(x);F=k[n];x.Wa(F);f.V.push(x);mTf(f,F,s2e(r),q);f.J=w}nTf(f);f.La().style.visibility="visible"},!1)}}
function sTf(a,b,c){var d=DTf(a);(new KV(tqc,d.Ol)).send(function(e){e?(e=e.Se(),c&&d.Pj(e),EW(d,e),b(d)):b(null)})}m.De=function(){return this.J.De()};function xTf(a,b,c){var d=b?["#666"]:[];c&&(a/=2);b&&--a;b=W4e("material").colors;for(var e=0;e<a;e++)d.push(b[e%b.length].color);c&&ud(d,d);return d}function ATf(a){return a.Fa("waffle-assistant-chart-preview")}
function ETf(a,b){a=a.title;var c='<div class="waffle-assistant-feature-section" tabindex="0" role="region" aria-label="',d=" "+(T(a)+" Section ");c+=jx(d);c+='"><div class="waffle-assistant-section-header"><div class="waffle-assistant-section-title">'+R(a)+"</div>";c+=R(aA({cd:"waffle-assistant-section-more-button",content:hx("More"),style:4},b));return S(c+'</div><div class="waffle-assistant-section-content"></div><div class="waffle-assistant-section-card-holder"></div></div>')}
function k_(a,b,c,d){Q.call(this,d);this.V=a;this.cb=b;this.xa=new bA("",this.oa());this.Ga(this.xa);this.L=new Q(this.oa());this.Ga(this.L);this.C=null;this.Qa=[];this.ma=this.Ma=!1;this.R=c}t(k_,Q);m=k_.prototype;m.QSa=ea(!1);m.ECa=ea(!0);m.Ca=function(){Q.prototype.Ca.call(this);this.pb(zy(ETf,{title:this.getTitle()}))};
m.Ia=function(){Q.prototype.Ia.call(this);this.L.Wa(this.Fa("waffle-assistant-section-card-holder"));this.xa.Wa(this.Fa("waffle-assistant-section-more-button"));this.getHandler().listen(this.xa,"action",this.FCb);this.C=this.RIa();this.qa(this.C);P(FTf(this),this.QSa());this.setVisible(!1)};m.setVisible=function(a){this.tb()&&this.isVisible()!=a&&(P(this.La(),a),a&&(P(this.xa.La(),this.n3a()),a=new sk,a=L(a,4,this.l7()),a=tk(new pk,a),a=ez(bz(az(new $y,10),a)),this.R.C(2774,a)))};
m.isVisible=function(){return this.tb()&&Kw(this.La())};m.n3a=function(){return this.Qa.length>this.V};m.RIa=function(){return new NW(this.oa())};m.ZS=function(a){this.ma=a;$c(GTf(this),function(b){b.kx(a)});U8e(this.C,a)};m.Pd=g("ma");m.YWa=ba();
m.XS=function(a){this.Qa=a;for(var b=0;b<a.length;b++){if(this.L.mc()<this.V){var c=this.dW(a[b]);c.kx(this.ma);var d=this.L.mc();c.V=d;this.L.Ga(c,!0)}if(this.ECa()&&(this.C.KJ(!1),c=this.dW(a[b]),c.kx(this.ma),d=this.C,d.C.push(c),d.vd)){S8e(d,!1);var e=d.O.mc();c.V=e;d.O.Ga(c,!0);c.kQ()}}};function GTf(a){var b=[];a.L.Xe(function(c){b.push(c)});return b}function FTf(a){return a.Fa("waffle-assistant-section-content")}m.mva=function(){return this.L.y5()};
m.YS=function(){this.Qa=[];Uf(this.L.ud(!0));this.setVisible(!1);this.ECa()&&(this.C.l2(),this.C.KJ(!0))};function HTf(a){a.L.Xe(function(b,c){c<this.V&&b.kQ()},a)}m.m7=function(a){var b=0;if(this.Ma)this.C.ZWa();else if(this.mva()){this.setVisible(!0);b=Hw(this.Fa("waffle-assistant-section-header")).height+Hw(FTf(this)).height;for(var c=GTf(this),d=0;d<c.length;d++)b<a&&d<this.V?(this.mPa(c[d]),g4e(c[d],!0),b+=Hw(c[d].La()).height):g4e(c[d],!1)}else this.setVisible(!1);return a-b};m.mPa=ba();
m.setActive=function(a){(this.Ma=a)||this.C.jba()};m.Fb=g("Ma");m.po=function(a){this.C&&S8e(this.C,a)};function ITf(a,b){a.C.Pja(b,a.getTitle())}m.FCb=function(){this.setActive(!0);this.dispatchEvent("ee")};function JTf(){return S('<div class="waffle-assistant-word-cloud-card"><div class="waffle-assistant-word-cloud-title"></div><div class="waffle-assistant-word-cloud-words-container"></div></div>')}function KTf(a,b){oW.call(this,a,b);this.C=CV(a)}t(KTf,oW);m=KTf.prototype;m.lD=ba();m.YD=ea("assistantWordCloudFeedback");
m.zH=ea(2634);m.yH=ea(2633);m.Ca=function(){oW.prototype.Ca.call(this);pW(this).appendChild(zy(JTf));Dx(pW(this),"waffle-assistant-word-cloud-content-container")};m.sC=function(a){for(var b=$g(this.C,19),c=$g(this.C,20),d=this.Fa("waffle-assistant-word-cloud-words-container"),e=0;e<b.length;e++)if(LTf(this,b,c,e),120<d.clientHeight){LTf(this,b,c,e-1);break}b=this.oa();c=C(this.C,2);c=Op(b,c);d=this.Fa("waffle-assistant-word-cloud-title");b.appendChild(d,c);a()};
function LTf(a,b,c,d){var e=a.Fa("waffle-assistant-word-cloud-words-container");for(a=a.oa();e.firstChild;)e.removeChild(e.firstChild);for(var f=c[d],h=c[0],k=0;k<=d;k++){0!=k&&e.appendChild(Op(a," "));var l=a.createElement("SPAN");a.appendChild(l,Op(a,b[k]));a.appendChild(e,l);Dx(l,"waffle-assistant-word-cloud-word");var n=c[k];l.style.color=0==k%2?"#00695C":"#61443C";l.style.fontSize=(n-f)/(h-f)*15+9+"px"}}
function MTf(a,b,c,d,e,f){var h=Vc(y(),"fmnac");h||(h=20);k_.call(this,h,e,d,f);this.Ba=a;this.H=b;this.Da=c;this.D=new eTf;this.qa(this.D);this.F=null;this.O=0;this.J=null}t(MTf,k_);m=MTf.prototype;m.Ia=function(){k_.prototype.Ia.call(this);this.D.init();this.getHandler().listen(this.D,"drag",this.sXb).listen(this.D,"dragend",this.Tm)};m.getTitle=ea("Analysis");m.X1=function(a){return 0==a};
m.dW=function(a){return"WordCloud"==CV(a).De()?new KTf(a,this.oa()):new qTf(a,this.Ba,this.H,this.Da,this.R,this.D,this.J,this.oa())};m.ZS=function(a){k_.prototype.ZS.call(this,a);a&&G2c(this.D)};m.mPa=function(a){this.getHandler().Nc(a,"content-rendered",this.rXb);this.O++};m.XS=function(a,b){this.J=b||null;k_.prototype.XS.call(this,a,b);var c=a.map(function(d){return CV(d).De()});$c(GTf(this),function(d){d instanceof qTf&&(d.Qa=c)})};m.rXb=function(){0==--this.O&&this.dispatchEvent("ae")};
m.sXb=function(){this.F=Dw(this.D.Rc.target)};m.Tm=function(a){var b=this.F,c=AJ(this.H).D;if(hn(KN(c,"page",!1,!1)).contains(b)){var d=IN(c,b.x,b.y,"page");c=LN(c,d,"page");b=new Um(b.x-c.left,b.y-c.top);a.C.getData().ZPa(d,b)}this.F=null};m.l7=ea(2);
function NTf(a,b){a=S;var c='<div class="'+T("waffle-assistant-answers-logging-message-container")+'"><div class="'+T("waffle-assistant-answers-logging-message")+'"><span class="'+T("waffle-assistant-answers-logging-text")+'">';c=c+"We're logging your queries and data to improve the feature.</span><div class=\""+(T("waffle-assistant-answers-learn-more")+'">');c=c+'Learn More</div><div class="'+(T("waffle-assistant-answers-logging-opt-out")+'">');c=S(c+"Opt-out for this file</div></div></div>");return a(c+
'<div class="'+T("waffle-assistant-answers-input")+" "+T("waffle-assistant-answers-input-with-icon")+'"><form class="'+T("waffle-assistant-answers-query-box")+'">'+R(q8e(b))+"</form></div>")}
function OTf(a,b,c,d,e,f,h,k,l,n){k_.call(this,1,f,e,n);this.Xa=c;this.fb=b;this.Ja=null;this.Da=new iz("",new pR,this.oa());this.Ga(this.Da);this.Sa=new iz("",new pR,this.oa());this.Ga(this.Sa);f=new bO(a,!0,!0);f=new p5e(f);this.Ba=new j4e(e);this.O=new R9e(this.Xa,f,e);this.H=new V9e(this.O,a,b,c,d,e,this.cb,f,this.Ba,h,k,l,this.oa());this.D=new yW(b,"waffle-assistant-answers-styled-border","waffle-assistant-answers-styled-rect");this.qa(this.D);this.F=this.J=null;this.Va=ez(az(new $y,10));this.Ra=
!1}t(OTf,k_);m=OTf.prototype;m.Ca=function(){k_.prototype.Ca.call(this);var a=zy(NTf);this.oa().appendChild(FTf(this),a)};
m.Ia=function(){k_.prototype.Ia.call(this);var a=this.Fa("waffle-assistant-answers-query-box"),b=this.Fa("waffle-assistant-answers-input-box");this.Sa.Wa(this.Fa("waffle-assistant-answers-logging-opt-out"));this.Da.Wa(this.Fa("waffle-assistant-answers-learn-more"));this.getHandler().listen(a,"focus",this.vGb,!0).listen(a,"blur",this.tGb,!0).listen(a,"mouseover",this.xGb).listen(a,"mouseout",this.wGb).listen(a,"click",this.uGb).listen(b,"input",this.CXb).listen(this.Sa,"action",this.BEb).listen(this.Da,
"action",this.aBb).listen(vG(this.Xa),"fc",YYe(this.DXb,25,this));this.setVisible(null!=this.J);PTf(this,erb&&frb&&vC("showAnswersLoggingOptOut"))};m.n3a=ea(!1);m.QSa=ea(!0);m.ECa=ea(!1);m.getTitle=ea("Answers");m.l7=ea(1);m.X1=function(a){return 3==a||0==a||1==a};
m.XS=function(a,b){zd(a,function(l,n){return C(n,2)-C(l,2)});for(var c=[],d=[],e=null,f=0;f<a.length;f++){var h=ah(a[f],1);3==h?e=a[f]:0==h?c.push(CV(a[f])):1==h&&d.push(a[f])}if(e&&C(e,2)){f=b||null;h=Vg(e,11)?C(e,11):null;var k=null==h?null:oo(C(e,10));0<Wg(e,4)?QTf(this,oo(BV(e)),C(e,9),k,h,c,d):QTf(this,f,C(e,9),k,h,c,d);this.F||(k_.prototype.XS.call(this,a,b),this.getHandler().listen(this.F,"sqc",this.MKb))}else this.YS(!0)};
m.dW=function(a){if(!this.F){var b=z9e(this.O,3);this.F=new P9e(a,this.fb,this.R,this.Ba,b,L9e,"regular",void 0,this.oa())}return this.F};m.RIa=g("H");m.mva=function(){return this.isVisible()};m.YS=function(a,b,c){this.O.reset();(a||b)&&this.F&&(k_.prototype.YS.call(this,a,b,c),this.F.dispose(),this.F=null);if(a||void 0!==b&&!b)this.F&&(k_.prototype.YS.call(this,a,b,c),this.F.dispose(),this.F=null),this.tb()&&(this.O.reset(),this.J=null,a$e(this.H),this.setVisible(!1),this.Fb()&&zW(this.D));c&&this.H.reset()};
m.po=function(a,b){b||S8e(this.H,a)};m.YWa=function(a){this.Ja=a;var b=this.H;b.Qa=a;b.xa.WE(a);b.Da.WE(a);this.O.L=a;this.Ba.C=a};m.setActive=function(a){k_.prototype.setActive.call(this,a);a?AW(this.D,this.J):zW(this.D)};function RTf(a,b){a.Fb()&&(b?zW(a.D):AW(a.D,a.J))}function PTf(a,b){P(a.Fa("waffle-assistant-answers-logging-message-container"),b)}function STf(a,b){a=a.Fa("waffle-assistant-answers-query-box");Hx(a,"waffle-assistant-answers-query-box-focused",b)}
m.DXb=function(){this.Fb()&&AW(this.D,this.J)};m.vGb=function(){STf(this,!0);AW(this.D,this.J)};m.tGb=function(){STf(this,!1);this.Fb()||zW(this.D)};m.xGb=function(){AW(this.D,this.J)};m.wGb=function(){this.Fb()||zW(this.D)};m.uGb=function(){TTf(this,"")};m.CXb=function(){var a=this.Fa("waffle-assistant-answers-input-box");gf(a.value)||(TTf(this,a.value),a.value="")};m.MKb=function(a){TTf(this,a.C,!1,!0,a);this.R.C(2652,this.Va)};
function TTf(a,b,c,d,e){c=void 0===c?!1:c;d=void 0===d?!1:d;a.setActive(!0);a.dispatchEvent("ee");UTf(a,b,c);if(d&&b){var f=new KS;e instanceof J9e?f=g3e(1,e.F,e.D,1):e instanceof w8e&&(f=n$e(e));c=new Qq(function(){$9e(a.H,b,f,e)},300);a.qa(c);c.start()}}function UTf(a,b,c,d,e){c=void 0===c?!1:c;d=void 0===d?!1:d;var f=new Qq(function(){var h=a.H;h.D&&G8e(h.D,b,!0);h=a.H;var k=c||!1;h.Ne=k;h.hd.R=k;h.Dc.R=k;d&&b&&(h=new KS,e&&(h=n$e(e)),$9e(a.H,b,h,e))},300);a.qa(f);f.start()}
function QTf(a,b,c,d,e,f,h){c=c||new iJ;a.J=b;a.O.init(c,b,d,e,f,h);a.O.HZ();a.O.IZ().then(function(k){var l=a.eb("waffle-assistant-answers-input-box");l&&0<k.length&&z(y(),"feaipu")&&l.setAttribute("placeholder","Try '"+(k[0].query+"'"))},null,a);a.setVisible(null!=b);Y9e(a.H,b,c,d,e,a.Ra,f);a.Ra=!1;a.Fb()&&AW(a.D,a.J)}m.BEb=function(a){a.stopPropagation();a.preventDefault();this.Ja&&(fr(Sl(Tl(this.Ja.We("/answers/logoptout"),u(this.DBb,this)),u(this.CBb,this)),"POST").Re(),this.R.C(2663,this.Va))};
m.aBb=function(a){a.stopPropagation();a.preventDefault();Zw("https://docs.google.com/document/d/1VxpmAx5RTnwmeXyj3IuPPYIXg9DYzTS8nz8pi1E_ZJk/preview",{target:"_blank"})};m.DBb=function(a){a.Uj()&&PTf(this,!1)};m.CBb=ba();
function VTf(a,b){a=S;b=""+R(aA({cd:"waffle-assistant-datavalidation-apply-button",content:"Apply",style:4},b));b=S(b);return a('<div class="waffle-assistant-datavalidation-rule-group"><div class="waffle-assistant-datavalidation-details"></div><div class="waffle-assistant-datavalidation-description"></div>'+b+"</div>")}function WTf(a){return S('<div class="waffle-assistant-datavalidation-detail-chip">'+R(a.Oeb)+"</div>")}
function XTf(a,b,c,d){oW.call(this,a,d);this.D=new yW(b,"waffle-assistant-highlight-styled-border","waffle-assistant-highlight-styled-rect");this.qa(this.D);this.C=new bA("",this.oa());this.Ga(this.C);this.F=BV(a);this.L=c}t(XTf,oW);m=XTf.prototype;m.Ca=function(){oW.prototype.Ca.call(this);pW(this).appendChild(zy(VTf))};
m.Ia=function(){oW.prototype.Ia.call(this);var a=this.Fa("waffle-assistant-datavalidation-apply-button");this.C.Wa(a);lW(a,"Apply data validation");this.getHandler().listen(this.C,"action",this.Nqb).listen(this.La(),"mouseenter",this.XXb).listen(this.La(),"mouseleave",this.YXb);a=NUe(new sk,Y$e(Hh(C(C(this.H,13),3))));a=tk(new pk,a);a=ez(bz(az(new $y,10),a));this.L.C(35577,a)};
m.sC=function(a){var b=gM(po(this.F)),c=C(C(this.H,13),3);switch(Hh(c)){case 14:var d="Email validation";c=["Is valid email"];break;case 15:d="URL validation";c=["Is valid URL"];break;case 30:d="Date validation";c=["Is valid date"];break;case 24:d="List of items";c=Jh(c).map(function(k){return C(k.Ip().getValue(),2)});break;case 1:d="Numeric validation";c=["Greater than "+C(Jh(c)[0].Ip().getValue(),3)];break;case 7:d="Numeric validation";c=Jh(c);c=["Between "+(C(c[0].Ip().getValue(),3)+(" and "+C(c[1].Ip().getValue(),
3)))];break;case 5:d="Numeric validation";c=Jh(c);c=["Equal to "+C(c[0].Ip().getValue(),3)];break;default:d="unrecognized",c=[]}var e=new rC,f=e.text(d)+(" for "+(e.$c("SPAN".toString(),{FG:"waffle-assistant-datavalidation-range"})+e.text(b)+e.Zc("SPAN".toString())));Hga(this.Fa("waffle-assistant-datavalidation-description"),e.format(f));var h=this.Fa("waffle-assistant-datavalidation-details");$c(c,function(k){k=zy(WTf,{Oeb:k});h.appendChild(k)});b="Suggested data validation: "+(d+(" "+(c.join()+
(" for "+b))));zx(this.La(),b);a()};m.lD=ba();m.YD=ea("assistantDataValidationFeedback");m.zH=ea(35551);m.yH=ea(35550);m.Nqb=function(){this.dispatchEvent(new nW("Yd",this,35549))};m.XXb=function(){AW(this.D,oo(this.F))};m.YXb=function(){zW(this.D)};function YTf(a,b,c,d){k_.call(this,1,b,a,d);this.D=c}t(YTf,k_);m=YTf.prototype;m.getTitle=ea("Data Validation");m.X1=function(a){return 6==a};
m.dW=function(a){var b=C(a,1);switch(b){case 6:return new XTf(a,this.D,this.R,this.oa());default:throw Error("Unsupported recommendation type: "+b);}};m.ZS=function(a){k_.prototype.ZS.call(this,a);this.setVisible(!a)};m.m7=function(a){return this.Pd()?(this.setVisible(!1),a):k_.prototype.m7.call(this,a)};m.l7=ea(4);function ZTf(a,b,c){nW.call(this,"Wd",a,b);this.D=c}t(ZTf,nW);function $Tf(a){a=""+R(aA({cd:"waffle-assistant-formatting-edit-button",content:"Edit",style:4},a));return S(a)}
function aUf(a,b){a='<div class="waffle-assistant-banding-recommendation"><div class="waffle-assistant-banding-color-picker-container"></div><div class="waffle-assistant-banding-range-wrapper">Alternating colors for <span class="waffle-assistant-banding-range"></span></div>'+($Tf(b)+"</div>");return S(a)}
function bUf(a,b){return S('<div class="waffle-assistant-conditionalformat-rule-group"><div class="waffle-assistant-conditionalformat-rule-holder" tabindex="0"></div><div class="waffle-assistant-conditionalformat-description"></div>'+$Tf(b)+"</div>")}function cUf(a,b,c){nW.call(this,"de",a,b);this.D=c}t(cUf,nW);function dUf(a,b,c,d){oW.call(this,a,d);a=ed($g(this.H,7),baf);this.C=new gaf(!1,a,7);this.Ga(this.C);this.L=new bA("",this.oa());this.Ga(this.L);this.ma=b;this.F=!1;this.D=-1;this.R=c}
t(dUf,oW);m=dUf.prototype;m.Ca=function(){oW.prototype.Ca.call(this);pW(this).appendChild(zy(aUf))};m.Ia=function(){oW.prototype.Ia.call(this);this.getHandler().listen(this.L,"action",this.Mwb).listen(this.C,"Xe",this.qrb);this.ma.C(2768)};
m.sC=function(a){var b=this.Fa("waffle-assistant-banding-color-picker-container");this.C.render(b);haf(this.C);b=this.Fa("waffle-assistant-banding-range");var c=BV(this.H),d=po(c);Ep(b,gM(d));eUf(this,c);b=this.Fa("waffle-assistant-formatting-edit-button");this.L.Wa(b);a()};m.lD=function(){zx(this.La(),"Suggested alternating background colors");this.C.Ce("Choose a color scheme")};m.YD=ea("assistantBandingFeedback");m.zH=ea(2672);m.yH=ea(2671);
m.Mwb=function(a){sJ.dispatchEvent({type:"show-banding-pane-recommendation",K0a:this.H,jeb:jaf(this.C)});a.stopPropagation()};m.qrb=function(a){var b=this;if(!this.F&&iaf(this.C)){var c=this.D;this.D=this.C.ai();this.D==c?this.dispatchEvent(new cUf(this,2797,function(){b.R.clear()})):this.dispatchEvent(new ZTf(this,2673,function(){N5e(b.R,"Alternating colors applied",b.oa(),function(){b.dispatchEvent(new nW("ie",b,2796))})}));a.stopPropagation()}};
function eUf(a,b){a.F=!0;var c=b.mb();b=po(b);c=ritz_api.RitzModelApi.getWorkbookRangeIntersectingIds(c,b.dc(),b.Zb(),b.Sc(),b.Uc(),7,!1);c.length?(c=ritz_api.RitzModelApi.getBandedRangeByWorkbookRangeId(c[0]),c=Hl(c,sia),c=(new Gl).Ld(ft.getDescriptor(),c),c=baf(c)):c=null;c?(c=kaf(a.C,c),KL(a.C,c?c.getElement():null)):KL(a.C,null);a.D=a.C.ai();a.F=!1}function fUf(a,b){Oy.call(this,void 0,void 0,b);this.C=a}t(fUf,Oy);
fUf.prototype.Gc=function(a){Oy.prototype.Gc.call(this,a);var b=this.C.Od;switch(b.length){case 0:break;case 1:var c="one-rule";break;case 2:case 4:c="two-rules";break;default:c="three-rules"}for(var d=0;d<b.length;d++){var e=b[d],f=lp("DIV");Ex(f,["waffle-assistant-conditionalformat-format-preview",c]);var h=lp("DIV");Dx(h,"waffle-assistant-conditionalformat-format-preview-label");f.appendChild(h);Ep(h,"123");if(Vg(e,2)){var k=C(C(e,2),1);switch(Hh(Lh(k))){case 9:case 13:k=Jh(Lh(k))[0];var l=$g(e,
1)[0];Ep(h,IG(k,ah(l,1),ah(l,2),ah(l,4)))}}waf(e,f);a.appendChild(f)}};fUf.prototype.Tg=function(){var a=this.C;a.dispatchEvent(new nW("Xd",a,2563));return!0};function gUf(a,b){oW.call(this,a,b);this.C=new bA("",this.oa());this.Ga(this.C);this.Od=$g(a,6)}t(gUf,oW);m=gUf.prototype;m.Ca=function(){oW.prototype.Ca.call(this);pW(this).appendChild(zy(bUf))};
m.Ia=function(){oW.prototype.Ia.call(this);var a=this.Fa("waffle-assistant-formatting-edit-button");this.C.Wa(a);lW(a,"Apply and edit conditional format rules");this.getHandler().listen(this.C,"action",this.Lqb)};m.sC=function(a){Ep(this.Fa("waffle-assistant-conditionalformat-description"),ah(this.H,3));var b=this.Fa("waffle-assistant-conditionalformat-rule-holder"),c=new fUf(this,this.oa());this.Ga(c);c.Wa(b);lW(b,"Apply conditional format rules");a()};m.lD=ba();m.YD=ea("assistantConditionalFormatFeedback");
m.zH=ea(2630);m.yH=ea(2629);m.Lqb=function(){this.dispatchEvent(new nW("Xd",this,2563));this.dispatchEvent(new nW("$d",this,2670,void 0,void 0,po(C(this.Od[0],1,0))));l7b()};function hUf(a,b,c){k_.call(this,2,b,a,c)}t(hUf,k_);m=hUf.prototype;m.getTitle=ea("Formatting");m.X1=function(a){return z(y(),"feecfr")&&2==a||4==a};
m.dW=function(a){var b=C(a,1);switch(b){case 2:return new gUf(a,this.oa());case 4:return new dUf(a,this.R,this.cb,this.oa());default:throw Error("Unsupported recommendation type: "+b);}};m.ZS=function(a){k_.prototype.ZS.call(this,a);this.setVisible(!a)};m.m7=function(a){return this.Pd()?(this.setVisible(!1),a):k_.prototype.m7.call(this,a)};m.l7=ea(3);function l_(a,b,c,d,e){Q.call(this);this.R=a;this.Va=b;this.C=c;this.L=d;this.D=e}t(l_,Q);
l_.prototype.Sha=function(a,b,c){this.C=a;this.L=b;this.D=c};l_.prototype.Ia=function(){Q.prototype.Ia.call(this);this.getHandler().listen(this.R.C,"na",this.Xa)};l_.prototype.Xa=function(){this.Va.qb()};function iUf(a,b,c,d){d=void 0===d?!1:d;nW.call(this,"fe",null,2859);this.D=a;this.O=b;this.F=c;this.L=!!d}t(iUf,nW);
function jUf(a,b){A.call(this);this.F=a;this.H=b;this.C=new yW(a,"waffle-assistant-table-range-border","waffle-assistant-table-range-rect");this.qa(this.C);this.D=new yW(a,"waffle-assistant-header-range-border","waffle-assistant-header-range-rect");this.qa(this.D)}t(jUf,A);jUf.prototype.Ka=function(){zW(this.C);zW(this.D);A.prototype.Ka.call(this)};
function kUf(a,b,c,d,e,f){nBc(b);var h=pG(d);h=new qn(h.dc(),h.Zb(),Math.min(h.Sc(),h.dc()+6),Math.min(h.Uc(),h.Zb()+6));var k=TN(b),l=AJ(a.F).D,n=JM(l,new kn(h.dc(),h.Sc()),"r",!0,!1,!0,!0)-1,q=JM(l,new kn(h.Zb(),h.Uc()),"c",!0,!1,!0,!0)-1;l.Nb()&&--q;n=Math.min(200,n);q=Math.min(c.offsetWidth-2,q);oBc(b,k,q,n);c=OSf(d,e,f);a.H.render(b,h,c);b=a.C;h=d.dc();k=d.Zb();switch(e){case 0:h=Math.min(d.Sc(),d.dc()+f);break;case 1:k=Math.min(d.Uc(),d.Zb()+f)}d=bUb(d.mb(),h,k,d.Sc(),d.Uc());AW(b,oG(d));AW(a.D,
oG(c))}
function lUf(a){var b=a.k0a,c=a.j0a,d=a.SZa;a=a.taa;return S('<div class="waffle-sidebar-overlay"><div class="waffle-tables-popup" aria-label="'+T(b)+'"><div class="waffle-tables-popup-header"><div class="waffle-tables-popup-title">'+R(b)+'</div></div><div class="waffle-tables-popup-content">'+R(c)+'<div class="waffle-assistant-canvas-container"><canvas class="waffle-assistant-table-canvas"></canvas></div></div><div class="waffle-tables-popup-buttons"><div class="waffle-tables-popup-button waffle-tables-popup-done">'+R(d)+
'</div><div class="waffle-tables-popup-button waffle-tables-popup-cancel">'+R(a)+"</div></div></div></div>")}
function mUf(){var a=S('<div class="waffle-assistant-tables-recommendation"><div class="waffle-assistant-table-range-container"><div class="waffle-assistant-tables-range-wrapper waffle-assistant-tables-data-range-wrapper"><label id="waffle-assistant-tables-data-range-label">Data Range</label><div class="waffle-assistant-tables-edit-sheet-button"></div></div><div class="waffle-assistant-tables-range-error" style="display:none">Invalid range</div></div><div class="waffle-assistant-header-range-container"><div class="waffle-assistant-tables-range-wrapper"><div class="waffle-assistant-tables-edit-headers-button"></div></div></div></div>');a=
""+lUf({k0a:"Edit data range",j0a:hx(""+a),SZa:"Update",taa:"Cancel"});return S(a)}function nUf(){var a=""+lUf({k0a:"Improve suggestions",j0a:hx('<div class="waffle-tables-popup-header-message"></div>'),SZa:"No",taa:"Yes"});return S(a)}function oUf(a){a='<div class="waffle-tables-bar-content">For <span class="waffle-assistant-table-bar-range">'+(R(a.eD)+"</span></div>");return S(a)}
function pUf(a){a='Is <span class="waffle-assistant-table-first-header">'+(R(a.aS)+"</span> a header row, containing titles that describe the columns below?");return S(a)}function qUf(a,b,c,d,e,f,h){l_.call(this,a,ICb,d,e,f);this.F=KB(new JB);this.qa(this.F);this.J=new iz("",new oR,this.oa());this.Ga(this.J);Xz(this.F,this.J,JCb);this.H=new iz("",new oR,this.oa());this.Ga(this.H);Xz(this.F,this.H,ICb);this.V=new jUf(b,c);this.qa(this.V);this.O=new Tz(this);this.qa(this.O);this.xa=h}t(qUf,l_);
qUf.prototype.Ca=function(){this.pb(zy(nUf))};
qUf.prototype.Ia=function(){l_.prototype.Ia.call(this);this.J.Wa(this.Fa("waffle-tables-popup-done"));this.H.Wa(this.Fa("waffle-tables-popup-cancel"));var a=OSf(this.C,this.D,1);a=gM(pG(a));a=zy(pUf,{aS:a});this.Fa("waffle-tables-popup-header-message").appendChild(a);this.O.subscribe(JCb,"action",this.Ba).subscribe(ICb,"action",this.ma);a=this.Fa("waffle-assistant-table-canvas");var b=this.Fa("waffle-assistant-canvas-container");kUf(this.V,a,b,this.C,this.D,this.L);a=this.Fa("waffle-tables-popup");
Hx(a,"waffle-tables-popup-answers-enabled",this.xa);b=new FB(a,this.oa());this.qa(b);GB(b);a.focus()};qUf.prototype.ma=function(){this.dispatchEvent("ge")};qUf.prototype.Ba=function(){var a=pG(this.C);switch(this.D){case 0:a=Kn(a.top+1,a.left,a.top+a.height,a.left+a.width);break;case 1:a=Kn(a.top,a.left+1,a.top+a.height,a.left+a.width)}var b=this.L-1,c=this.C.mb();this.dispatchEvent(new iUf(new Ln(c,a),b,this.D));this.dispatchEvent("ge")};
function rUf(a,b,c,d,e,f,h,k,l,n,q){oW.call(this,l,q);this.Xa=b;this.cb=c;this.Qa=d;this.fb=n;this.Ja=e;this.Sa=h;this.L=new iz("",new oR,this.oa());this.Ga(this.L);this.ma=new iz("",new oR,this.oa());this.Ga(this.ma);this.C=this.R=this.F=null;this.Va=this.cb.L.C;this.Ba=ez(az(new $y,66));this.Ma=f;this.xa=new yW(f,"waffle-assistant-highlight-styled-border","waffle-assistant-highlight-styled-rect");this.qa(this.xa);this.Ra=$g(l,4);this.D=null}t(rUf,oW);m=rUf.prototype;m.XI=ea(!0);
m.Ca=function(){oW.prototype.Ca.call(this);pW(this).appendChild(zy(PSf));e4e(this).appendChild(zy(QSf))};
m.Ia=function(){var a=this;oW.prototype.Ia.call(this);var b=C(this.H,5);b=t5e(this.Sa,b);this.R=new B5e(b,this.Va,this.fb);b=this.Fa("waffle-assistant-insert-pivottable-button");this.L.Wa(b);lW(b,"Insert Pivot Table");b=this.Fa("waffle-assistant-zoom-button");this.ma.Wa(b);lW(b,"Preview Pivot Table");this.getHandler().listen(this.L,"action",function(){sUf(a,35619)}).listen(this.ma,"action",this.cXa);this.kx(this.Pd())};
m.sC=function(a){var b=this.oa();b.Be(this.Fa("waffle-assistant-answercard-interpret"),ah(this.H,3));this.C=b.Ca("CANVAS","waffle-pivottable-pivot-canvas");b.Ti(this.C,!0);zx(this.C,"Pivot table canvas");var c=this.Fa("waffle-assistant-answercard-pivot-content");b.appendChild(c,this.C);b=C(this.H,5);this.D=new A5e(c,this.Ma,this.Xa,this.Qa);this.D.H=b;c=this.Pd();this.D.F=c;this.getHandler().Qf(this.C,So,this.cXa).listen(this.C,"mousedown",this.bXa).Nc(this.D,"pivot_inserted",this.ZXb);C5e(this.R,
this.C);a()};m.ZXb=ba();m.kx=function(a){oW.prototype.kx.call(this,a);if(this.L&&this.tb()){this.L.setVisible(!a);var b=this.oa().Fa("waffle-assistant-button-separator",e4e(this));P(b,!a)}this.F&&F5e(this.F,this.Pd());this.D&&(a=this.Pd(),this.D.F=a)};m.lD=function(){zx(this.La(),"Suggested Pivot Table-"+ah(this.H,3))};m.YD=ea("assistantPivotTableFeedback");m.zH=ea(2632);m.yH=ea(2631);
function sUf(a,b){Vg(a.H,5)&&z(y(),"fewt")&&Upa(C(a.H,5),1);var c=new I5e(null,C(a.H,5),function(){a.dispatchEvent("close-sidebar");a.Ja.C(b,a.Ba)});sJ.dispatchEvent(c)}m.cXa=function(){var a=this;this.Ja.C(35620,this.Ba);this.F=new E5e(this.R,ah(this.H,3),function(){sUf(a,35621)},function(){a.bXa()},this.oa());this.F.render();this.qa(this.F);F5e(this.F,this.Pd())};m.bXa=function(){this.C&&this.C.focus()};m.VS=function(){oW.prototype.VS.call(this);H5e(this.xa,qo(this.Ra))};
m.qN=function(){oW.prototype.qN.call(this);zW(this.xa)};function tUf(a,b,c,d,e,f,h,k,l){k_.call(this,1,f,e,l);this.H=d;this.Ba=b;this.Da=c;this.F=h;this.Ja=k;this.J=ez(az(new $y,10));a=new bO(a,!0,!0);this.O=new p5e(a);this.D=null}t(tUf,k_);m=tUf.prototype;m.getTitle=ea("Pivot Table");m.X1=function(a){return 1==a};
m.dW=function(a){var b=C(a,1);switch(b){case 1:return new rUf(this.D,this.Ba,this.Da,this.H,this.R,this.F,this.O,this.J,a,this.Ja,this.oa());default:throw Error("Unsupported recommendation type: "+b);}};m.XS=function(a,b){C(a[0],5)&&(this.D=b?b:null,k_.prototype.XS.call(this,a,b))};m.l7=ea(5);function uUf(){var a=null,b=new tq(function(){null!==a&&fq(a)});a=eq(function(){b.callback()});return b}function vUf(a,b,c){Wo.call(this);this.C=ssc(wM.getInstance(),a,b,c);this.D=yq()}t(vUf,Wo);
vUf.prototype.update=function(a,b,c){var d=this,e=this.C.C;c&&e&&!id(c,function(f){return WBa(f,e.rect)},this)||!a&&e&&c&&1==c.length&&1==c[0].Pi()&&e.rect.contains(c[0])||(this.D.cancel(!0),a&&aYe(this.C),this.D=uUf(),this.D.addCallback(function(){return BYe(d.C,b,!0)}))};
function wUf(a,b){a=a.l7b;var c='<div class="waffle-autovis-lightbox"><div class="waffle-autovis-lightbox-header"><div class="waffle-autovis-lightbox-buttons-wrapper">'+R(aA({content:"INSERT CHART",style:4,cd:"goog-inline-block waffle-autovis-lightbox-button waffle-autovis-lightbox-insert waffle-autovis-lightbox-readonly-hidden"},b));c+=R(aA({cd:"waffle-autovis-lightbox-close",content:hx(""+R(yB({icon:"docs-icon-img docs-icon-close-white"},b))),style:4,title:"Close"},b));c+='</div></div><div class="waffle-autovis-lightbox-content"><div class="waffle-autovis-lightbox-content-inner">';
var d='aria-label="'+jx("Previous chart");d+='"';c+=R(aA({content:hx("&#10094;"),style:4,cd:"goog-inline-block waffle-autovis-lightbox-button waffle-autovis-lightbox-previous",attributes:ix(d)},b));c+='<div class="goog-inline-block waffle-autovis-lightbox-container"></div>';d='aria-label="'+jx("Next chart");d+='"';c+=R(aA({content:hx("&#10095;"),style:4,cd:"goog-inline-block waffle-autovis-lightbox-button waffle-autovis-lightbox-next",attributes:ix(d)},b));c+='</div><div class="waffle-autovis-lightbox-page-count"><span class="waffle-autovis-lightbox-page-number"></span>/'+
R(a)+"</div></div></div>";return S(c)}function xUf(){return S('<div class="waffle-autovis-lightbox-chart"></div>')}function yUf(a,b,c,d,e){Q.call(this,e);this.F=a;this.D=b;this.V=c;this.R=d;this.H=[];this.C=new bA("",this.oa());this.Ga(this.C);this.O=new bA("",this.oa());this.Ga(this.O);this.L=new bA("",this.oa());this.Ga(this.L);this.J=new bA("",this.oa());this.Ga(this.J)}t(yUf,Q);m=yUf.prototype;m.Ca=function(){Q.prototype.Ca.call(this);this.pb(zy(wUf,{l7b:this.F.length}))};
m.Ia=function(){Q.prototype.Ia.call(this);var a=eub.isEnabled();zUf(this,!a);a=this.Fa("waffle-autovis-lightbox-close");this.C.Wa(a);a=this.Fa("waffle-autovis-lightbox-insert");this.O.Wa(a);var b=this.Fa("waffle-autovis-lightbox-previous");this.L.Wa(b);b=this.Fa("waffle-autovis-lightbox-next");this.J.Wa(b);AUf(this);BUf(this,this.D,!1);this.getHandler().listen(document.body,"focusin",this.lYb).listen(this.La(),"keydown",this.mYb).listen(kp(),"resize",this.pYb).listen(this.C,"action",this.close).listen(this.O,
"action",this.wAb).listen(this.L,"action",this.oYb).listen(this.J,"action",this.nYb);b=new FB(this.La(),this.oa());GB(b);this.qa(b);a.focus()};function AUf(a){var b=a.Fa("waffle-autovis-lightbox-content"),c=a.Fa("waffle-autovis-lightbox-content-inner");a=a.Fa("waffle-autovis-lightbox-page-count");var d=jp();a=Hw(a);var e=d.height-a.height-195,f=d.width-200;.75<e/f?(d=f,e=.75*f):d=e/.75;Ew(c,d,e);Ew(b,d,e+a.height+35)}function zUf(a,b){Hx(a.La(),"waffle-autovis-lightbox-readonly",b)}
function BUf(a,b,c){c&&uJ("Page "+(b+1+(" of "+(a.F.length+"."))));a.H[b]?CUf(a,b):a.F[b]&&(z(y(),"fecpmr")?(c=a.F[b].createChartModel(),DUf(a,c,b)):sTf(a.F[b],function(d){if(!a.isDisposed()&&d){var e=d.Se();e=e?e.toJSON():null;var f=ritz.charts.model.GvizChart.create();f.updateChartWrapperJsonString(d.toJSON());e&&f.updateDataTableJsonString(e);DUf(a,f,b)}},!0))}function DUf(a,b,c){var d=a.Fa("waffle-autovis-lightbox-container"),e=zy(xUf);d.appendChild(e);a.H[c]=e;Y7e(b,e,a.V,a.R);CUf(a,c)}
function CUf(a,b){P(a.H[a.D],!1);P(a.H[b],!0);a.L.Pa(0!=b);a.J.Pa(b!=a.F.length-1);var c=a.Fa("waffle-autovis-lightbox-page-number");Ep(c,b+1);a.D=b}m.lYb=function(a){!Cp(this.La(),a.target)&&a.relatedTarget&&a.relatedTarget.focus()};m.mYb=function(a){27==a.keyCode?this.close():37==a.keyCode||38==a.keyCode?0!=this.D&&BUf(this,this.D-1,!0):39!=a.keyCode&&40!=a.keyCode||EUf(this);a.stopPropagation()};
m.pYb=function(){var a=this.Fa("waffle-autovis-lightbox-container");up(a);this.H=[];AUf(this);BUf(this,this.D,!0)};m.wAb=function(){this.close();vTf(this.F[this.D],2256)};m.oYb=function(){0!=this.D&&BUf(this,this.D-1,!0);0==this.D&&this.J.La().focus()};m.nYb=function(){EUf(this);this.D==this.F.length-1&&this.L.La().focus()};function EUf(a){a.D!=a.F.length-1&&BUf(a,a.D+1,!0)}m.close=function(){this.dispose()};m.xd=function(){Q.prototype.xd.call(this);var a=this.F[this.D];a&&a.La()&&a.La().focus()};
function FUf(a){var b=a.name;a='<div class="waffle-assistant-quicksum-entry" tabindex="0"><span class="waffle-assistant-quicksum-entry-name" title="'+T(a.title)+'">'+R(b)+'</span><span class="waffle-assistant-quicksum-entry-value"></span><span aria-label="';a+=jx("Press enter to insert formula");return S(a+'"></span></div>')}function GUf(a,b){Q.call(this);this.C=a;this.D=b}t(GUf,Q);m=GUf.prototype;m.Ca=function(){var a=zy(FUf,{name:this.C,title:this.D});this.pb(a)};
m.Ia=function(){Q.prototype.Ia.call(this);var a=this.Fa("waffle-assistant-quicksum-entry-name");lW(a);this.getHandler().listen(this.La(),"keypress",this.qXb);P(this.La(),!1)};m.getFunctionName=g("C");m.setValue=function(a){Ep(this.Fa("waffle-assistant-quicksum-entry-value"),a||"");P(this.La(),!!a)};m.isVisible=function(){return Kw(this.La())};m.qXb=function(a){13==a.keyCode&&(a.stopPropagation(),a.preventDefault(),this.dispatchEvent(new Ko("insert",this)))};
function HUf(a,b,c,d,e){Q.call(this,e);this.Ja=a;this.Da=b;this.L=c;this.O=d;this.D=a.C;this.ma=ez(az(new $y,17));this.V=ez(az(new $y,2));this.R=!1;this.F=[];this.C=this.J=null;this.H=[]}t(HUf,Q);
HUf.prototype.Ia=function(){Q.prototype.Ia.call(this);this.Ff(new GUf(ritz_api.RitzModelApi.getLocalizedFunctionName("SUM"),"Sum"),0,!0);this.Ff(new GUf(ritz_api.RitzModelApi.getLocalizedFunctionName("AVERAGE"),"Average"),1,!0);this.Ff(new GUf(ritz_api.RitzModelApi.getLocalizedFunctionName("MIN"),"Minimum"),2,!0);this.Ff(new GUf(ritz_api.RitzModelApi.getLocalizedFunctionName("MAX"),"Maximum"),3,!0);this.Ff(new GUf(ritz_api.RitzModelApi.getLocalizedFunctionName("COUNTA"),"Count all"),4,!0);this.C=
new n5e(this.La(),this.Da,this.D,this.L);this.C.F=this.R;this.qa(this.C);this.getHandler().listen(this,"insert",this.xa).listen(this.C,"formula_inserted",this.Ba)};
HUf.prototype.refresh=function(a){function b(l){return h&&null!=l?ritz_api.RitzModelApi.renderNumberAsFormattedString(l,k):null}if(mI(this.D)){if(null==a){var c=pI(this.D),d=SI(c);a=jI(this.D);if(!hd(d,c.Er,c)){P(this.La(),!1);return}c=[];for(var e=0;e<d.length;e++){var f=d[e];f=bUb(a,f.dc(),f.Zb(),f.Sc(),f.Uc());c.push(f)}a=c}d=[];this.F=[];for(c=0;c<a.length;c++)e=a[c],this.F.push(pG(e)),d.push(e.sb());a=a[0].mb();this.J=null;a!=jI(this.D)&&(this.J=(a=cI(this.D,a))?a.we():null);if(d=ritz_api.RitzModelApi.quickSum(d)){P(this.La(),
!0);a=d.count;c=d.countNumberFormat;var h=1<d.numericCount,k=h?d.valueNumberFormat:null;this.Ac(0).setValue(b(d.sum));this.Ac(1).setValue(b(d.average));this.Ac(2).setValue(b(d.min));this.Ac(3).setValue(b(d.max));1<a?this.Ac(4).setValue(ritz_api.RitzModelApi.renderNumberAsFormattedString(a,c)):P(this.La(),!1);if(this.C){this.C.H=[];this.H=[];for(d=0;d<this.mc();++d)a=this.Ac(d),this.H.push(IUf(this,a.getFunctionName()));this.C.H=this.H}}else P(this.La(),!1)}else P(this.La(),!1)};
HUf.prototype.xa=function(a){var b=a.target;a=this.F[0];a=new Um(a.left,a.Sc());b=b.getFunctionName();b=IUf(this,b);a=new Uvd(pI(this.D),sn(a),b);this.L.C(a);this.O.C(2624,this.V)};HUf.prototype.Ba=function(){this.O.C(2624,this.ma)};function IUf(a,b){var c=a.Ja.L.D,d=a.J;a=ed(a.F,function(e){return gM(e,d)});return"="+b+"("+a.join(c)+")"}
function m_(a,b,c,d,e,f,h){BW.call(this,h);this.Va=a;this.ub=b.C;this.Ne=vM(b);this.Ba=c;this.hd=d;this.J=f;this.Ud=e;this.Ma=new HUf(b,c,d,f,this.oa());this.Ga(this.Ma);this.L=null;this.rb=this.Mb=!1;this.jb=!0;this.Fd=cl();this.Cb=this.fb=this.cb=null;this.Ja=ez(az(new $y,10))}t(m_,BW);m=m_.prototype;m.Ca=function(){BW.prototype.Ca.call(this);this.pb(zy(JUf,{nU:this.Ne}))};
m.Ia=function(){BW.prototype.Ia.call(this);var a=this.Fa("waffle-assistant-quicksum-panel");this.Ma.Wa(a);a=this.Fa("waffle-assistant-spinner-container");this.ze.render(a);a=this.ze;a.C="#4285f4";a.tb()&&Z3e(a);a=this.Va.C;this.getHandler().listen(this,"close-sidebar",this.bva).listen(a,"recommender-load-started",this.Lua).listen(a,"recommender-load-ended",this.Kua).listen(a,"recommender-calc-started",this.$ta).listen(a,"recommender-calc-ended",this.Zta).listen(this.Fa("waffle-assistant-scroll-pane"),
"scroll",YYe(this.Rha,10,this));a=eub.isEnabled();this.Qha(!a)};m.resize=function(){var a=this.Fa("waffle-assistant-sidepane-content");a=Hw(a).height;var b=this.Fa("waffle-assistant-spinner-container");tw(b,"margin-top",a/2-16+"px");this.Rha()};m.aXa=ba();function KUf(a,b){var c=LUf(a);0!=c.length&&(Tf(a.L),c=c.filter(function(d){return d instanceof qTf}),b=c.indexOf(b),0<c.length&&-1!=b&&(a.L=new yUf(c,b,a.Ud,a.J,a.oa()),a.L.render(),a.qa(a.L),zUf(a.L,a.rb)))}
m.Qha=function(a){this.rb=a;Hx(this.La(),"waffle-assistant-readonly",a);var b=this.Ma;b.R=a;b.C&&(b.C.F=a);Hx(b.La(),"waffle-assistant-quicksum-panel-readonly",a);this.L&&!this.L.isDisposed()&&zUf(this.L,a)};
m.setVisible=function(a){var b=this.isVisible();BW.prototype.setVisible.call(this,a);if(a&&!b){var c=hYe(this.Va.C,a);c?(b=new e$d,L(b,1,Hn(c,"r")),L(b,2,Hn(c,"c")),L(b,3,c.Pi()),c=new Dk,Zj(c,4,b),b=ez(dz(fz(this.Ja),c))):b=this.Ja;this.fb=dl(this.Fd,"sett",!1,b);this.ze.setActive(!0);MUf(this)}a||NUf(this,!0)};m.Lua=function(){this.isVisible()&&(NUf(this,!0),this.ze.setActive(!0))};m.Kua=function(){this.isVisible()&&this.ze.setActive(!1)};
m.$ta=function(a){this.isVisible()&&(this.J.C(2775,this.Ja),NUf(this,void 0,a.C,a.D),OUf(this)||this.ze.setActive(!0),MUf(this),this.jb=!1)};
m.Zta=function(a){if(this.isVisible()){this.J.C(2776,this.Ja);var b=a.C;0<b.length&&(this.cb=dl(this.Fd,"serr"));NUf(this,!1);this.ze.setActive(!1);a=a.D;var c=oV(this.Va.C),d=this.V.C.getActiveGrid();c=!!c&&!!d&&c.mb()!=d.mb();d=ja(this.D);for(var e=d.next();!e.done;e=d.next()){e=e.value;for(var f=[],h=ja(b),k=h.next();!k.done;k=h.next()){k=k.value;var l=ah(k,1),n;if(!(n=!e.X1(l))&&(n=c)){a:switch(l){case 2:case 4:case 6:l=!1;break a;default:l=!0}n=!l}n||f.push(k)}0<f.length?e.XS(f,a):e.YS(!0)}b=
ja(b);for(a=b.next();!a.done;a=b.next())if(a=a.value,5==ah(a,1)){this.Caa();this.Da=C(a,12);this.H=(c=BV(a))?fUe(oo(c)):null;this.xa=C(a,11);PUf(this);a=this.H;c=!1;for(d=this.Qa.length-1;0<=d;d--)e=this.Qa[d],f=a,Tn(e,1)&&e.mb()==f.mb()&&MSf(lG(e),lG(f))&&MSf(mG(e),mG(f))&&(c=!0,this.Qa.splice(d,1));this.Qa.push(a);a=c;2!=this.Da||a||QUf(this,!0)}b=LUf(this);0<b.length&&this.Mb&&(b[b.length-1].Vd=!0);this.Mb=!1;MUf(this);RUf(this);this.Rha()}};
function MUf(a){var b=OUf(a),c=Kw(a.Fa("waffle-assistant-quicksum-panel")),d=a.ze.Fb();b=b||c||d;c=a.Fa("waffle-assistant-empty-list");P(c,!b);P(a.ze.La(),b)}m.Oc=ba();m.pBa=ba();m.Pd=g("rb");m.bva=ba();m.GRb=function(){this.cb&&(this.cb.complete(),this.cb=null);this.fb&&(this.fb.complete(),this.fb=null);this.Cb=Ra();this.jb||(this.J.C(2777,this.Ja),this.jb=!0)};
function SUf(){return S('<div class="waffle-assistant-title-bar"><div class="waffle-assistant-title-icon">'+R(suc({color:"#ffffff",iconSize:"21"}))+'</div><div class="waffle-assistant-title-text">'+R("Explore")+"</div></div>")}
function JUf(a,b){a=a||{};var c=S,d=hx('<div class="waffle-assistant-replaceable-title">'+SUf(null,b)+"</div>");var e=e=a||{};e=e.nU;var f='<div class="waffle-assistant-empty-list" style="display: none"><div class="waffle-assistant-empty-list-content" aria-live="polite">'+R(suc({color:"rgb(46%, 46%, 46%)",iconSize:"40"}))+'<div class="waffle-assistant-empty-list-title">';f+='Get insights instantly</div><div class="waffle-assistant-empty-list-body">';f=(e?f+"To see answers, formatting, and charts in a single click, try adding more data or selecting different cells in your spreadsheet.":
f+"To see formatting and charts in a single click, try adding more data or selecting different cells in your spreadsheet.")+'</div><div class="waffle-assistant-empty-list-learn-more waffle-assistant-empty-list-link"><span>Learn more';f+='</span></div><div class="waffle-assistant-empty-list-link"><a href="https://docs.google.com/spreadsheets/d/1Hh2grfB6rp9OQ2yAIu3S5YF_CCFJGwyqPGveABlOZKg/copy" target="_blank">';f+="Try it out";f+="</a></div></div></div>";e=S(f);e=S('<div class="waffle-sidebar-tables-bar" style="display: none"><div class="waffle-assistant-sidepane-tables-range"></div><div class="waffle-assistant-tables-edit-range-button">Edit</div></div><div class="waffle-assistant-scroll-pane"><div class="waffle-assistant-scroll-pane-content"><div class="waffle-assistant-scroll-pane-feature-content">'+
(e+'<div class="waffle-assistant-spinner-container"></div><div class="waffle-assistant-quicksum-panel" style="display: none"></div><div class="waffle-assistant-features"></div></div><div class="waffle-assistant-expanded-panel" style="display: none"></div></div></div>'));return c(R(XW(ex({title:d,yl:hx(""+e),id:"autovis",xx:"waffle-assistant-sidepanel",$ka:"waffle-assistant-title",bW:"waffle-assistant-sidepane-content"},a),b)))}
function TUf(a,b,c,d,e,f,h,k,l,n){l_.call(this,a,DCb,d,e,f);var q=this;this.Ma=n;this.cb=b;this.Ja=d;this.ob=e;this.rb=f;a=pG(d);this.J=gM(a);this.O=d.mb();this.Ra=new jUf(b,c);this.qa(this.Ra);this.H=this.F=null;this.xa=h;this.V=KB(new JB);this.qa(this.V);this.Da=new iz("",new oR,this.oa());this.Ga(this.Da);Xz(this.V,this.Da,FCb);this.Ba=new iz("",new oR,this.oa());this.Ga(this.Ba);Xz(this.V,this.Ba,DCb);b=this.R.C.C.we();this.ma=new LW(this.cb,function(r,w,x){UUf(q,r,w,x)},!1,"e.g., A2:D5",!0,b,
this.oa());this.Ga(this.ma);this.Qa=null;this.Sa=new Tz(this);this.qa(this.Sa);this.fb=k;this.jb=l}t(TUf,l_);m=TUf.prototype;m.Ca=function(){this.pb(zy(mUf))};
m.Ia=function(){l_.prototype.Ia.call(this);this.Da.Wa(this.Fa("waffle-tables-popup-done"));this.Ba.Wa(this.Fa("waffle-tables-popup-cancel"));this.ma.render(this.Fa("waffle-assistant-tables-data-range-wrapper"));var a=this.Fa("waffle-range-selection-input");wx(a,"labelledby","waffle-assistant-tables-data-range-label");this.getHandler().listen(a,"keydown",this.cYb).listen(a,"keyup",this.dYb).listen(a,"focusout",this.lLb).listen(this.R.C,"xa",this.fYb).listen(this.ma,"change",this.eYb);this.Sa.subscribe(FCb,
"action",this.gYb).subscribe(DCb,"action",this.Urb);VUf(this);a=this.Fa("waffle-tables-popup");Hx(a,"waffle-tables-popup-answers-enabled",this.jb);var b=new FB(a,this.oa());this.qa(b);GB(b);a.focus()};m.Ka=function(){Tf(this.Qa);l_.prototype.Ka.call(this)};function UUf(a,b,c,d){OV(a.fb,null,b,c,d,!1,void 0,function(e){a.Qa=e})}
m.fYb=function(){for(var a=this.R.C,b=!0,c=ja(z1b(a)),d=c.next();!d.done;d=c.next())if((d=d.value)&&d.mb()==this.O){b=!1;break}b&&"number"===typeof iI(a)&&(this.O=iI(a),WUf(this,this.O));XUf(this)};function YUf(a){var b=a.Fa("waffle-assistant-table-canvas"),c=a.Fa("waffle-assistant-canvas-container");kUf(a.Ra,b,c,a.C,a.D,a.L)}m.Urb=function(){this.dispatchEvent("ge")};
m.gYb=function(){var a=!dqc.test(this.J);P(this.eb("waffle-assistant-tables-range-error"),a);Hx(this.Fa("waffle-assistant-tables-data-range-wrapper"),"waffle-assistant-tables-range-error-input",a);if(!a){a=this.ob!=this.L||this.rb!=this.D;var b=!this.Ja.equals(this.C),c=this.Ja.mb()!=this.C.mb();if(a||b)a&&this.xa.C(35506),b&&this.xa.C(35507),c&&this.xa.C(35723),this.dispatchEvent(new iUf(oG(this.C),this.L,this.D,c));this.dispatchEvent("ge")}};
function VUf(a){var b=a.Fa("waffle-range-selection-input"),c=pG(a.Ja);a.J=gM(c);b.value=a.J;XUf(a);ZUf(a);YUf(a)}m.Sha=function(a,b,c){l_.prototype.Sha.call(this,a,b,c);YUf(this)};
function $Uf(a){var b=qI(a.R.C,a.O),c=b.Jb(),d=gqc(a.J,b),e=null!=d;if(e&&(b=E4b(b,d),e=Jn(b))){b=nG(b,c);var f=lG(b);c=mG(b);b=b.mb();d=ko(f);f=Tn(f,2)?Wn(f,2):ritz_api.RitzModelApi.getNumberOfRows(b);var h=ko(c);c=Tn(c,2)?Wn(c,2):ritz_api.RitzModelApi.getNumberOfColumns(b);c=bUb(b,d,h,f,c);a.Sha(c,aVf(a,c),a.D);XUf(a);ZUf(a)}P(a.eb("waffle-assistant-tables-range-error"),!e)}function aVf(a,b){b=bVf(b,a.D);return a.L>b?b:a.L}
function bVf(a,b){a=0==b?a.Sc()-a.dc():a.Uc()-a.Zb();return 0==a?3:Math.min(a-1,3)}
function XUf(a){if(a.Ma){P(Kp(a.oa(),"waffle-assistant-tables-data-range-label"),!1);Tf(a.H);var b=z(y(),"feuuc")?EG.getInstance():$ze.getInstance();a.H=new eW(void 0,b);a.H.setContent("Data Range");a.Ga(a.H);Xz(a.V,a.H,GCb);a.H.render(a.Fa("waffle-assistant-tables-edit-sheet-button"));a.getHandler().listen(a.H,"action",a.qJb);b=0;for(var c=ja(z1b(a.R.C)),d=c.next();!d.done;d=c.next())if(d=d.value)d.mb()===a.O&&(b=a.H.Oh()),a.H.Tc(new mz(d.we(),d.mb()));a.H.Ef(b)}}
function ZUf(a){Tf(a.F);a.F=new eW(void 0,EG.getInstance());a.Ga(a.F);Xz(a.V,a.F,ECb);a.F.render(a.Fa("waffle-assistant-tables-edit-headers-button"));a.getHandler().listen(a.F,"action",a.nzb);for(var b=bVf(a.C,0),c=0;c<=b;c++){var d=(new RA("{NUM_HEADER_RECORDS, plural,=0 {No rows}=1 {1 row}other {# rows}}")).format({NUM_HEADER_RECORDS:c});a.F.Tc(new mz(d))}c=bVf(a.C,1);for(d=0;d<=c;d++){var e=(new RA("{NUM_HEADER_RECORDS, plural,=0 {No columns}=1 {1 column}other {# columns}}")).format({NUM_HEADER_RECORDS:d});
a.F.Tc(new mz(e))}c=a.L;a.F.Ef(0==a.D?c:c+b+1);a.F.setContent("Headers")}m.lLb=function(){var a=this.Fa("waffle-range-selection-input");this.J!=a.value&&(this.J=a.value,$Uf(this))};m.eYb=function(){var a=this.ma.getValue();this.J=a;var b=this.Fa("waffle-range-selection-input");b.value=a;b.select();$Uf(this)};m.qJb=function(){var a=this.H.getValue();a!=this.O&&(this.O=a,WUf(this,this.O));$Uf(this)};
function WUf(a,b){if(a.Ma){var c=qI(a.R.C,b),d=vn(SI(c));ritz_api.TablesApi.getTables(nG(d,b).sb(),function(e){if(e.length){var f=e[0];e=f.getDimensionTableAccessor().getHeaderRange();var h=pG(jo(ritz_api.RitzModelApi.toSerializedGridRangeProto(e)));e=f.getDimensionTableAccessor().getDimensionTagName();h=Hn(h,0==e?"r":"c");f=pG(jo(ritz_api.TablesApi.getTableGridRange(f)))}else f=d,e=h=0;a.D=e;a.L=h;e=gM(f);a.J=e;e=a.Fa("waffle-range-selection-input");e.value=a.J;e.select();$Uf(a)})}}
m.cYb=function(a){var b=this.Fa("waffle-range-selection-input");switch(a.keyCode){case 13:a.stopPropagation();a.preventDefault();this.J=b.value;$Uf(this);FCb.qb();break;case 27:a.stopPropagation(),a.preventDefault(),VUf(this),DCb.qb()}};m.dYb=function(){this.J=this.Fa("waffle-range-selection-input").value;$Uf(this)};m.nzb=function(){var a=this.F.ai(),b=bVf(this.C,0);this.Sha(this.C,a-(0==(a>b?1:0)?0:b+1),a>b?1:0)};
function cVf(a,b,c,d,e,f,h,k,l,n,q,r){m_.call(this,a,b,c,e,d,f,r);this.vd=n;this.Pc=h;this.V=b;this.Xa=new Q(this.oa());this.Ga(this.Xa);this.R=new M5e(q);this.qa(this.R);this.D=[];this.F=null;this.Ra=new bA("",r,4);Qy(this.Ra,2,!1);this.Ga(this.Ra);this.Yc=k;this.Lc=l;this.H=null;this.Da=0;this.xa=null;this.ob=new iz("",new oR,this.oa());this.Ga(this.ob);this.Gb=new Q(this.oa());this.Ga(this.Gb);this.Dc=KB(new JB);this.qa(this.Dc);Xz(this.Dc,this.ob,HCb);this.ma=this.O=null;this.Qa=[]}t(cVf,m_);
m=cVf.prototype;
m.Ia=function(){var a=this;m_.prototype.Ia.call(this);this.Xa.Wa(this.Fa("waffle-assistant-expanded-panel"));lW(this.C.La(),"Close");this.Gb.Wa(this.Fa("waffle-assistant-sidepane-tables-range"));PUf(this);this.ob.Wa(this.Fa("waffle-assistant-tables-edit-range-button"));if(vM(this.V)){var b=new OTf(this.Pc,this.Ba,this.ub,this.hd,this.J,this.R,this.V,this.Lc,this.vd,this.oa());this.Ga(b);this.D.push(b)}b=new hUf(this.J,this.R,this.oa());this.Ga(b);this.D.push(b);z(y(),"feedvs")&&(b=new YTf(this.J,
this.R,this.Ba,this.oa()),this.Ga(b),this.D.push(b));b=new tUf(this.Pc,this.ub,this.V,this.hd,this.J,this.R,this.Ba,this.vd,this.oa());this.Ga(b);this.D.push(b);b=new MTf(this.ub,this.Ba,this.Ud,this.J,this.R,this.oa());this.Ga(b);this.D.push(b);var c=this.Fa("waffle-assistant-features");$c(this.D,function(d){d.render(c);a.Xa.Ga(d.C,!0)});this.Ra.Wa(this.Fa("waffle-assistant-empty-list-learn-more"));this.getHandler().listen(this.Ra,"action",this.QXb).listen(this,"ge",this.Caa).listen(this,"fe",this.RXb);
dVf(this)};m.RXb=function(){var a=eVf(this);a&&(a.Ra=!0)};m.QXb=function(){(Ot(),Ev).qb(bAe)};function RUf(a){$c(a.D,function(b){HTf(b)})}function NUf(a,b,c,d){$c(a.D,function(e){e.YS(b,c,d)})}function OUf(a){return!!id(a.D,function(b){return b.mva()})}m.Rha=function(){var a=this,b=this.Fa("waffle-assistant-scroll-pane").scrollTop+Hw(this.Fa("waffle-assistant-sidepane-content")).height;$c(this.D,function(c){a.F&&a.F!=c||(c instanceof MTf&&a.getHandler().Nc(c,"ae",a.GRb),b=c.m7(b))})};
function LUf(a){if(a.F)return a.F.C.C;var b=[];$c(a.D,function(c){ud(b,GTf(c))});return b}m.Qha=function(a){m_.prototype.Qha.call(this,a);dVf(this)};m.aXa=function(a){$c(this.D,function(b){b.YWa(a)})};m.pBa=function(){var a=this.Fa("waffle-assistant-replaceable-title"),b=this.Fa("waffle-assistant-title");Gw(b,Hw(a).height)};
m.Oc=function(){var a=this,b=this.Fa("waffle-assistant-scroll-pane-feature-content"),c=this.Fa("waffle-assistant-replaceable-title"),d=this.Xa.La();if(this.F)this.F.C.setVisible(!1),this.F.setActive(!1),this.F=null,P(d,!1),P(b,!0),xy(c,SUf),xx(c,"label"),this.resize(),uJ("Explore Opened");else if(this.F=id(this.D,function(e){return e.Fb()}))P(b,!1),P(d,!0),this.F.C.setVisible(!0),ITf(this.F,c),zx(c,this.F.getTitle()),b=this.F.getTitle()+" section expanded.",uJ(b);this.pBa();b=new Qq(function(){var e=
kC.Qz();e&&e.dispatchEvent("resize");a.Rha()},300);this.qa(b);b.start()};m.setVisible=function(a){var b=this.isVisible();m_.prototype.setVisible.call(this,a);a&&!b&&fVf(this,!0);a||this.R.clear()};m.bva=function(){m_.prototype.bva.call(this);this.F&&this.Oc();this.Caa()};m.Lua=function(){m_.prototype.Lua.call(this);fVf(this,!0)};m.Kua=function(){m_.prototype.Kua.call(this);fVf(this,!1)};m.$ta=function(a){m_.prototype.$ta.call(this,a);fVf(this,!0,a.C)};
m.Zta=function(a){m_.prototype.Zta.call(this,a);fVf(this,!1)};function gVf(a,b){var c=eVf(a);if(b){var d=z(y(),"feenas");a.O=new TUf(a.V,a.Ba,a.Yc,a.H,a.Da,a.xa,a.J,a.Lc,null!=c&&c.Fb(),d);a.Ga(a.O);a.O.render(a.getElement())}else a.O&&(a.removeChild(a.O,!0),Tf(a.O),a.O=null);c&&RTf(c,b)}function QUf(a,b){if(1!=a.xa){var c=eVf(a);b?(a.ma=new qUf(a.V,a.Ba,a.Yc,a.H,a.Da,a.xa,null!=c&&c.Fb()),a.Ga(a.ma),a.ma.render(a.getElement())):a.ma&&(a.removeChild(a.ma,!0),Tf(a.ma),a.ma=null);c&&RTf(c,b)}}
function dVf(a){$c(a.D,function(b){b.ZS(a.Pd())})}function eVf(a){return(a=id(a.D,function(b){return b instanceof OTf}))&&a}function fVf(a,b,c){$c(a.D,function(d){d.po(b,c)});b&&(a.H=null,a.Da=0,a.xa=null,a.Caa(),PUf(a))}
function PUf(a){var b=a.Fa("waffle-sidebar-tables-bar"),c=a.Fa("waffle-assistant-scroll-pane");var d=null;var e=z(y(),"feenas"),f=oV(a.Va.C);if(a.H||e&&f){if(a.H){var h=pG(a.H);f=a.H.mb();e&&(d=cI(a.V.C,f).we())}else h=f.Ec().C,d=f.we(),a.H=nG(h,f.mb()),a.xa=0;d=gM(h,d);d=zy(oUf,{eD:d});a=a.Gb.wb();up(a);a.appendChild(d);P(b,!0);Dx(c,"waffle-assistant-tables-scroll-pane")}else P(b,!1),Fx(c,"waffle-assistant-tables-scroll-pane")}m.Caa=function(){gVf(this,!1);QUf(this,!1)};
function hVf(){var a='<div style="float:right;"><div class="'+T("waffle-inline-assistant-ignore-button")+'">';return S(a+"Ignore</div></div>")}function iVf(a){var b='<div class="'+T("waffle-assistant-input-reject-icon")+'" style="display:none" aria-label="';b+=jx("Reject suggestion");b+='">'+R(yB({icon:"docs-icon-img docs-icon-close"},a))+"</div>";return S(b)}
function jVf(a,b){var c=a.column,d=a.wbc,e=a.vbc,f=a.iQb;a=a.KNb;var h='<div style="outline: none;margin-bottom: 12px;">';f?(h+='<div class="'+T("waffle-inline-assistant-nf-suggestion-description")+'">',h+="Numbers in this column are text</div>"):a&&(h+='<div class="'+T("waffle-inline-assistant-nf-suggestion-description")+'">',h+="There are multiple formats in this column</div>");h+='<div class="'+T("waffle-inline-assistant-recommendation-container")+'"><div class="'+T("waffle-inline-assistant-gridrange-chip")+
'">'+R(c)+iVf(b)+'</div><div class="'+T("waffle-inline-assistant-suggestion-row")+'">';if(f)h+='<div class="'+T("waffle-inline-assistant-nf-row")+'"><div class="'+T("waffle-inline-assistant-nf-suggested-preview")+" "+T("waffle-inline-assistant-nf-suggestion-text")+'">',h+="Convert to numbers</div></div>";else for(c=Math.max(0,Math.ceil(d.length)),f=0;f<c;f++){var k=f;h+='<div class="'+T("waffle-inline-assistant-nf-row")+'">'+(a?"":'<div class="'+T("waffle-inline-assistant-nf-original-preview")+" "+
T("waffle-inline-assistant-nf-suggestion-text")+'">'+R(d[k])+"</div>")+'<div class="'+T("waffle-inline-assistant-nf-suggested-preview")+" "+T("waffle-inline-assistant-nf-suggestion-text")+'">'+R(e[k])+"</div></div>"}h+='</div><div class="'+T("waffle-assistant-card-feedback")+" "+T("waffle-assistant-in-cell-card-feedback")+'"></div><div class="'+T("waffle-inline-assistant-nf-check")+'">'+R(yB({icon:"docs-icon-img docs-icon-check"},b))+"</div></div></div>";return S(h)}
function kVf(a){var b=a.Qg;a=a.NHa;b='<div style="outline: none"><div class="'+T("waffle-inline-assistant-recommendation-container")+'"><div class="'+T("waffle-inline-assistant-gridrange-chip")+'">'+R(b)+'</div><div class="'+T("waffle-inline-assistant-suggestion-row")+'"><div class="'+T("waffle-inline-assistant-tw-row")+'">';for(var c=a.length,d=0;d<c;d++){var e=a[d];b+=fx(e,null)?'<div class="'+T("waffle-inline-assistant-tw-space")+'"></div>':R(e)}return S(b+"</div></div></div></div>")}
function lVf(a,b){a=a.qza;b='<div class="'+T("waffle-inline-assistant-suggestion-row-overflow-button docs-material")+'">'+R(yB({icon:"docs-icon-img docs-icon-chevron-down-24"},b));a="See "+(R(a)+" more");return S(b+a+"</div>")}
function mVf(a,b){var c=a.QT;a=a.Acb;for(var d='<div style="outline: none; overflow:hidden;">',e=Math.max(0,Math.ceil(Math.min(3,c.length))),f=0;f<e;f++){var h=f;d+=kVf({Qg:c[h],NHa:a[h]})}if(3<c.length){d+=lVf({qza:c.length-3},b)+'<div class="'+T("waffle-inline-assistant-overflow-suggestions")+'" style="display:none">';b=Math.max(0,Math.ceil(c.length-3));for(e=0;e<b;e++)f=3+e,d+=kVf({Qg:c[f],NHa:a[f]});d+="</div>"}d+='<div style="float:right"><div class="'+T("waffle-inline-assistant-accept-button")+
'">';d=d+"Trim all whitespace</div></div>"+(hVf()+'<div style="float:right"><div class="'+T("waffle-assistant-card-feedback")+'"></div></div></div>');return S(d)}function nVf(){var a='<div class="'+T("waffle-inline-assistant-sidebar-toast")+'"><div class="'+T("waffle-inline-assistant-toast-undo-button")+'">';a=a+'Undo</div><div class="'+(T("waffle-inline-assistant-toast-text")+'"></div></div>');return S(a)}
function oVf(a){a=a.e7b;a=qT(new RA("{NUM_CELLS_CHANGED_1,plural,=1{Change applied to {NUM_CELLS_CHANGED_2} cell}other{Change applied to {NUM_CELLS_CHANGED_2} cells}}"),{NUM_CELLS_CHANGED_1:a,NUM_CELLS_CHANGED_2:R(a)});return S(a)}function pVf(a){a="Column "+(R(a.odb)+" format applied");return S(a)}
function qVf(a){a=a.h7b;a=qT(new RA("{NUM_ROWS_REMOVED_1,plural,=1{{NUM_ROWS_REMOVED_2} row removed}other{{NUM_ROWS_REMOVED_2} rows removed}}"),{NUM_ROWS_REMOVED_1:a,NUM_ROWS_REMOVED_2:R(a)});return S(a)}
function rVf(a,b){a='<div class="waffle-inline-assistant-sidebar-insights-cta-container"><div class="waffle-inline-assistant-sidebar-divider"></div><div class="waffle-inline-assistant-sidebar-insights-header">Get more insights about your data</div>'+R(aA({cd:"waffle-inline-assistant-sidebar-insights-cta",content:"Review column stats",style:2},b));return S(a+"</div>")}
function sVf(a){var b=a.wBa,c=a.x3;a=a.Pq;b='<div style="outline: none"><div class="'+T("waffle-inline-assistant-recommendation-container")+'">'+(a?'<div class="'+T("waffle-inline-assistant-rd-deleted-strikethrough")+'"></div><div class="'+T("waffle-inline-assistant-gridrange-chip")+'">'+R(b+1)+"</div>":'<div class="'+T("waffle-inline-assistant-gridrange-chip")+" "+T("waffle-inline-assistant-gridrange-chip-neutral")+'">'+R(b+1)+"</div>")+'<div class="'+T("waffle-inline-assistant-suggestion-row")+
'"><div class="'+T("waffle-inline-assistant-rd-cell-preview")+'">';a=c.length;for(var d=0;d<a;d++)b+=R(c[d])+'<div class="'+T("waffle-inline-assistant-rd-cell-value-divider")+'"></div>';return S(b+"</div></div></div></div>")}
function tVf(a,b){var c=a.mdc;a=a.x3;for(var d='<div tabindex=0 role="region" style="overflow:hidden; outline:none">'+sVf({wBa:c[0],x3:a,Pq:!1}),e=Math.max(0,Math.ceil(Math.min(3,c.length)-1)),f=0;f<e;f++)d+=sVf({wBa:c[1+f],x3:a,Pq:!0});if(3<c.length){d+=lVf({qza:c.length-3},b)+'<div class="'+T("waffle-inline-assistant-overflow-suggestions")+'" style="display:none">';b=Math.max(0,Math.ceil(c.length-3));for(e=0;e<b;e++)d+=sVf({wBa:c[3+e],x3:a,Pq:!0});d+="</div>"}d+='<div style="float:right"><div class="'+
T("waffle-inline-assistant-accept-button")+'">';d=d+"Remove</div></div>"+(hVf()+'<div style="float:right; position: relative;"><div class="'+T("waffle-assistant-card-feedback")+'"></div></div></div>');return S(d)}function uVf(a){a=a.Hia;a=qT(new RA("{NUM_OVERFLOW_CARDS_1,plural,=1{Show {NUM_OVERFLOW_CARDS_2} more suggestion}other{Show {NUM_OVERFLOW_CARDS_2} more suggestions}}"),{NUM_OVERFLOW_CARDS_1:a,NUM_OVERFLOW_CARDS_2:R(a)});return S(a)}
function vVf(a,b){var c=a.ycb;a=a.Hia;return S('<div class="'+T("waffle-inline-assistant-sidebar-category-container")+'"><div class="'+T("waffle-inline-assistant-sidebar-category-header")+'"><div class="'+T("waffle-inline-assistant-sidebar-category-label")+'">'+R(c)+'</div></div><div class="'+T("waffle-inline-assistant-sidebar-category-cards")+'"></div><div class="'+T("waffle-inline-assistant-sidebar-category-show-more-button docs-material")+'">'+R(yB({icon:"docs-icon-img docs-icon-chevron-down-24"},
b))+uVf({Hia:a},b)+"</div></div>")}function wVf(a){var b=a.d7b,c=a.wK;a='<div class="'+T("waffle-assistant-anomaly-description")+'">';1==b?(b='This cell is not a <span style="font-weight:bold; text-transform: lowercase;">'+(R(c)+"</span>"),a+=b):1<b&&(b='These cells are not <span style="font-weight:bold; text-transform: lowercase;">'+(R(c)+"s</span>"),a+=b);return S(a+"</div>")}
function xVf(a){var b='<div class="'+T("waffle-assistant-input-return-icon")+'" style="display:none" aria-label="';b+=jx("Finish editing");b+='">'+R(yB({icon:"docs-icon-img docs-icon-check"},a))+"</div>";return S(b)}
function yVf(a,b){var c=a.MHa;a=a.OHa;c='<div tabindex=0 role="textbox" class="'+T("waffle-assistant-card-single-anomaly")+" "+T("waffle-assistant-card-single-anomaly"+c)+'" style="outline: none;"><div class="'+T("waffle-assistant-input-container")+" "+T("waffle-assistant-input-container"+c)+'"><div class="'+T("waffle-inline-assistant-gridrange-chip")+'">'+R(c)+iVf(b)+'</div><div class="'+T("waffle-assistant-form")+'">';c+='<div class="'+T("waffle-assistant-card-feedback")+" "+T("waffle-assistant-in-cell-card-feedback")+
'"></div><div class="'+T("waffle-assistant-input-edit-icon")+'">'+R(yB({icon:"docs-icon-img docs-icon-edit-outline-20"},b))+"</div>"+xVf(b)+'<input type="text" class="'+T("jfk-textinput")+" "+T("waffle-assistant-anomaly-input")+'" placeholder="'+T("New cell value")+'" aria-label="'+T("New cell value")+'" value="'+T(a)+'"/></div></div></div>';return S(c)}
function zVf(a,b){var c=a.zcb;a=a.Ccb;var d='<div tabindex=0 role="region" class="'+T("waffle-assistant-anomaly-card")+'"><div tabindex="0" role="textbox" class="'+T("waffle-anomaly-grey-out")+" "+T("waffle-assistant-card-anomaly")+'"></div><div class="'+T("waffle-anomaly-apply-all-hint")+'" style="display:none">';d+="Input for all instances";var e=a[0];e=S('<div tabindex=0 role="textbox" class="'+T("waffle-assistant-card-apply-all")+'" style="outline: none;"><div class="'+T("waffle-assistant-input-container")+
'"><div class="'+T("waffle-assistant-form")+'"><input type="text" class="'+T("jfk-textinput")+" "+T("waffle-assistant-anomaly-input")+" "+T("waffle-inline-assistant-apply-all-input-box")+'" placeholder="New value for all anomalies" aria-label="'+T(e)+'" value="'+T(e)+'"/>'+xVf(b)+"</div></div></div>");d+="</div>"+e;e=Math.max(0,Math.ceil(Math.min(3,c.length)));for(var f=0;f<e;f++){var h=f;d+=yVf({MHa:c[h],OHa:a[h]},b)}if(3<c.length){d+=lVf({qza:c.length-3},b)+'<div class="'+T("waffle-inline-assistant-overflow-suggestions")+
'" style="display:none">';e=Math.max(0,Math.ceil(c.length-3));for(f=0;f<e;f++)h=3+f,d+=yVf({MHa:c[h],OHa:a[h]},b);d+="</div>"}d+='<div class="'+T("waffle-assistant-anomaly-apply-all-container")+'"><div class="'+T("waffle-assistant-anomaly-apply-to-all-text")+'">';d=d+'Apply to all</div><div class="'+(T("waffle-assistant-anomaly-apply-all-check")+'"></div></div></div>');return S(d)}function AVf(a,b,c,d){A.call(this);this.H=a;this.D=b;this.J=c;this.gb=d||null}t(AVf,IT);
AVf.prototype.C=function(a){var b=this,c=[],d=new mz("Suggestion is incorrect",null,this.gb);d.Kc("apps-menuitem");c.push(d);Xz(a,d,this.H,void 0,function(){return BVf(b,"Suggestion is incorrect")},this.D);d=new mz("Suggestion is not critical",null,this.gb);d.Kc("apps-menuitem");c.push(d);Xz(a,d,this.H,void 0,function(){return BVf(b,"Suggestion is not critical")},this.D);d=new mz("Other",null,this.gb);d.Kc("apps-menuitem");c.push(d);Xz(a,d,this.H,void 0,function(){return BVf(b,"Other")},this.D);c.push(null);
d=zy(X$e);d=new mz(d,null,this.gb);d.Kc("apps-menuitem");c.push(d);Xz(a,d,this.H,void 0,function(){return BVf(b,"Other")},this.D);return c};function BVf(a,b){return new QYe({description:b},a.J,a.D)}var CVf={Cnc:"anomaly",J8a:"remove-duplicates",$Kc:"number-format",R9a:"trim-whitespace"};
function n_(a,b,c,d,e,f){Q.call(this,f);var h=this;this.jb=a;this.ub=b;this.D=AJ(b);this.C=c;this.fb=d;this.R=e;this.ob=new yW(b,"waffle-assistant-highlight-styled-border","waffle-assistant-highlight-styled-rect");this.qa(this.ob);this.J=new yW(b,"waffle-assistant-mouseover-highlight-styled-border","waffle-assistant-mouseover-highlight-styled-rect");this.qa(this.J);this.Sa=new yW(b,"waffle-assistant-mouseover-highlight-styled-border-red","waffle-assistant-mouseover-highlight-styled-rect-red");this.qa(this.Sa);
this.Qa=new bA;this.Ga(this.Qa);this.ma=new Vz(void 0,void 0,void 0,IB.getInstance());this.qa(this.ma);this.Cb=new Spe(function(){return h.ma},this.oa());this.qa(this.Cb);this.Gb=ez(az(new $y,76));this.O=null;this.Ma={};this.Mb=new Tz(this);this.qa(this.Mb);this.Ba=[];this.Ja=[];this.xa=null}t(n_,Q);m=n_.prototype;m.g4=ea("waffle-inline-assistant-ignore-button");
function DVf(a,b){var c=new bA,d=a.Ja.length;c.Wa(a.Vf(a.g4())[d]);a.Ja.push(c);var e=b?{card:a}:{card:a,Mgc:d};Xz(a.ma,c,Ptb,Yz,function(){return e},EVf(a))}
m.Ia=function(){Q.prototype.Ia.call(this);var a=this.La();this.getHandler().listen(a,"mouseenter",this.D7).listen(a,"mouseleave",this.d_);FVf(this);a=this.Vf(this.g4()).length;for(var b=1===a,c=0;c<a;c++)DVf(this,b);if(a=this.eb("waffle-inline-assistant-suggestion-row-overflow-button"))this.Qa.Wa(a),this.getHandler().listen(this.Qa,"action",this.R5b)};m.Ka=function(){Q.prototype.Ka.call(this);this.iO()};m.D7=function(){o_(this,!0);zW(this.ob);H5e(this.J,this.C);this.iO();this.d9()};
m.d_=function(){o_(this,!1);this.iO();zW(this.J);this.La().blur()};function GVf(a){null==a.xa&&(a.xa=BRc(a.D))}function HVf(a){a.xa&&(wP(a.D,a.xa.y,a.xa.x),a.xa=null)}function EVf(a){return ez(dz(az(new $y,76),a.wia()))}m.R5b=function(){this.fb.C(36812,EVf(this));var a=this.Fa("waffle-inline-assistant-overflow-suggestions");P(a,!0);this.La().focus();this.Qa.Pa(!1);this.Qa.setVisible(!1)};
function FVf(a){if(z(y(),"fedpsf")&&!(0<a.Ba.length))for(var b=a.Vf("waffle-assistant-card-feedback"),c={},d=0;d<b.length;c={dG:c.dG},d++){var e=b[d];c.dG=new xaf(a.oa());a.Ga(c.dG);a.Ba.push(c.dG);var f=new AVf(Utb,a.Gb,a.Ma,a.oa());Upe(a.Cb,c.dG.Bb(),[f]);c.dG.render(e);a.R||(c.dG.setVisible(!1),a.getHandler().listen(c.dG.Bb(),"afterhide",function(h){return function(){h.dG.setVisible(!1)}}(c)))}}m.isVisible=function(){return this.eb("waffle-inline-assistant-gridrange-chip")?!0:!1};
function p_(a){return a.C.map(function(b){return b.rect})}m.vsa=ea(null);function o_(a,b){a.R||1!==a.Ba.length||(a=a.Ba[0],b?a.setVisible(!0):b||a.Bb().isVisible()||a.setVisible(!1))}
function IVf(a,b,c,d,e,f,h,k,l){c.sort(function(n,q){return n.rect.top-q.rect.top});n_.call(this,a,b,c,h,k,l);this.Va=d;this.H=this.C.map(function(n){return gM(n.rect)});this.cb=ed(c,function(n){return n.rect.top});this.V=e;this.L=new MQ(this.oa());this.Ga(this.L);this.Ra=new Q;this.Ga(this.Ra);this.Da=new Q;this.Ga(this.Da);this.Xa=null;this.rb=f}t(IVf,n_);m=IVf.prototype;m.wia=function(){var a=new Dk;L(a,21,3);var b=new q$d;L(b,2,JVf(this.Va));Zj(a,26,b);b=new Ek;L(b,1,1);PUe(a,b);return a};
m.kT=ea("anomaly");m.vsa=function(a,b){for(var c=b.length-1;0<=c;c--)this.V.splice(b[c],1);b=!1;this.rb&&1<a.length&&(b=!0);return new IVf(this.jb,this.ub,a,this.Va,this.V,b,this.fb,this.R)};m.Ca=function(){var a=zy(zVf,{zcb:this.H,Ccb:this.V});this.pb(a);a={};this.Ma=(a.recommendationCategory="CATEGORICAL_ANOMALY",a.recommendationRange=this.H.join(","),a)};
m.Ia=function(){var a=this;n_.prototype.Ia.call(this);for(var b=this.Vf("jfk-textinput"),c=this.Vf("waffle-assistant-card-single-anomaly"),d=this.Vf("waffle-inline-assistant-gridrange-chip"),e=this.Vf("waffle-assistant-input-edit-icon"),f=this.Vf("waffle-assistant-input-return-icon"),h={ew:0};h.ew<this.H.length;h={mP:h.mP,Zla:h.Zla,PU:h.PU,ew:h.ew,Y9:h.Y9,b$:h.b$,cK:h.cK},h.ew++){h.cK=b[h.ew+1];var k=f[h.ew+1];h.mP=this.H[h.ew];h.Zla=this.V[h.ew];var l=c[h.ew];h.Y9=d[h.ew];var n=e[h.ew];h.PU=this.Ba[h.ew];
h.b$=this.Ja[h.ew];this.R&&h.PU.setVisible(!0);this.getHandler().listen(h.cK,["mousedown","click","mouseup","keydown"],function(q){return void q.stopPropagation()}).listen(h.cK,"input",function(q){return function(){KVf(a,q.mP,!0,null)}}(h)).listen(h.cK,"focus",function(q){return function(){var r=q.mP,w=q.Zla,x=q.PU,F=a.Fa("waffle-assistant-input-container"+r);LVf(a,r)!==w?KVf(a,r,!0,null):Dx(F,"waffle-assistant-input-container-focused");r=hp("waffle-assistant-input-edit-icon",F);P(r,!1);F=hp("waffle-inline-assistant-gridrange-chip",
F);Dx(F,"waffle-inline-assistant-gridrange-chip-hovered");a.R||x.setVisible(!1)}}(h)).listen(h.cK,"blur",function(q){return function(){return MVf(a,q.mP)}}(h)).listen(h.cK,"keydown",function(q){return function(r){return NVf(a,r,q.mP)}}(h)).listen(l,"mouseenter",function(q){return function(){var r=q.Y9,w=q.PU,x=q.b$,F=a.C[q.ew];o_(a,!0);GVf(a);wP(a.D,F.rect.top,F.rect.left);a.L.isChecked()?H5e(a.J,a.C):AW(a.J,F);Dx(r,"waffle-inline-assistant-gridrange-chip-hovered");r=r.childNodes[0];a.Xa=r.nodeValue;
r.nodeValue="";x.setVisible(!0);w.setVisible(!0)}}(h)).listen(l,"mouseleave",function(q){return function(){var r=q.Y9,w=q.PU,x=q.b$;o_(a,!1);zW(a.J);Fx(r,"waffle-inline-assistant-gridrange-chip-hovered");a.R||w.Bb().isVisible()||w.setVisible(!1);r.childNodes[0].nodeValue=a.Xa;a.Xa=null;x.setVisible(!1)}}(h)).listen(n,"click",function(q){return function(){var r=q.cK;r.focus();r.selectionStart=r.selectionEnd=r.value.length}}(h)).listen(k,"click",function(q){return function(){return OVf(a,q.mP)}}(h)).listen(this.L,
"change",this.Usb)}this.Da.Wa(this.Fa("waffle-anomaly-grey-out"));P(this.Da.La(),!1);b=this.Fa("waffle-assistant-card-apply-all");tw(b,"height","0px");tw(b,"visibility","hidden");c=hp("waffle-assistant-input-return-icon",b);this.getHandler().listen(b,"keydown",function(q){return NVf(a,q,null)}).listen(c,"click",this.bPa).listen(b,"input",this.jPa);this.Ra.Wa(this.Fa("waffle-assistant-anomaly-apply-all-container"));this.rb||P(this.Ra.La(),!1);b=this.Fa("waffle-assistant-anomaly-apply-to-all-text");
c=this.Fa("waffle-assistant-anomaly-apply-all-check");LQ(this.L,b);this.L.Wa(c);this.R&&(tw(c,"zoom","100%"),tw(b,"font-size","13px"))};
m.Usb=function(){this.eb("waffle-assistant-card-single-anomaly");var a=this.Fa("waffle-assistant-card-apply-all"),b=this.Vf("waffle-assistant-input-edit-icon");if(this.L.isChecked()){P(this.Da.La(),!0);var c=this.Fa("waffle-anomaly-apply-all-hint");P(c,!0);tw(a,"transition","height 0.2s linear");tw(a,"visibility","visible");tw(a,"z-index","1000");tw(a,"height","39px");tw(a,"margin-top","10px");a.focus();a=hp("waffle-assistant-input-container",a);this.Fa("waffle-inline-assistant-apply-all-input-box").value!==
this.V[0]?this.jPa():Dx(a,"waffle-assistant-input-container-focused");for(a=0;a<b.length;a++)P(b[a],!1)}else{P(this.Da.La(),!1);tw(a,"transition","height 0.2s linear, visibility 0s linear 0.2s");tw(a,"z-index","");tw(a,"height","0px");tw(a,"margin-top","");tw(a,"visibility","hidden");a=hp("waffle-assistant-input-container",a);Fx(a,"waffle-assistant-input-container-focused");Fx(a,"waffle-assistant-input-container-changed");for(c=0;c<this.H.length;c++)KVf(this,this.H[c],!1,this.V[c]);c=this.Fa("waffle-anomaly-apply-all-hint");
P(c,!1);Fx(c,"waffle-anomaly-apply-all-hint-changed");a=hp("waffle-assistant-input-return-icon",a);P(a,!1);for(a=0;a<b.length;a++)P(b[a],!0),MVf(this,this.H[a])}};m.g4=ea("waffle-assistant-input-reject-icon");
m.jPa=function(){var a=this.Fa("waffle-assistant-card-apply-all"),b=hp("waffle-assistant-input-container",a);Dx(b,"waffle-assistant-input-container-changed");b=this.Fa("waffle-inline-assistant-apply-all-input-box").value;for(var c=0;c<this.H.length;c++)KVf(this,this.H[c],!1,b);b=this.Fa("waffle-anomaly-apply-all-hint");Dx(b,"waffle-anomaly-apply-all-hint-changed");a=hp("waffle-assistant-input-return-icon",a);P(a,!0)};
function KVf(a,b,c,d){a=a.Fa("waffle-assistant-input-container"+b);c?(Dx(a,"waffle-assistant-input-container-changed"),c=hp("waffle-assistant-input-return-icon",a),P(c,!0)):hp("jfk-textinput",a).value=d;c=hp("waffle-inline-assistant-gridrange-chip",a);Dx(c,"waffle-inline-assistant-gridrange-chip-changed")}function NVf(a,b,c){switch(b.keyCode){case 13:a.L.isChecked()?a.bPa():OVf(a,c)}}
m.bPa=function(){for(var a=this.Fa("waffle-inline-assistant-apply-all-input-box"),b=[],c=ja(this.C),d=c.next();!d.done;d=c.next())(d=d.value)&&(b=b.concat(d.rect));c=EVf(this);d=new Ek;L(d,1,b.length);bk(c.C,10,[d]);Otb.qb({card:this,QHa:b,newValue:a.value},c)};function OVf(a,b){var c=a.D.Ua(),d=LVf(a,b);b=gqc(b,c);Otb.qb({card:a,QHa:[b],newValue:d},EVf(a))}
function MVf(a,b){a=a.Fa("waffle-assistant-input-container"+b);b=hp("waffle-assistant-input-return-icon",a);if(document.querySelector(".waffle-assistant-input-return-icon:active")!==b){Fx(a,"waffle-assistant-input-container-focused");Fx(a,"waffle-assistant-input-container-changed");var c=hp("waffle-assistant-input-edit-icon",a);P(c,!0);P(b,!1);a=hp("waffle-inline-assistant-gridrange-chip",a);Fx(a,"waffle-inline-assistant-gridrange-chip-changed");Fx(a,"waffle-inline-assistant-gridrange-chip-hovered")}}
m.D7=function(){o_(this,!0);zW(this.ob)};m.d_=function(){n_.prototype.d_.call(this);HVf(this)};m.L$=function(a,b){var c=this.C[a];c=new Ln(c.C,new qn(c.rect.top-b,c.rect.left,c.rect.top-b+c.rect.height,c.rect.left+c.rect.width));this.C[a]=c;this.cb[a]-=b;null!==this.eb("waffle-inline-assistant-gridrange-chip")&&(this.Vf("waffle-inline-assistant-gridrange-chip")[a].childNodes[0].nodeValue=gM(c.rect))};m.iO=ba();m.d9=ba();
function LVf(a,b){a=a.Fa("waffle-assistant-input-container"+b);return(a=hp("jfk-textinput",a))?a.value:null}m.getColumnType=g("Va");function JVf(a){switch(a.toUpperCase()){case "LOCATION":return 11;case "ADDRESS":return 12;case "PHONE NUMBER":return 13;case "COMPANY":return 14;case "FAMOUS PEOPLE":return 15;case "STOCK":return 16;case "DATETIME":return 7;case "EMAIL ADDRESS":return 9;default:return 0}}
function PVf(a,b,c){a=mne(a.L);switch(b){case 4:case 5:case 6:case 7:a=ja(a);for(var d=a.next();!d.done;d=a.next())if(d=d.value.$E,d.getType()===b)return ah(d,2)}return c}function QVf(a,b){a=ritz_api.TablesApi.getCurrentlyDetectedTables(NSf(a.Jb()).sb());return a.length?id(a,function(c){return pG(jo(ritz_api.TablesApi.getTableGridRange(c))).intersects(b)}):null}
function RVf(){this.Ba=!1;this.J=[];this.R=[];this.O=[];this.ma=[];this.L=[];this.V=[];this.F=[];this.H=[];this.xa=[];this.C=this.D=this.Da=this.Ja=null}function SVf(a,b,c,d,e,f,h,k){a.Ja=b;a.J=c;a.R=d;a.O=e;a.ma=f;a.L=h;a.V=k}function TVf(a,b,c,d,e){A.call(this);this.H=a;this.F=b;this.C=e;this.D=DV(this.F)}t(TVf,A);
function UVf(a,b){if(z(y(),"fecad")){var c=nM(a.H);if(c){a.C.F=[];a.C.H=[];a.C.xa=[];var d=ritz_api.RitzModelApi.getWorkbookRangesForSheet(a.D,12);d=ja(d);for(var e=d.next();!e.done;e=d.next()){var f=e.value;e=Rn(x_c,ritz_api.RitzModelApi.getWorkbookRangePropertiesDeltaProtoById(f));if(f=ritz_api.RitzModelApi.getWorkbookRangeById(f,!1))if(f=jo(f),f.mb()===c.Jb()){var h=new qn(f.dc(),f.Zb(),f.Sc(),f.Uc());h=new Ln(a.D,h);e=ao(e.Wh(11,sSf),4);a.C.F.push(h);a.C.H.push(e);e=CI(c.ih(f.dc(),f.Zb()));a.C.xa.push(e);
b.push(h)}}}}}function VVf(a,b,c,d,e,f,h){n_.call(this,a,b,[c],e,f,h);this.cb=d;this.H=C(d,1);this.V=C(d,4);this.L=d.getPattern();this.Xa=C(d,5);this.Va=new Gl;this.Da=new bA;this.Ga(this.Da);this.Ra=null}t(VVf,n_);m=VVf.prototype;
m.Ia=function(){var a=this;n_.prototype.Ia.call(this);this.Da.Wa(this.Fa("waffle-inline-assistant-nf-check"));Xz(this.ma,this.Da,Ntb,Yz,function(){return a},EVf(this));var b=this.Fa("waffle-inline-assistant-recommendation-container");this.getHandler().listen(b,"mouseenter",this.RCb).listen(b,"mouseleave",this.UCb)};m.wia=function(){var a=new Dk;L(a,21,1);L(a,22,this.L);L(a,24,this.V);return a};m.kT=ea("number-format");
m.Ca=function(){var a=bM(this.C[0].rect.left),b=WVf(this,this.V),c=WVf(this,this.H,this.L);b=zy(jVf,{column:a,wbc:b,vbc:c,iQb:1===this.V&&(2===this.H||4===this.H||3===this.H),KNb:1<this.Xa});this.pb(b);b=XVf(this.H);c={};this.Ma=(c.recommendationCategory="NUMBER_FORMAT",c.recommendationRange=a,c.recommendationType=b.toLocaleUpperCase(),c.recommendationPattern=this.L,c);if("#,##0.00;(#,##0.00)"===this.L||"_($* #,##0.00_);_($* \\(#,##0.00\\);_($* -??_);_(@_)"===this.L)a=this.Fa("waffle-inline-assistant-recommendation-container"),
b=this.Fa("waffle-inline-assistant-gridrange-chip"),c=this.Fa("waffle-assistant-input-reject-icon"),Gw(a,"72px"),Gw(b,"72px"),tw(b,"line-height","72px"),Gw(c,"72px"),tw(c,"line-height","72px")};
function WVf(a,b,c){if(1===b)return["TEXT"];var d=new jh;d.setType(b);D(d,3,1);c&&d.setPattern(c);if("#,##0.00;(#,##0.00)"===c||"#,##0.00;(#,##0.00)"===a.L||"_($* #,##0.00_);_($* \\(#,##0.00\\);_($* -??_);_(@_)"===c||"_($* #,##0.00_);_($* \\(#,##0.00\\);_($* -??_);_(@_)"===a.L)return[ritz_api.RitzModelApi.renderNumberAsFormattedString(1000.12,Il(a.Va.sb(d),dg)),ritz_api.RitzModelApi.renderNumberAsFormattedString(-1000.12,Il(a.Va.sb(d),dg))];b=1000.12;5===a.V||6===a.V||7===a.V||5===a.H||6===a.H||7===
a.H?b=39717.66597222222:3===a.H&&(b=.1012);return[ritz_api.RitzModelApi.renderNumberAsFormattedString(b,Il(a.Va.sb(d),dg))]}function XVf(a){switch(a){case 1:return"Text";case 2:return"Number";case 3:return"Percent";case 4:return"Currency";case 5:return"Date";case 6:return"Time";case 7:return"Date time";case 8:return"Scientific";default:return"Unknown"}}
m.RCb=function(){var a=this.C[0].rect;GVf(this);wP(this.D,Math.max(0,a.top-2),a.left);a=this.Fa("waffle-inline-assistant-gridrange-chip");Dx(a,"waffle-inline-assistant-gridrange-chip-hovered");AW(this.J,this.C[0]);a=a.childNodes[0];this.Ra=a.nodeValue;a.nodeValue="";this.Ja[0].setVisible(!0)};m.g4=ea("waffle-assistant-input-reject-icon");
m.UCb=function(){var a=this.Fa("waffle-inline-assistant-gridrange-chip");Fx(a,"waffle-inline-assistant-gridrange-chip-hovered");zW(this.J);HVf(this);a.childNodes[0].nodeValue=this.Ra;this.Ra=null;this.Ja[0].setVisible(!1)};m.D7=function(){o_(this,!0);this.iO();this.d9();var a=this.Fa("waffle-inline-assistant-nf-row");Dx(a,"waffle-inline-assistant-nf-row-with-feedback")};m.d_=function(){o_(this,!1);this.La().blur();this.iO();var a=this.Fa("waffle-inline-assistant-nf-row");Fx(a,"waffle-inline-assistant-nf-row-with-feedback")};
m.L$=ba();m.d9=function(){this.O=ritz_api.GridViewApi.previewRangeWithNf(this.D.L.H,fUe(this.C[0]).sb(),this.jb,this.H,this.L);HKc(this.D,[this.C[0].rect])};m.iO=function(){this.O&&(ritz_api.GridViewApi.clearTransform(this.D.L.H,this.O),this.O=null,this.D.isDisposed()||HKc(this.D,[this.C[0].rect]))};function YVf(a){var b=new jh;b.setPattern(a.L);b.setType(a.H);return b}
function ZVf(a,b,c,d,e){Q.call(this,e);this.H=a;this.C=b;a=ja(b);for(b=a.next();!b.done;b=a.next())this.qa(b.value);this.J=c;this.L=d;this.D=new Q(e);this.Ga(this.D);this.F=new bA;this.Ga(this.F)}t(ZVf,Q);
ZVf.prototype.Ca=function(){var a=this;Q.prototype.Ca.call(this);var b=zy(vVf,{ycb:this.J,Hia:this.C.length-3});this.pb(b);this.D.Wa(this.Fa("waffle-inline-assistant-sidebar-category-cards"));if("anomaly"===this.H)$Vf(this).forEach(function(c){for(var d=0,e=0;e<c.length;e++){var f=p_(c[e]);d+=f.length}d=zy(wVf,{d7b:d,wK:c[0].getColumnType()});a.D.La().appendChild(d);for(d=0;d<c.length&&3>d;d++)a.D.Ga(c[d],!0)});else for(b=0;b<this.C.length&&3>b;b++)this.D.Ga(this.C[b],!0)};
function $Vf(a){var b=new Map;if("anomaly"!==a.H)return b;for(var c=0;c<a.C.length;c++){var d=a.C[c],e=p_(d)[0];if(b.has(e.left)){var f=b.get(e.left);f=f.concat(d);b.set(e.left,f)}else b.set(e.left,[d])}return b}ZVf.prototype.Ia=function(){Q.prototype.Ia.call(this);this.F.Wa(this.Fa("waffle-inline-assistant-sidebar-category-show-more-button"));"anomaly"===this.H||3>=this.C.length?aWf(this):this.getHandler().listen(this.F,"action",this.O)};
function bWf(a,b){var c=a.C.indexOf(b);a.C.splice(c,1);if(b.isVisible()){if("anomaly"===a.H){var d=b.La().previousElementSibling,e=$Vf(a),f=p_(b)[0].left;e.has(f)||(e=a.D.La(),Cx(d,"waffle-assistant-anomaly-description"),e.removeChild(d))}Cp(b.La(),document.activeElement)&&(c+1<a.mc()?a.Ac(c+1).La().focus():0<=c-1&&a.Ac(c-1).La().focus());a.D.removeChild(b,!0)}else a.C.length===a.D.mc()?aWf(a):(c=zy(uVf,{Hia:a.C.length-a.D.mc()}),a.F.La().childNodes[1].nodeValue=c.textContent);b.dispose()}
ZVf.prototype.O=function(){for(var a=this.D.mc(),b=a;b<this.C.length;b++)this.D.Ga(this.C[b],!0);this.C[a].La().focus();aWf(this);a=new Dk;L(a,23,this.C.length);switch(this.H){case "anomaly":L(a,21,3);break;case "remove-duplicates":L(a,21,4);break;case "number-format":L(a,21,1);break;case "trim-whitespace":L(a,21,2)}a=ez(dz(az(new $y,76),a));this.L.C(36811,a)};function aWf(a){a.F.Pa(!1);a.F.setVisible(!1)}
function cWf(a,b,c,d,e,f,h){n_.call(this,a,b,[c],e,f,h);this.Ra=d;this.F=$g(d,5).concat($g(d,6));this.V=C(d,2);this.L=C(d,3);this.Da=C(d,4);this.H=new bA;this.Ga(this.H)}t(cWf,n_);m=cWf.prototype;m.wia=function(){var a=new Dk;L(a,21,4);var b=new Ek;L(b,1,this.F.length-1);PUe(a,b);return a};m.kT=ea("remove-duplicates");
m.Ia=function(){var a=this;n_.prototype.Ia.call(this);for(var b=this.Vf("waffle-inline-assistant-recommendation-container"),c={oP:0};c.oP<this.F.length;c={oP:c.oP},c.oP++){var d=b[c.oP];this.getHandler().listen(d,"mouseenter",function(e){return function(){var f=e.oP,h=a.Vf("waffle-inline-assistant-gridrange-chip")[f],k=a.F[f],l=new Ln(a.C[0].C,new qn(k,a.V,k+1,a.L));0===f?AW(a.J,l):AW(a.Sa,l);GVf(a);a.D.$K(k);Dx(h,"waffle-inline-assistant-gridrange-chip-hovered")}}(c)).listen(d,"mouseleave",function(e){return function(){var f=
e.oP;f=a.Vf("waffle-inline-assistant-gridrange-chip")[f];zW(a.J);zW(a.Sa);Fx(f,"waffle-inline-assistant-gridrange-chip-hovered");HVf(a)}}(c))}this.H.Wa(this.Fa("waffle-inline-assistant-accept-button"));Xz(this.ma,this.H,Rtb,Yz,function(){return a},EVf(this))};
m.Ca=function(){for(var a=gM(this.C[0].rect),b=this.D.Ua(),c=[],d=this.V;5>d&&d<this.L;d++){var e=b.ih(this.F[0],d);c.push(CI(e))}b=zy(tVf,{mdc:this.F,x3:c});this.pb(b);b={};this.Ma=(b.recommendationCategory="REMOVE_DUPLICATES",b.recommendationRange=a,b.recommendationFirstRow=(this.F[0]+1).toString(),b)};m.D7=function(){o_(this,!0)};m.d_=function(){o_(this,!1);this.La().blur()};
m.L$=function(a,b){this.F[a]-=b;this.isVisible()&&(a=this.Vf("waffle-inline-assistant-gridrange-chip")[a],a.childNodes[0].nodeValue=(a.childNodes[0].nodeValue-b).toString())};m.d9=ba();m.iO=ba();function dWf(a,b,c,d,e,f,h){n_.call(this,a,b,c,e,f,h);this.V=d;this.Da=fd($g(d,1),function(k,l){return k+l},0);this.H=ed(c,function(k){return k.rect.top});this.L=new bA;this.Ga(this.L)}t(dWf,n_);m=dWf.prototype;m.wia=function(){var a=new Dk;L(a,21,2);var b=new Ek;L(b,1,this.H.length);PUe(a,b);return a};
m.kT=ea("trim-whitespace");
m.Ca=function(){for(var a=this.C,b=[],c=[],d=ja(a),e=d.next();!e.done;e=d.next()){var f=e.value.rect;e=gM(f);var h=CI(this.D.Ua().ih(f.top,f.left));f=h.trimStart();var k=h.length-f.length,l=h.trim();f=f.length-l.length;h=[];for(var n=0;n<k;n++)h.push(null);k=!1;l=ja(l);for(n=l.next();!n.done;n=l.next())n=n.value,n.match("\\s")?k?h.push(null):(k=!0,h.push(n)):(h.push(n),k=!1);for(k=0;k<f;k++)h.push(null);b.push(h);c.push(e)}b=zy(mVf,{QT:c,Acb:b});this.pb(b);a=bM(a[0].rect.left);b={};this.Ma=(b.recommendationCategory=
"TRIM_WHITESPACE",b.recommendationRange=a,b.recommendationNumWhitespaces=this.Da.toString(),b)};
m.Ia=function(){var a=this;n_.prototype.Ia.call(this);for(var b=this.Vf("waffle-inline-assistant-recommendation-container"),c={pP:0};c.pP<this.C.length;c={pP:c.pP},c.pP++){var d=b[c.pP];this.getHandler().listen(d,"mouseenter",function(e){return function(){var f=e.pP,h=a.C[f];AW(a.Sa,h);GVf(a);wP(a.D,h.rect.top,h.rect.left);h=a.Vf("waffle-inline-assistant-gridrange-chip")[f];Dx(h,"waffle-inline-assistant-gridrange-chip-hovered");f=a.C[f];h=ritz_api.GridViewApi.previewRangeWithApplyTrimWhitespace(a.D.L.H,
fUe(f).sb());a.O=h;HKc(a.D,[f.rect])}}(c)).listen(d,"mouseleave",function(e){return function(){var f=e.pP;zW(a.Sa);var h=a.Vf("waffle-inline-assistant-gridrange-chip")[f];Fx(h,"waffle-inline-assistant-gridrange-chip-hovered");a.O&&(ritz_api.GridViewApi.clearTransform(a.D.L.H,a.O),a.D.isDisposed()||(a.O=null,HKc(a.D,[a.C[f].rect])))}}(c))}this.L.Wa(this.Fa("waffle-inline-assistant-accept-button"));Xz(this.ma,this.L,Stb,Yz,function(){return a},EVf(this))};m.D7=function(){o_(this,!0)};
m.d_=function(){o_(this,!1);this.La().blur();HVf(this)};m.L$=function(a,b){var c=this.C[a];c=new Ln(c.C,new qn(c.rect.top-b,c.rect.left,c.rect.top-b+c.rect.height,c.rect.left+c.rect.width));this.C[a]=c;this.H[a]-=b;null!==this.eb("waffle-inline-assistant-gridrange-chip")&&(this.Vf("waffle-inline-assistant-gridrange-chip")[a].childNodes[0].nodeValue=gM(c.rect))};m.d9=ba();m.iO=ba();
m.vsa=function(a,b){for(var c=b.length-1;0<=c;c--)$g(this.V,1).splice(b[c],1);return new dWf(this.jb,this.ub,a,this.V,this.fb,this.R)};function eWf(a,b,c,d,e,f){Q.call(this,f);this.L=b;this.R=c;this.J=d;this.O=e;this.C=this.F=this.H=this.D=null;this.V=zy(rVf)}t(eWf,Q);eWf.prototype.Ca=function(){Q.prototype.Ca.call(this);Dx(this.getElement(),"waffle-inline-assistant-sidebar-section")};eWf.prototype.Ia=function(){Q.prototype.Ia.call(this);this.wb().appendChild(this.V)};
function fWf(a,b,c){a.C&&(a.removeChild(a.C,!0),a.C.dispose());if(c.length){var d=AJ(a.L);if(d){var e=d.Ua();d=[];for(var f={},h=0;h<b.length;h++){var k=b[h],l=c[h],n=k.rect,q=z2b(e.ih(n.top,n.left),e.Jb(),n.top,n.left),r=l+q+n.left,w=r in f?f[r].nG:[];w.push(k);f[r]={wK:l,PHa:q,nG:w,idb:n.left}}b=gWf(f);c=ja(b.keys());for(e=c.next();!e.done;e=c.next())e=b.get(e.value),e=new IVf(a.R,a.L,e.nG,e.wK,e.vna,e.dUa,a.J,a.O),d.push(e);d.sort(function(x,F){x=p_(x)[0];F=p_(F)[0];return x.left!=F.left?x.left-
F.left:x.top-F.top});a.C=new ZVf("anomaly",d,"Fix invalid data",a.J);a.Ga(a.C)}}}function gWf(a){var b=new Map,c;for(c in a){var d=a[c];if(1<d.nG.length){var e=Array(d.nG.length).fill(d.PHa);b.set(c,{wK:d.wK,nG:d.nG,dUa:!0,vna:e})}else{e="NON_BULK"+d.idb+d.wK;var f=b.has(e)?b.get(e).nG:[];f.push(d.nG[0]);var h=b.has(e)?b.get(e).vna:[];h.push(d.PHa);b.set(e,{wK:d.wK,nG:f,dUa:!1,vna:h})}}return b}function hWf(a){var b=[];a.F&&b.push(a.F);a.C&&b.push(a.C);a.D&&b.push(a.D);a.H&&b.push(a.H);return b}
function q_(a,b,c){var d=iWf(a,b.kT());if(c&&0<c.length){for(var e=d.C.indexOf(b),f=ka(b.C).concat(),h=c.length-1;0<=h;h--)f.splice(c[h],1);1<=f.length?(c=b.vsa(f,c),b.isVisible()&&(d.D.Ff(c,e,!0),d.D.removeChild(b,!0)),d.C[e]=c,b.dispose()):bWf(d,b)}else bWf(d,b);if(0===d.C.length)switch(Cp(d.La(),document.activeElement)&&(e=hWf(a),d=e.indexOf(d)+1,d<e.length?e[d].La().focus():a.eb("waffle-inline-assistant-sidebar-insights-cta").focus()),b.kT()){case "number-format":a.D.dispose();a.D=null;break;
case "trim-whitespace":a.H.dispose();a.H=null;break;case "remove-duplicates":a.F.dispose();a.F=null;break;case "anomaly":a.C.dispose(),a.C=null}}function jWf(a){Uf(a.ud(!0));a.C=null;a.F=null;a.D=null;a.H=null}function kWf(a){return(a.C?a.C.C:[]).concat(a.F?a.F.C:[],a.D?a.D.C:[],a.H?a.H.C:[])}function iWf(a,b){switch(b){case "number-format":return a.D;case "trim-whitespace":return a.H;case "remove-duplicates":return a.F;case "anomaly":return a.C}}
function lWf(a,b){a=a||{};var c='<div class="'+T("waffle-inline-assistant-sidebar-container")+'"><div class="'+T("waffle-inline-assistant-sidebar-column-filter-dropdown-container")+'"><div class="'+T("waffle-inline-assistant-sidebar-column-filter-dropdown")+'" aria-label="';c+=jx("Filter suggestions by column");c+='"></div></div><div class="'+T("waffle-inline-assistant-sidebar-empty-container")+'"><div class="'+T("waffle-inline-assistant-sidebar-empty-message")+'">';c=c+'No suggestions available</div></div><div class="'+
(T("waffle-inline-assistant-sidebar-accepted-container")+'"><div class="'+T("waffle-inline-assistant-sidebar-accepted-message")+'">');c=c+"Data cleanup suggestions have been applied</div>"+R(aA({cd:"waffle-inline-assistant-sidebar-accept-back",content:"Back",style:2},b));c+="</div></div>";var d='<div class="'+T("waffle-inline-assistant-refresh-banner")+'"><div class="'+T("waffle-inline-assistant-refresh-text-container")+'"><div class="'+T("waffle-inline-assistant-refresh-text")+'">';d=d+'Refresh to see the latest suggestions.</div><div class="'+
(T("waffle-inline-assistant-refresh-button jfk-button-standard")+'">');d+="Refresh</div></div></div>";a=""+R(XW(ex({title:"Data cleanup",yl:hx(c),Ae:!0,id:"inlineassistant",xx:"waffle-inline-assistant-sidebar",SF:hx('<img class="docs-icon docs-auto-fix" aria-hidden="true" src="https://www.gstatic.com/images/icons/material/system/1x/auto_fix_black_24dp.png"/>'),yW:!0,D5:hx(d)},a),b));return S(a)}
function mWf(a){Q.call(this,a);this.C=new Q;this.Ga(this.C);this.J=HZe("");this.Ga(this.J);this.O=new Vz(void 0,void 0,void 0,IB.getInstance());this.qa(this.O);this.F=new Qq(this.bZa,3E3,this);this.qa(this.F);this.L=new vB(this.oa());this.qa(this.L);this.D=null;this.H=0}t(mWf,Q);m=mWf.prototype;m.Ca=function(){var a=zy(nVf);this.pb(a)};m.show=function(){var a=this.La();P(a,!0);Fx(a,"waffle-inline-assistant-sidebar-toast-hidden");wB(this.L,this.C.La().textContent,"assertive");this.F.start()};
m.bZa=function(){Dx(this.La(),"waffle-inline-assistant-sidebar-toast-hidden")};m.isVisible=function(){return Kw(this.La())};m.S5b=function(){this.F.stop()};m.T5b=function(){this.F.start(1E3)};function nWf(a,b){var c=zy(oVf,{e7b:b});a.C.La().textContent=c.textContent;a.H=b}
m.Ia=function(){var a=this;Q.prototype.Ia.call(this);this.J.Wa(this.Fa("waffle-inline-assistant-toast-undo-button"));Xz(this.O,this.J,Qtb,Yz,void 0,function(){var c=new Dk;if(null!==a.D){L(c,21,a.D);var d=new Ek;L(d,1,a.H);PUe(c,d)}return ez(dz(az(new $y,76),c))});this.C.Wa(this.Fa("waffle-inline-assistant-toast-text"));var b=this.La();this.getHandler().listen(this.J,"action",this.bZa).listen(b,"mouseenter",this.S5b).listen(b,"mouseleave",this.T5b)};
function oWf(a,b,c,d,e,f,h){BW.call(this,h);var k=this;this.L=b;this.ma=d;this.D=new eWf(a,b,c,e,f,h);this.Ga(this.D);this.O=KB(new JB);this.qa(this.O);this.R=new bA;this.Ga(this.R);Xz(this.O,this.R,yub);this.F=new eW(new rz);Iz(this.F,"All columns");this.Ga(this.F);Xz(this.O,this.F,Mtb,this.F.J(),function(){return k.F.tf().getValue()},function(){var l=new Dk,n=0===k.F.ai();L(l,33,n);return ez(dz(az(new $y,76),l))});this.J=null;this.V=new bA;this.Ga(this.V);Xz(this.O,this.V,Ttb);this.H=new mWf;this.Ga(this.H)}
t(oWf,BW);
oWf.prototype.Ia=function(){var a=this;BW.prototype.Ia.call(this);this.getHandler().listen(this.La(),"click keyup keydown mousemove mouseover mouseenter mouseout".split(" "),function(){return void a.dispatchEvent("dataprep-sidebar-interaction-event")});J5e(this,!0);var b=this.Fa("waffle-inline-assistant-sidebar-empty-container");P(b,!1);b=this.Fa("waffle-inline-assistant-sidebar-accepted-container");P(b,!1);this.R.Wa(this.Fa("waffle-inline-assistant-sidebar-insights-cta"));this.F.render(this.Fa("waffle-inline-assistant-sidebar-column-filter-dropdown"));this.V.Wa(this.Fa("waffle-inline-assistant-refresh-button"));
pWf(this,!1)};oWf.prototype.Ca=function(){var a=zy(lWf);this.pb(a);this.H.render(a);P(this.H.La(),!1);a=this.wb();this.D.render(a)};function qWf(a){if(z(y(),"fecei")&&null===a.J){var b=DV(a.L),c=AJ(a.L);a.J=ritz_api.GridViewApi.displayColumnErrorIcons(ritz_api.RitzModelApi.getTopLevelModel(),c.L.F,b);xYe(c)}}function rWf(a){if(null!==a.J){var b=AJ(a.L);b&&(ritz_api.GridViewApi.clearColumnHeaderTransform(b.L.F,a.J),a.J=null,xYe(b),qSf(b,[]))}}
oWf.prototype.setVisible=function(a){var b={};VA(this.ma,(b.Ke=a,b));b=AJ(this.L);this.isVisible()===a||!b&&a||(BW.prototype.setVisible.call(this,a),a?(J5e(this,!0),qWf(this),pWf(this,!1)):(jWf(this.D),rWf(this)))};
oWf.prototype.initialize=function(a,b,c,d,e,f,h,k,l){J5e(this,!1);jWf(this.D);var n=this.Fa("waffle-inline-assistant-sidebar-accepted-container");P(n,!1);n=this.Fa("waffle-inline-assistant-sidebar-empty-container");var q=this.Fa("waffle-inline-assistant-sidebar-column-filter-dropdown");if(a&&(b.length&&c.length||d.length&&e.length||f.length&&h.length||0!==k.length)){var r=new rz,w=jo(ritz_api.TablesApi.getTableGridRange(a));a=w.Zb();w=w.Uc();for(r.Ga(new mz("All columns"),!0);a<w;a++)r.Ga(new mz("Column "+
bM(a)),!0);r.setVisible(!1,!0);r.render();this.F.He(r);P(q,!0);P(n,!1);if(b.length&&c.length&&(n=this.D,n.D&&(n.removeChild(n.D,!0),n.D.dispose()),c.length)){q=[];for(r=0;r<c.length;r++)a=new VVf(n.R,n.L,b[r],c[r],n.J,n.O),q.push(a);n.D=new ZVf("number-format",q,"Apply format to columns",n.J);n.Ga(n.D)}if(d.length&&e.length&&(b=this.D,b.H&&(b.removeChild(b.H,!0),b.H.dispose()),e.length)){c=[];for(n=0;n<e.length;n++)q=new dWf(b.R,b.L,d[n],e[n],b.J,b.O),c.push(q);b.H=new ZVf("trim-whitespace",c,"Trim whitespace",
b.J);b.Ga(b.H)}if(f.length&&h.length&&(d=this.D,d.F&&(d.removeChild(d.F,!0),d.F.dispose()),h.length)){e=[];for(b=0;b<h.length;b++)c=new cWf(d.R,d.L,f[b],h[b],d.J,d.O),e.push(c);d.F=new ZVf("remove-duplicates",e,"Remove duplicate rows",d.J);d.Ga(d.F)}0!==k.length&&fWf(this.D,k,l);f=this.D;h=hWf(f);h=ja(h);for(k=h.next();!k.done;k=h.next())Uw(k.value,f.V);qWf(this)}else P(n,!0),jWf(this.D),P(q,!1)};function sWf(a,b){var c=a.H;nWf(c,b);c.D=2;a.H.show()}
function tWf(a,b){var c=a.H;nWf(c,b);c.D=3;a.H.show()}function uWf(a,b){var c=a.H;b=zy(pVf,{odb:b});c.C.La().textContent=b.textContent;c.D=1;c.H=0;a.H.show()}function vWf(a,b){var c=a.H,d=zy(qVf,{h7b:b});c.C.La().textContent=d.textContent;c.D=4;c.H=b;a.H.show()}function pWf(a,b){a=a.Fa("waffle-inline-assistant-refresh-banner");P(a,b)}function wWf(a,b,c){vJ.call(this,150);this.kb=a;this.F=b;this.C=c}t(wWf,vJ);
wWf.prototype.Id=function(){for(var a=new dTb,b=0;b<this.C.length;b++){var c=this.C[b],d=this.F[b],e=new bG,f=this.kb.Jb();d=no(d,f);D(e,1,d);switch(c.H){case 32:c=c.Id();D(e,7,c);break;case 134:c=c.Id();D(e,4,c);break;case 138:c=c.Id();D(e,3,c);break;case 1:c=c.Id();D(e,2,c);break;case 151:c=c.Id();D(e,6,c);break;case 55:c=c.Id();D(e,5,c);break;default:continue}Xg(a,1,e)}return a};wWf.prototype.Bg=ea(!1);
function xWf(a,b,c,d,e){PV.call(this,a,c);this.C=a;this.J=b;this.H=d;this.L=e;this.V=new yaf(b,e,a);this.qa(this.V);this.D=!1;this.F=new Qq(this.qlb,2E3,this);this.qa(this.F);a=new Tz(this);a.yb(yub,ot,this.AAb);this.qa(a)}t(xWf,PV);m=xWf.prototype;m.initialize=function(a,b,c,d,e,f,h,k,l){this.C.initialize(a,b,c,d,e,f,h,k,l)};m.show=function(){QV(this)};
m.bM=function(){var a=new Dk;L(a,23,kWf(this.C.D).length);this.L.C(36588,ez(dz(az(new $y,76),a)));a=ja(kWf(this.C.D));for(var b=a.next();!b.done;b=a.next())this.L.C(36583,EVf(b.value));rWf(this.C);PV.prototype.bM.call(this)};function yWf(a,b){var c=nM(a.J);if(c){var d=p_(b);c=new wWf(c,d,[new cAe(c,d[0],YVf(b))]);wJ(c,function(e){e&&a.F.start()});a.H.C(c);uWf(a.C,bM(d[0].left));q_(a.C.D,b,void 0)}}
function zWf(a,b){var c=nM(a.J);if(c){var d=p_(b)[0],e=new sh;th(e,d.Zb());wh(e,d.Uc());c=new Aaf(c,d,[e],b.Da,b.F);wJ(c,function(f){f&&a.F.start()});a.H.C(c);vWf(a.C,b.F.slice(1,b.F.length).length);q_(a.C.D,b,void 0);AWf(a,b)}}function BWf(a,b){var c=nM(a.J);if(c){var d=p_(b);c=new wWf(c,d,d.map(function(){return new dAe}));wJ(c,function(e){e&&a.F.start()});a.H.C(c);sWf(a.C,d.length);q_(a.C.D,b,void 0)}}
function AWf(a,b){var c=kWf(a.C.D);b=b.F;for(var d=0;d<c.length;d++){var e=c[d],f=[];switch(e.kT()){case "remove-duplicates":f=e.F;break;case "trim-whitespace":f=e.H;break;case "anomaly":f=e.cb}for(var h=b.slice(1,b.length),k=[],l=0;l<f.length;l++){var n=xd(h,f[l]);0>n?(n=-1*(n+1),0<n&&e.L$(l,n)):k.push(l)}0<k.length&&q_(a.C.D,e,k)}}
function CWf(a,b,c,d){var e=nM(a.J);if(e){var f=new wWf(e,c,c.map(function(q){return new Tzd(e,new Um(q.left,q.top),d)}));wJ(f,function(q){q&&a.F.start()});a.H.C(f);tWf(a.C,c.length);f=p_(b);if(f.length===c.length)q_(a.C.D,b,void 0);else{for(var h=[],k=ja(c),l=k.next();!l.done;l=k.next()){l=l.value;for(var n=0;n<f.length;n++)if(f[n].equals(l)){h.push(n);break}}q_(a.C.D,b,h)}DWf(a,c)}}
function DWf(a,b){var c=kWf(a.C.D),d=b[0].left;b=ed(b,function(n){return n.top});for(var e=0;e<c.length;e++){var f=c[e],h=[];switch(f.kT()){case "remove-duplicates":h=f.F;for(var k=0;k<h.length;k++)if(0<=xd(b,h[k])){q_(a.C.D,f,void 0);break}break;case "trim-whitespace":if(f.C[0].rect.left===d){h=f.H;k=[];for(var l=0;l<h.length;l++)0<=xd(b,h[l])&&k.push(l);q_(a.C.D,f,k)}}}}m.AAb=function(){Tf(this.V);m7b(!0)};m.isVisible=function(){return this.gg().isVisible()};m.gg=function(){return Itb};m.fq=function(){return Jtb};
m.qlb=function(){this.D=!1};
function EWf(a,b,c,d,e,f,h,k,l,n,q,r){A.call(this);var w=this;this.F=a;this.O=b;this.Ra=c;this.Za=d;this.Cb=e;this.ob=h;this.J=f;ssc(this.J,this.F,this.Cb,this.Za);this.ub=k;this.cb=l;this.rb=q;this.Gb=r;this.D=null;this.L=[];this.C=new RVf;this.Va=this.V=this.Qa=this.Ma=this.Da=this.Sa=this.ma=!1;this.H=DV(this.O);this.Ba=new Map;this.R=new Qq(this.Axa,void 0,this);this.qa(this.R);this.xa=null;this.fb=new Xo(this);this.qa(this.fb);this.Xa=new TVf(a,b,c,this.Ba,this.C,this.L);this.Ja=0;this.fb.listen(this.J,
"recommender-calc-ended",this.C7).listen(this.J,"recommender-calc-failed",this.Prb).listen(vG(this.F.C),"Pb",this.QGb).listen(this.F.C,"na",this.P5b).listen(vG(this.F.C),"Dc",this.D3a).listen(this.rb.Qa,"sheet-imported",this.O5b);this.jb=new Tz(this);this.qa(this.jb);this.jb.yb(GC,ot,this.TQa).yb(Itb,jt,function(x){x.newValue&&!w.Sa?w.TQa():w.Sa=!1}).yb(Rtb,ot,this.fHb).yb(Ntb,ot,this.VDb).yb(Stb,ot,this.bMb).yb(Otb,ot,this.sKb).yb(Mtb,ot,this.HPa).yb(Ptb,ot,this.Qzb).yb(Ttb,ot,this.aZa).yb(Qtb,ot,
this.Q5b);FWf(this)}t(EWf,A);m=EWf.prototype;m.fHb=function(a){this.D.D=!0;var b=a.data;zWf(this.D,b);a=this.C.V;b=a.indexOf(b.Ra);0>b||(a.splice(b,1),this.C.L.splice(b,1),this.C.C=null,this.C.D=null)};m.VDb=function(a){this.D.D=!0;var b=a.data;yWf(this.D,b);a=this.C.R;b=a.indexOf(b.cb);0>b||(a.splice(b,1),this.C.J.splice(b,1),this.C.C=null,this.C.D=null,GWf(this))};
m.bMb=function(a){this.D.D=!0;var b=a.data;BWf(this.D,b);a=this.C.ma;b=a.indexOf(b.V);0>b||(a.splice(b,1),this.C.O.splice(b,1),this.C.C=null,this.C.D=null,GWf(this))};m.sKb=function(a){this.D.D=!0;CWf(this.D,a.data.card,a.data.QHa,a.data.newValue);GWf(this)};
function GWf(a){if(z(y(),"fecei")){for(var b=new Set,c=ja(a.C.F),d=c.next();!d.done;d=c.next())d=d.value,1==Hn(d.rect,"c")&&b.add(d.rect.Zb());c=AJ(a.O);null!=c&&(qSf(c,Array.from(b)),(new Qq(function(){var e=AJ(a.O);e&&xYe(e)},300)).start())}}
m.HPa=function(){var a=this.D.C.F,b=a.tf().getValue(),c=a.La();a=hp("docs-material-gm-labeled-select-outer-box",c);c=hp("docs-material-gm-labeled-select-caption",c);"All columns"===b?(HWf(this),tw(a,"background-color",""),tw(c,"color","")):(HWf(this,iqc(b.slice(7))),tw(a,"background-color","#E6F4EA"),tw(c,"color","#188038"))};m.Qzb=function(a){var b=a.data.card;if(1===b.Vf(b.g4()).length)q_(this.D.C.D,b,void 0);else{var c=this.D;a=a.data.Mgc;void 0===a?q_(c.C.D,b,void 0):q_(c.C.D,b,[a])}GWf(this)};
function FWf(a){z(y(),"fedpsoi")&&a.Gb&&(a.xa=500,a.R.start(a.xa),a.Qa=!0)}function IWf(a,b){return a.H?b.filter(function(c){c=oo(BV(c));return c.C!=a.H?!1:rM(a.F,c.C||a.H,c.rect,!1)}):[]}m.O5b=function(a){a=a.Qh;if(eI(this.F.C,a)){var b=new RVf;this.Ba.set(a,b);a===this.H&&(this.C=b)}this.V=!0;FWf(this)};m.TQa=function(){this.ma=!0;this.Axa();JWf(this);KWf(this)};
function JWf(a){if(nM(a.F)){if(!a.D){var b=new oWf(a.F.F,a.O,a.F.L.C,a.ob,a.Ra,a.F.R.mq());a.qa(b);b.render();a.D=new xWf(b,a.F,a.ub,a.cb,a.Ra);a.qa(a.D)}a.Sa=!0;a.D.show()}}m.aZa=function(){this.C.C=null;this.Da=!0;this.R.start(150);pWf(this.D.C,!1)};m.D3a=function(){LWf(this)&&(this.C.C=null,pWf(this.D.C,!0))};m.Q5b=function(){loe(this.cb.D);this.C.C=null;this.aZa();this.Va=!0};
function HWf(a,b){a.Ma=!1;a.Qa=!1;a.Da=!1;KWf(a);var c=nM(a.F);if(c){var d=[];if(a.C.D&&(d=IWf(a,a.C.D.C),!a.H))return;var e=a.C.Da,f=null;e?f=QVf(c,e.rect):(f=QVf(c,c.F))&&(e=oG(jo(ritz_api.TablesApi.getTableGridRange(f))));e=[];var h=[],k=[],l=[],n=[],q=[];d=ja(d);for(var r=d.next();!r.done;r=d.next()){var w=r.value;r=oo(BV(w));if(void 0===b||r.rect.left==b||9===C(w,1))switch(a.L.push(r),C(w,1)){case 7:var x=r.rect.left;if(ritz_api.RitzModelApi.getColumnType(c.Jb(),x))continue;w=C(w,14);x=C(w,1);
var F=w.getPattern();F=PVf(a.F.F,x,F);w.setPattern(F);l.push(w);e.push(r);break;case 8:r=C(w,15);n.push(r);h.push($g(w,4).map(oo));break;case 9:w=C(w,16),q.push(w),k.push(r)}}r=a.C.F;w=a.C.H;c=[];d=[];if(void 0!==b)for(x=0;x<r.length;x++)r[x].rect.left==b&&(c.push(r[x]),d.push(w[x]));else c=r,d=w;JWf(a);a.ma&&(a.ma=!1,a.D.C.focus());a.D&&(r=a.F.F.F["ritz-DataPrepSuggestionsSidepaneCount"],r.setValue(r.getValue()+1),a.D.initialize(f,e,l,h,n,k,q,c,d),MWf(a,b),b=AJ(a.O),null!=b&&pSf(b,function(M){MWf(a,
M);a.HPa()}),GWf(a));SVf(a.C,f,e,l,h,n,k,q)}}function MWf(a,b){void 0===b?a.D.C.F.Ef(0):a.D.C.F.Ef(b+1)}function LWf(a){return null!=a.D&&a.D.isVisible()}
m.P5b=function(a){if(this.H){var b=LWf(this);this.C.Ba=b;this.D&&(b=this.D,b.gg().isVisible()&&("na"===a.type?qWf(b.C):"oa"===a.type&&b.bM()));this.Ba.set(this.H,this.C);this.L=[];this.V||(this.R&&this.R.stop(),this.xa=null);a=nM(this.F);null==a?(this.H=DV(this.O),this.C=new RVf):(this.H=a.Jb(),this.C=this.Ba.has(this.H)?this.Ba.get(this.H):new RVf);if(this.H){a=this.Xa;b=this.H;var c=this.C,d=this.L;b&&c&&a.D&&(a.D=b,a.C=c,UVf(a,d));if(this.C.Ba){a=this.C.Ja;b=this.C.J;c=this.C.O;d=this.C.L;var e=
this.C.F;a&&(b.length||c.length||d.length||e.length)&&(JWf(this),this.D&&this.D.initialize(a,b,this.C.R,c,this.C.ma,d,this.C.V,this.C.F,this.C.H));GWf(this)}}}};
m.QGb=function(a){if(a.C&&a.C.length)if(this.Va)this.Va=!1;else{var b=nM(this.F);if(!b)if(a.target instanceof PI)b=a.target;else return;if(LWf(this)){if(this.D.D){b&&GWf(this);return}var c=this.C.C;c&&a.C.some(function(e){return e.top<c.Sc()&&e.left<c.Uc()})&&this.D3a()}if(this.R.Fb()||LWf(this))this.xa=5E3,this.R.start(this.xa);b={};a=ja(a.C);for(var d=a.next();!d.done;b={X9:b.X9},d=a.next()){b.X9=d.value;if(!this.H)break;if(!this.C.C)break;if(WBa(this.C.C,b.X9)&&(!this.L||!this.L.some(function(e){return function(f){return e.X9.equals(f.rect)}}(b)))){this.C.C=
null;this.L=[];this.C.D=null;break}}}};m.Prb=function(){2<this.Ja?(this.Ja=0,this.C7(null)):(this.Ja++,this.Axa())};
m.C7=function(a){this.V=!1;this.Ja=0;if(z(y(),"fenfts")||z(y(),"fetws")||z(y(),"ferds")||z(y(),"fecad")){var b=this.J.C,c=AJ(this.O);if(this.H)if(a&&c&&b&&this.H&&b.C===this.H?(this.C.D=a,this.C.C=b.rect):(this.C.D=null,this.C.C=null),this.C.Da=b,this.ma||this.Ma||this.Da)HWf(this);else{var d=a?IWf(this,a.C):[];b=this.C.F.length;a=d.length+b;b=1<b;var e=c=0;d=ja(d);for(var f=d.next();!f.done;f=d.next())f=f.value,7==C(f,1)?(b=b||C(C(f,14),3),c++):9==C(f,1)&&(b=!0,e++);!b||0==e&&2>c||!this.Qa||(HWf(this),
this.Ra.C(36702,NWf(this,a)))}}};function NWf(a,b){var c=new Dk;L(c,23,b);for(var d in CVf){b=new o$d;switch(CVf[d]){case "number-format":L(b,1,1);L(b,2,a.C.J.length);break;case "trim-whitespace":L(b,1,2);L(b,2,a.C.O.length);break;case "remove-duplicates":L(b,1,4);L(b,2,a.C.L.length);break;case "anomaly":L(b,1,3);L(b,2,a.C.F.length);break;default:continue}ck(c,25,b,o$d,void 0)}return ez(dz(az(new $y,76),c))}function KWf(a){a.H&&nSf(a.F.F.J,a.F.D.F,a.H)}
m.Axa=function(){if(this.H){if(!(this.V||this.ma||this.Ma||this.Da)){var a=this.F.F.J;if(!Pj(a.C,2,!0))return;var b=this.F.D.F;a=ja(Yj(a.C,oT,1));for(var c=a.next();!c.done;c=a.next())if(c=c.value,b===K(c,1)&&this.H===c.mb())return}this.xa=null;b=nM(this.F);a=CJ(this.O);b&&!this.F.Pd()&&this.F.H.C&&!tM(this.F)&&a&&!a.D?(UVf(this.Xa,this.L),a=b.F,(c=this.C.C)&&WBa(c,a)?(this.ma&&this.C7(this.C.D),this.V=!1):oUe(this.J)?(this.J.reset(),aYe(this.J),(b=QVf(b,a))?(b=jo(ritz_api.TablesApi.getTableGridRange(b)),
this.J.L=b,kYe(this.J,!0,!0,!1,[7,8,9])):this.C7(null)):this.C7(null)):this.V=!1}};function OWf(a,b,c,d,e,f,h,k,l,n,q){PV.call(this,b,h);var r=this;this.H=a;this.C=b;this.Da=c;this.Sa=d;this.Qa=e;this.L=f;this.D=c.C;this.Ma=this.Ba=!1;this.F=null;this.V=k;this.Ra=q;this.J=null;PWf(this);dub.Pa(!0);a=new sk;L(a,6,QWf());b=new pk;tk(b,a);this.ma=ez(az(bz(new $y,b),10));this.xa=-1;a=new Qq(function(){return RWf(r,!1)},100);this.qa(a);a.start()}t(OWf,PV);
function PWf(a){var b=vG(a.Qa);a.Oa.listen(a.Sa,"selectionChange",a.TXb).listen(a.D,"na",a.SXb).listen(a.D,"xa",a.VXb).listen(b,"Pb",a.XQa).listen(a.C,"Yd",a.Pqb).listen(a.C,"Xd",a.Oqb).listen(a.C,"Wd",a.Mqb).listen(a.C,"de",a.aHb).listen(a.C,"$d",a.psb).listen(a.C,"he",a.rKb).listen(a.C,"ee",a.LIb).listen(a.C,"Zd",a.orb).listen(a.C,"ie",a.WXb).listen(a.H.C,"recommender-confidence-update",a.Rtb).listen(a.C,"fe",a.UXb);yt(yt(yt(yt(yt(yt(xt(a.O,eub,(rt(),st),function(){a.C.Qha(!eub.isEnabled())}),gub,
function(){var c=a.C.isVisible();a.gg().setVisible(!c);c||a.C.focus();SWf(a,!c)}),fub,function(c){KUf(a.C,c.data)}),Btb,function(){return TWf(a)}),Hwb,function(c){return UWf(a,c.data)}),HCb,function(){gVf(a.C,!0)}),LD,function(){return a.bM()})}m=OWf.prototype;m.gg=function(){return hub};m.fq=function(){return iub};m.Iy=function(a){PV.prototype.Iy.call(this,a);fub.Pa(a);RWf(this,!1);!this.Ba&&a&&(this.Ba=!0);var b={};VA(this.Ra,(b.Le=a,b));a||this.C.Oc()};
m.e7=function(a){var b=this;this.C.pBa();var c=new Qq(function(){PV.prototype.e7.call(b,a)},300);this.qa(c);c.start()};m.bM=function(){PV.prototype.bM.call(this);SWf(this,!1)};m.$Wa=function(a){this.C.aXa(a);this.H.C.Ma=a};m.Pqb=function(a){var b=a.C.H,c=C(C(b,13),3);b=BV(b);var d=new Kh;yle(d,c);var e=new ur;D(e,1,d);D(e,3,!0);ZUe(e,!0);this.L.C(new Faf(e,b));r_(this,a.wk(),!1,Y$e(Hh(c)))};function SWf(a,b){b?(r_(a,2253),a.xa=Ra()):r_(a,2226,!0)}function TWf(a){a.C.isVisible()||a.Iy(!0)}
function UWf(a,b){var c="",d=void 0;b&&b.evt&&(c=b.evt?b.evt.C:"",d=b.evt);var e=eVf(a.C);e&&(e.Fb()?UTf(e,c,!0,!!c,d):(TWf(a),b=new Qq(function(){TTf(e,c,!0,!!c,d)},1E3),a.qa(b),b.start()))}m.VXb=function(){oV(this.H.C)||(this.H.C.reset(),RWf(this,!1))};m.TXb=function(){if(qM(this.Da)&&null==this.C.O){var a=oV(this.H.C);a&&iI(this.D)!=a.mb()||RWf(this,!0)}};
function RWf(a,b,c){if(c){if(!c.length)return;if(1==c.length&&a.J&&c[0].equals(a.J)){a.J=null;return}}var d=a.C;d.isVisible()&&(d.Ma.refresh(void 0),MUf(d));a.H.update(!b,a.C.isVisible(),c)}
m.Rtb=function(a){var b=a.C,c=b?b.D:null;a=b?b.C:0;var d=!!b&&.9<=b.C,e=b?b.D.rect:null;e=!!e&&e.Pi()>=hrb&&Hn(e,"r")>=jrb&&Hn(e,"c")>=krb&&e.Pi()<=irb;b=!!b&&.6<=b.C&&e;if(b!==this.Ma||c&&!c.intersects(this.F))this.Ma=b,this.F=c,this.xa=Ra(),dub.qb({Ufa:b,eD:c});e&&c&&c.rect&&(b=1E3>=c.rect.Pi(),c=ritz_api.RitzModelApi.isFormsRegion(c.C,c.rect.top,c.rect.left,c.rect.height+c.rect.top,c.rect.width+c.rect.left),d=!this.C.isVisible()&&!this.Ba&&d&&b&&!KK(this.Da.H),c=z(y(),"feeaof")&&c,b=z(y(),"feeaoro")&&
this.Da.Pd(),d&&(c||b)&&(d=new sk,L(d,1,a),L(d,2,c),L(d,3,b),L(d,5,mrb),L(d,6,QWf()),a=new pk,tk(a,d),a=ez(bz(az(new $y,10),a)),this.YGa(a)))};m.YGa=function(a){var b=this;if(mI(this.D)&&!eJ(pI(this.D))&&(this.C.Mb=!0,!kC.oda().C)){var c=a||this.ma;this.gg().setVisible(!0);this.V.C(2225,c);r_(this,2253);a=new Qq(function(){b.C.isVisible()||b.V.C(2752,c)},5E3);this.qa(a);a.start()}};
function QWf(){switch(lrb){case "NO_DELAY":return 1;case "DELAY_500MS":return 2;case "DELAY_1S":return 3;case "DELAY_2S":return 4;default:return 0}}m.orb=function(){this.C.Oc()};m.WXb=function(a){var b=a.C,c=BV(b.H);this.J=po(c);loe(this.L.D);eUf(b,c);r_(this,a.wk())};m.SXb=function(){mI(this.D)?(this.C.Pa(!0),this.H.C.reset(),RWf(this,!1)):(this.gg().setVisible(!1),this.H.C.reset(),this.C.Pa(!1))};m.XQa=function(a){RWf(this,!1,wUb(a))};
m.Oqb=function(a){var b=pI(this.D),c=b.Jb(),d=[],e=vaf(b);if(e){b=new Ur;var f=ah(e,2);D(b,3,f);f=ah(e,2);D(b,2,f);e=ah(e,1);D(b,1,e);d.push(b)}b=a.C.Od;for(e=0;e<b.length;e++)f=new Ur,D(f,2,b[e]),d.push(f);this.L.C(new Eaf(d,c));r_(this,a.wk())};
m.Mqb=function(a){var b=a.C,c=jaf(b.C),d=BV(b.H),e=c.bz?c.bC:null,f=c.C?c.HB:null,h=d.mb(),k=VWf(d);this.J=po(d);k?(c=new Haf(k,h,this.J,e,c.Rx,c.Xy,f),wJ(c,function(l){l&&a.D.call()}),this.L.C(c)):(c=new Caf(h,this.J,e,c.Rx,c.Xy,f),wJ(c,function(l){l&&a.D.call()}),this.L.C(c));d=new PQd;L(d,1,1);c=new NS;LUe(c,C(b.H,2));Zj(c,5,d);b=b3e(this.F,iI(this.D));rV(b,c);b=ez(bz(az(new $y,10),b));this.V.C(a.wk(),b)};
m.aHb=function(a){var b=a.C,c=BV(b.H),d=VWf(c);this.J=po(c);d=new Daf(d);wJ(d,function(e){e&&a.D.call();eUf(b,c)});this.L.C(d)};m.UXb=function(a){var b=fUe(a.D),c=OSf(b,a.F,a.O),d=this.H,e=a.F;aYe(d.C);d.C.L=b;d.C.Ba=c;d.C.Da=e;kYe(d.C,!0,!0,!1);r_(this,a.wk());a.D.C!=iI(this.D)&&(c=qI(this.D,a.D.C))&&(c=vG(c),this.Oa.listen(c,"Pb",this.XQa));a.L&&(eVf(this.C)&&eVf(this.C).YS(!0,!1,!0),a=this.C,b=[b],a.isVisible()&&(a.Ma.refresh(b),MUf(a)))};
function VWf(a){var b=a.mb();a=po(a);b=ritz_api.RitzModelApi.getWorkbookRangeIntersectingIds(b,a.dc(),a.Zb(),a.Sc(),a.Uc(),7,!1);return 0<b.length?b[0]:null}m.psb=function(a){var b=a.Va;fI(pI(this.D),b);r_(this,a.wk())};
m.rKb=function(a){var b=a.C;a=a.wk();if(b instanceof KW||b instanceof P9e||b instanceof rUf)r_(this,a,void 0,void 0,b.sL());else{var c=LUf(this.C),d=new NS,e=C(b.H,2);c=c.indexOf(b);L(d,1,c);LUe(d,e);e=new pk;rV(e,d);if(b instanceof qTf){(d=b.D)?(b=WWf(this,b,d),b=lzd(b,d,d.Ol)):b=null;if(!b)return;Zj(e,39,b)}else if(b instanceof KTf){var f=b.H;c=new NQd;if(b instanceof KTf)b=1;else throw Error("Unknown text analysis card type.");f=$g(CV(f),20).slice(0,10);L(c,2,f||[]);L(c,1,b);Zj(d,3,c)}e=ez(bz(az(new $y,
10),e));this.V.C(a,e)}};m.LIb=function(){this.C.Oc()};function WWf(a,b,c){a=LUf(a.C).filter(function(f){return f instanceof qTf});var d=a.map(function(f){return f.De()}),e=a[0]&&a[0].J.getSource();return jzd(c,a.indexOf(b),b.D&&b.D.Se(),d,e)}
function r_(a,b,c,d,e){e=void 0===e?10:e;if(a.F){var f=N(N(Ik(a.ma),sk,58),bta,7);if(c||!f||f.mb()!=a.F.C||f.Zb()!=a.F.rect.Zb()||f.dc()!=a.F.rect.dc()||f.Uc()!=a.F.rect.Uc()||f.Sc()!=a.F.rect.Sc()){f=new sk;L(f,6,QWf());var h=a3e(a.F);Zj(f,7,h);c&&(c=Ra()-a.xa,L(f,8,1E3*c),null!=a.C.Cb&&(c=Ra()-a.C.Cb,L(f,10,1E3*c)));d&&NUe(f,d);d=new pk;tk(d,f);a.ma=ez(az(bz(new $y,d),e))}}a.V.C(b,a.ma)}function XWf(){mJ.apply(this,arguments)}t(XWf,mJ);m=XWf.prototype;m.rnb=function(){return vUf};m.amb=function(){return cVf};
m.Smb=function(){return EWf};m.Jmb=function(){return YSf};m.$lb=function(){return OWf};m.Ulb=function(){return RSf};m.Lmb=function(){return LSf};qJ("assistant",XWf);
